Ext.define(null,{override:"master.pegawai.Form",initComponent:function(){var b=this;b.callParent(arguments);var a=b.down("[reference=panelright]");b.suspendLayouts();if(a){a.add({xtype:"msdm-kartuasuransi-workspace",height:330})}b.resumeLayouts();b.on("save",function(j){try{var g=b.down("msdm-kartuasuransi-workspace");if(g){g.saveList(j,!b.isCreate)}}catch(f){}})},onLoadRecord:function(a,e){this.callParent(arguments);var b=a.down("msdm-kartuasuransi-workspace");if(b){b.load(e)}}});Ext.define(null,{override:"master.pegawai.Grid",onBeforeCallParentInitComponent:function(a){a.indexskoringTooltip="Index Skoring Pegawai";a.indexskoring=Ext.Action.create({iconCls:"x-fa fa-sort-numeric-asc x-color-blue",tooltip:a.indexskoringTooltip,handler:"onIndexSkoring"});a.actions.indexskoring=a.indexskoring;a.columns.forEach(function(e){if(e.xtype){if(e.xtype=="actioncolumn"){var b=false;e.items.forEach(function(f){if(f.tooltip){if(f.tooltip==a.indexskoringTooltip){b=true}}});if(!b){e.items.push("@indexskoring")}}}})},destroy:function(){this.callParent();if(this.indexskoring){this.indexskoring.destroy()}}});Ext.define(null,{override:"master.pegawai.GridController",onIndexSkoring:function(e,l,b,m,j,k){var f=this,a=f.getView();a.openWindow({title:"Index Skoring Pegawai",iconCls:"x-fa fa-sort-numeric-asc",ui:"window-blue",header:{margin:0,padding:"10 15 10 15"},closable:true,maximized:true,constrain:a,layout:"border",border:false,items:[{region:"north",bodyPadding:5,html:"<h2> "+k.get("NIP")+" / "+k.get("GELAR_DEPAN")+" "+k.get("NAMA")+" "+k.get("GELAR_BELAKANG")+" </h2>"},{region:"center",bodyPadding:5,flex:1,xtype:"msdm-indexskoring-workspace"}]},function(g,n){n.down("msdm-indexskoring-workspace").load(k.get("NIP"))})}});Ext.define("msdm.absensi.dokterpoli.scan.Model",{extend:"data.model.Model",serviceName:"msdm/scandokter",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"RUANGAN",type:"string"},{name:"KODE_ABSEN",type:"string"},{name:"JENIS",type:"int"},{name:"QRCODE",type:"string"},{name:"SCAN_DATE",dateFormat:"Y-m-d H:i:s",type:"date"},{name:"TANGGAL",dateFormat:"Y-m-d H:i:s",type:"date"},{name:"VERSION",type:"string"},{name:"ABSEN",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.absensi.dokterpoli.scan.Store",{extend:"data.store.Store",model:"msdm.absensi.dokterpoli.scan.Model",alias:"store.msdm-absensi-dokterpoli-scan-store"});Ext.define("msdm.absensi.dokterpoli.scan.approve.Model",{extend:"data.model.Model",serviceName:"msdm/approveabsenscandokter",fields:[{name:"ID",type:"int"},{name:"SCAN",type:"int"},{name:"OLEH",type:"int"}],idProperty:"ID"});Ext.define("msdm.absensi.dokterpoli.scan.approve.Store",{extend:"data.store.Store",model:"msdm.absensi.dokterpoli.scan.approve.Model",alias:"store.msdm-absensi-dokterpoli-scan-approve-store"});Ext.define("msdm.absensi.mesin.Model",{extend:"data.model.Model",serviceName:"msdm/absensi/mesin",fields:[{name:"ID",type:"int"},{name:"NAMA_MESIN",type:"string"},{name:"IP",type:"string"},{name:"SN",type:"string"},{name:"ALG_VER",type:"int"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.absensi.mesin.Store",{extend:"data.store.Store",model:"msdm.absensi.mesin.Model",alias:"store.msdm-absensi-mesin-store"});Ext.define("msdm.absensi.penarikan.Model",{extend:"data.model.Model",serviceName:"msdm/absensi/penarikan",fields:[{name:"ID",type:"int"},{name:"NAMA_MESIN",type:"string"},{name:"IP",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.absensi.penarikan.Store",{extend:"data.store.Store",model:"msdm.absensi.penarikan.Model",alias:"store.msdm-absensi-penarikan-store"});Ext.define("msdm.absensi.presensi.Model",{extend:"data.model.Model",serviceName:"msdm/absensi/presensi",fields:[{name:"ID",type:"int"},{name:"KODE_MESIN",type:"string"},{name:"KODE_ABSEN",type:"string"},{name:"IO_MODE",type:"string"},{name:"WAKTU_PRESENSI",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.absensi.presensi.Store",{extend:"data.store.Store",model:"msdm.absensi.presensi.Model",alias:"store.msdm-absensi-presensi-store"});Ext.define("msdm.absensi.waktupenarikan.Model",{extend:"data.model.Model",serviceName:"msdm/absensi/waktupenarikan",fields:[{name:"ID",type:"int"},{name:"MESIN",type:"string"},{name:"WAKTU",type:"date",dateFormat:"H:i:s"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.absensi.waktupenarikan.Store",{extend:"data.store.Store",model:"msdm.absensi.waktupenarikan.Model",alias:"store.msdm-absensi-waktupenarikan-store"});Ext.define("msdm.dasarjadwal.Model",{extend:"data.model.Model",serviceName:"msdm/dasarjadwal",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"SCHEDULE",type:"int"},{name:"TANGGAL_BERLAKU",dateFormat:"Y-m-d",type:"date"},{name:"TANGGAL",dateFormat:"Y-m-d",type:"date"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.dasarjadwal.Store",{extend:"data.store.Store",model:"msdm.dasarjadwal.Model",alias:"store.msdm-dasarjadwal-store"});Ext.define("msdm.indexskoring.Model",{extend:"data.model.Model",serviceName:"msdm/indexskoring",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"NILAI",type:"float"},{name:"TANGGAL_BERLAKU",dateFormat:"Y-m-d",type:"date"},{name:"TANGGAL",dateFormat:"Y-m-d H:i:s",type:"date"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.indexskoring.Store",{extend:"data.store.Store",model:"msdm.indexskoring.Model",alias:"store.msdm-indexskoring-store"});Ext.define("msdm.jadwaldinas.Model",{extend:"data.model.Model",serviceName:"msdm/jadwaldinas",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"DINAS",type:"int"},{name:"RUANGAN",type:"string"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.jadwaldinas.Store",{extend:"data.store.Store",model:"msdm.jadwaldinas.Model",alias:"store.msdm-jadwaldinas-store"});Ext.define("msdm.jadwalwfh.Model",{extend:"data.model.Model",serviceName:"msdm/jadwalwfh",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"WFH",type:"int"},{name:"RUANGAN",type:"string"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.jadwalwfh.Store",{extend:"data.store.Store",model:"msdm.jadwalwfh.Model",alias:"store.msdm-jadwalwfh-store"});Ext.define("msdm.kartuasuransi.Model",{extend:"data.model.Model",serviceName:"msdm/kartuasuransipegawai",fields:[{name:"ID",type:"int"},{name:"JENIS",type:"int"},{name:"NIP",type:"string"},{name:"NOMOR",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.kartuasuransi.Store",{extend:"data.store.Store",model:"msdm.kartuasuransi.Model",alias:"store.msdm-kartuasuransi-store"});Ext.define("msdm.kartuidentitas.Model",{extend:"data.model.Model",serviceName:"msdm/kartuidentitas",fields:[{name:"ID",type:"int"},{name:"JENIS",type:"int",defaultValue:1},{name:"NIP",type:"int"},{name:"NOMOR",type:"string"},{name:"ALAMAT",type:"string"},{name:"RT",type:"string"},{name:"RW",type:"string"},{name:"KODEPOS",type:"string"},{name:"WILAYAH",type:"string"}]});Ext.define("msdm.kartuidentitas.Store",{extend:"data.store.Store",model:"msdm.kartuidentitas.Model",alias:"store.msdm-kartuidentitas-store"});Ext.define("msdm.keluarga.Model",{extend:"data.model.Model",serviceName:"msdm/keluarga",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"SHDK",type:"int"},{name:"NAMA",type:"string"},{name:"JENIS_KELAMIN",type:"int"},{name:"ALAMAT",type:"string"},{name:"PENDIDIKAN",type:"int"},{name:"PEKERJAAN",type:"int"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.keluarga.Store",{extend:"data.store.Store",model:"msdm.keluarga.Model",alias:"store.msdm-keluarga-store"});Ext.define("msdm.kirimpayroll.Model",{extend:"data.model.Model",serviceName:"msdm/kirimpayroll",fields:[{name:"ID",type:"int"},{name:"PAYROLL",type:"int"},{name:"EMAIL",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.kirimpayroll.Store",{extend:"data.store.Store",model:"msdm.kirimpayroll.Model",alias:"store.msdm-kirimpayroll-store"});Ext.define("msdm.kodeabsensi.Model",{extend:"data.model.Model",serviceName:"msdm/kodeabsensi",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"KODE_ABSEN",type:"string"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.kodeabsensi.Store",{extend:"data.store.Store",model:"msdm.kodeabsensi.Model",alias:"store.msdm-kodeabsensi-store"});Ext.define("msdm.kontak.Model",{extend:"data.model.Model",serviceName:"msdm/kontakpegawai",fields:[{name:"ID",type:"int"},{name:"JENIS",type:"int"},{name:"NIP",type:"string"},{name:"NOMOR",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.kontak.Store",{extend:"data.store.Store",model:"msdm.kontak.Model",alias:"store.msdm-kontak-store"});Ext.define("msdm.liburnasional.Model",{extend:"data.model.Model",serviceName:"msdm/liburnasional",fields:[{name:"ID",type:"int"},{name:"TANGGAL_LIBUR",type:"date",dateFormat:"Y-m-d"},{name:"KETERANGAN",type:"string"},{name:"TANGGAL",type:"date"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.liburnasional.Store",{extend:"data.store.Store",model:"msdm.liburnasional.Model",alias:"store.msdm-liburnasional-store"});Ext.define("msdm.npwp.Model",{extend:"data.model.Model",serviceName:"msdm/npwp",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"NOMOR",type:"string"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.npwp.Store",{extend:"data.store.Store",model:"msdm.npwp.Model",alias:"store.msdm-npwp-store"});Ext.define("msdm.pangkatgolongan.Model",{extend:"data.model.Model",serviceName:"msdm/pangkatgolongan",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"GOLONGAN",type:"int"},{name:"NAMA_GOLONGAN",type:"string"},{name:"TMT",dateFormat:"Y-m-d",type:"date"},{name:"PEJABAT",type:"string"},{name:"NO_SK",type:"string"},{name:"TGL_SK",dateFormat:"Y-m-d",type:"date"},{name:"STATUS_PEG",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.pangkatgolongan.Store",{extend:"data.store.Store",model:"msdm.pangkatgolongan.Model",alias:"store.msdm-pangkatgolongan-store"});Ext.define("msdm.payroll.Model",{extend:"data.model.Model",serviceName:"msdm/payroll",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"RUANGAN",type:"string"},{name:"PERIODE_AWAL",type:"date",dateFormat:"Y-m-d"},{name:"PERIODE_AKHIR",type:"date",dateFormat:"Y-m-d"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.payroll.Store",{extend:"data.store.Store",model:"msdm.payroll.Model",alias:"store.msdm-payroll-store"});Ext.define("msdm.payroll.detail.Model",{extend:"data.model.Model",serviceName:"msdm/payrolldetail",fields:[{name:"ID",type:"int"},{name:"PAYROLL",type:"int"},{name:"REF_JENIS",type:"int"},{name:"REF_ID",type:"int"},{name:"NILAI",type:"float"}],idProperty:"ID"});Ext.define("msdm.payroll.detail.Store",{extend:"data.store.Store",model:"msdm.payroll.detail.Model",alias:"store.msdm-payroll-detail-store"});Ext.define("msdm.pegawaiabsen.Model",{extend:"data.model.Model",serviceName:"msdm/pegawaiabsen",fields:[{name:"ID",type:"int"},{name:"JENIS",type:"int"},{name:"NIP",type:"string"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d"},{name:"KETERANGAN",type:"string"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.pegawaiabsen.Store",{extend:"data.store.Store",model:"msdm.pegawaiabsen.Model",alias:"store.msdm-pegawaiabsen-store"});Ext.define("msdm.pelatihan.Model",{extend:"data.model.Model",serviceName:"msdm/pelatihan",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"DESKRIPSI",type:"string"},{name:"JENIS_PELATIHAN",type:"int"},{name:"PENYELENGARA",type:"string"},{name:"MULAI",type:"date",dateFormat:"Y-m-d"},{name:"SELESAI",type:"date",dateFormat:"Y-m-d"},{name:"TEMPAT",type:"string"},{name:"KETERANGAN",type:"string"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.pelatihan.Store",{extend:"data.store.Store",model:"msdm.pelatihan.Model",alias:"store.msdm-pelatihan-store"});Ext.define("msdm.pendidikan.Model",{extend:"data.model.Model",serviceName:"msdm/pendidikan",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"JENIS_PENDIDIKAN",type:"int"},{name:"NAMA_LEMBAGA",type:"string"},{name:"ALAMAT",type:"string"},{name:"TAHUN_KELULUSAN",dateFormat:"Y",type:"date"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.pendidikan.Store",{extend:"data.store.Store",model:"msdm.pendidikan.Model",alias:"store.msdm-pendidikan-store"});Ext.define("msdm.penempatan.Model",{extend:"data.model.Model",serviceName:"msdm/penempatan",fields:[{name:"ID",type:"int"},{name:"SK",type:"string"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.penempatan.Store",{extend:"data.store.Store",model:"msdm.penempatan.Model",alias:"store.msdm-penempatan-store"});Ext.define("msdm.penempatan.detil.Model",{extend:"data.model.Model",serviceName:"msdm/penempatan/detil",fields:[{name:"ID",type:"int"},{name:"PENEMPATAN",type:"int"},{name:"NIP",type:"string"},{name:"RUANGAN",type:"string"},{name:"JABATAN",type:"int"},{name:"TANGGAL_BERLAKU",type:"date",dateFormat:"Y-m-d"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.penempatan.detil.Store",{extend:"data.store.Store",model:"msdm.penempatan.detil.Model",alias:"store.msdm-penempatan-detil-store"});Ext.define("msdm.penempatan.sekarang.Model",{extend:"data.model.Model",serviceName:"msdm/penempatan/sekarang",fields:[{name:"NIP",type:"string"},{name:"RUANGAN",type:"string"},{name:"JABATAN",type:"int"},{name:"TANGGAL_BERLAKU",type:"date",dateFormat:"Y-m-d"},{name:"STATUS",type:"int",defaultValue:1}]});Ext.define("msdm.penempatan.sekarang.Store",{extend:"data.store.Store",model:"msdm.penempatan.sekarang.Model",alias:"store.msdm-penempatan-sekarang-store"});Ext.define("msdm.rekening.Model",{extend:"data.model.Model",serviceName:"msdm/rekening",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"NOMOR_REKENING",type:"string"},{name:"BANK",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.rekening.Store",{extend:"data.store.Store",model:"msdm.rekening.Model",alias:"store.msdm-rekening-store"});Ext.define("msdm.rincianabsensi.Model",{extend:"data.model.Model",serviceName:"msdm/rincianabsensi",fields:[{name:"TANGGAL",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"NIP",type:"string"},{name:"NAMA_JADWAL",type:"string"},{name:"HARI_KERJA",type:"int"},{name:"JADWAL_DATANG",type:"string"},{name:"JADWAL_PULANG",type:"string"},{name:"MASUK",type:"string"},{name:"PULANG",type:"string"},{name:"HADIR_KERJA",type:"int"},{name:"HADIR_LIBUR",type:"int"},{name:"EFEKTIF",type:"string"},{name:"LAMBAT",type:"string"},{name:"PULANG_CEPAT",type:"string"},{name:"LEMBUR_KERJA",type:"string"},{name:"LEMBUR_LIBUR",type:"string"},{name:"ABSENT_NAME",type:"string"},{name:"ALPA",type:"int"},{name:"SAKIT",type:"int"},{name:"IZIN",type:"int"},{name:"CUTI",type:"int"},{name:"TUGAS",type:"int"},{name:"LAIN_LAIN",type:"int"},{name:"KETERANGAN",type:"string"}]});Ext.define("msdm.rincianabsensi.Store",{extend:"data.store.Store",model:"msdm.rincianabsensi.Model",alias:"store.msdm-rincianabsensi-store"});Ext.define("msdm.schedule.Model",{extend:"data.model.Model",serviceName:"msdm/schedule",fields:[{name:"ID",type:"int"},{name:"DESK",type:"string"},{name:"STATUS_SHIFT",type:"int"},{name:"KET",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.schedule.Store",{extend:"data.store.Store",model:"msdm.schedule.Model",alias:"store.msdm-schedule-store"});Ext.define("msdm.schedule.detail.Model",{extend:"data.model.Model",serviceName:"msdm/schedule/detail",fields:[{name:"ID",type:"int"},{name:"SCHEDULE",type:"int"},{name:"SHIFT",type:"int"},{name:"DAY",type:"int"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.schedule.detail.Store",{extend:"data.store.Store",model:"msdm.schedule.detail.Model",alias:"store.msdm-schedule-detail-store"});Ext.define("msdm.schedule.shift.Model",{extend:"data.model.Model",serviceName:"msdm/shift",fields:[{name:"ID",type:"int"},{name:"SCHEDULE",type:"int"},{name:"JENIS_JADWAL",type:"int"},{name:"KET",type:"string"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.schedule.shift.Store",{extend:"data.store.Store",model:"msdm.schedule.shift.Model",alias:"store.msdm-schedule-shift-store"});Ext.define("msdm.schedule.shift.detail.Model",{extend:"data.model.Model",serviceName:"msdm/shift/detail",fields:[{name:"ID",type:"int"},{name:"ID_SHIFT",type:"int"},{name:"JAM_MASUK",type:"string"},{name:"JAM_PULANG",type:"string"},{name:"TGL_BERLAKU",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.schedule.shift.detail.Store",{extend:"data.store.Store",model:"msdm.schedule.shift.detail.Model",alias:"store.msdm-schedule-shift-detail-store"});Ext.define("msdm.statuspegawai.Model",{extend:"data.model.Model",serviceName:"msdm/statuspegawai",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"STATUS_PEGAWAI",type:"int"},{name:"TMT",type:"date",dateFormat:"Y-m-d"},{name:"SK_PENGANGKATAN",type:"string"},{name:"TANGGAL_SK",type:"date",dateFormat:"Y-m-d"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d"},{name:"OLEH",type:"int"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.statuspegawai.Store",{extend:"data.store.Store",model:"msdm.statuspegawai.Model",alias:"store.msdm-statuspegawai-store"});Ext.define("msdm.strsip.Model",{extend:"data.model.Model",serviceName:"msdm/strsip",fields:[{name:"ID",type:"int"},{name:"NIP",type:"string"},{name:"JENIS",type:"int"},{name:"NOMOR",type:"string"},{name:"TANGGAL_BERLAKU",dateFormat:"Y-m-d",type:"date"},{name:"BERLAKU_SAMPAI",dateFormat:"Y-m-d",type:"date"},{name:"FILE",type:"string"},{name:"TYPE",type:"string"},{name:"TANGGAL",dateFormat:"Y-m-d",type:"date"},{name:"STATUS",type:"int"}],idProperty:"ID"});Ext.define("msdm.strsip.Store",{extend:"data.store.Store",model:"msdm.strsip.Model",alias:"store.msdm-strsip-store"});Ext.define("msdm.waktudinasruangan.Model",{extend:"data.model.Model",serviceName:"msdm/waktudinasruangan",fields:[{name:"ID",type:"int"},{name:"RUANGAN",type:"string"},{name:"JAM_MASUK",type:"date",dateFormat:"H:i:s"},{name:"JAM_PULANG",type:"date",dateFormat:"H:i:s"},{name:"TANGGAL",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("msdm.waktudinasruangan.Store",{extend:"data.store.Store",model:"msdm.waktudinasruangan.Model",alias:"store.msdm-waktudinasruangan-store"});Ext.define("msdm.kirimpayroll.List",{extend:"com.Grid",xtype:"msdm-kirimpayroll-list",controller:"msdm-kirimpayroll-list",viewModel:{stores:{store:{type:"msdm-payroll-store"}}},header:{iconCls:"x-fa fa-list",padding:"5px 5px 5px 5px",title:"List Pegawai",items:[{xtype:"combobox",emptyText:"Bulan",store:Ext.create("Ext.data.Store",{fields:["ID","DESK"],data:[{ID:"1",DESK:"Januari"},{ID:"2",DESK:"Februari"},{ID:"3",DESK:"Maret"},{ID:"4",DESK:"April"},{ID:"5",DESK:"Mei"},{ID:"6",DESK:"Juni"},{ID:"7",DESK:"Juli"},{ID:"8",DESK:"Agustus"},{ID:"9",DESK:"September"},{ID:"10",DESK:"Oktober"},{ID:"11",DESK:"November"},{ID:"12",DESK:"Desember"}]}),queryMode:"local",displayField:"DESK",name:"BULAN",reference:"filterbulan",margin:"0 10 0 0",valueField:"ID",forceSelection:true,allowBlank:false,value:new Date().getMonth()+1},{xtype:"numberfield",name:"TAHUN",margin:"0 10 0 0",reference:"filtertahun",width:100,hideLabel:true,value:new Date().getFullYear(),allowBlank:false},{xtype:"button",iconCls:"x-fa fa-search",margin:"0 0 0 1",tooltip:"Tampilkan",reference:"BtnFilterPayroll",handler:"onFilter"}]},ui:"panel-cyan",layout:"fit",border:true,initComponent:function(){var a=this;a.columns=[{text:"Nama Pegawai",dataIndex:"NIP",renderer:"onRenderPegawai",flex:2},{text:"Email",dataIndex:"NIP",renderer:"onRenderEmail",flex:1},{text:"Tanggal Buat",xtype:"datecolumn",format:"d-m-Y",dataIndex:"TANGGAL",renderer:"onRendererTgl",flex:1},{text:"Nilai Payrol",dataIndex:"TOTALPAYROLL",renderer:"onRenderTotal",flex:1},{text:"Tanggal Kirim Terakhir",xtype:"datecolumn",format:"d-m-Y",dataIndex:"TANGGAL_KIRIM",renderer:"onRendererTglKirim",flex:1},{text:"Kirim",xtype:"actioncolumn",align:"center",width:75,items:[{xtype:"tool",iconCls:"x-fa fa-paper-plane",tooltip:"Kirim Ke Email",handler:"onKirimEmail"}]}];a.dockedItems=[{xtype:"pagingtoolbar",bind:{store:"{store}"},dock:"bottom"}];a.callParent(arguments)},onLoadRecord:function(g){var e=this,a=e.getViewModel().get("store"),f=e.down("[reference=filterbulan]"),b=e.down("[reference=filtertahun]");bln=f?f.getValue():"1",bulan=bln.padStart(2,"0"),tahun=b?b.getValue():"2000",tanggal=tahun+"-"+bulan;if(a){a.queryParams={FILTERTANGGAL:1,STATUS:2,TANGGAL:tanggal,RUANGAN:g.get("ID")};a.load()}}});Ext.define("msdm.kirimpayroll.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kirimpayroll-list",currentRecord:undefined,onRenderPegawai:function(k,f,j){var e=this,b=j.get("REFERENSI"),a=b.PEGAWAI,g=j.get("NIP")+" | "+a.GELAR_DEPAN+" "+a.NAMA+" "+a.GELAR_BELAKANG;e.setBackGround(f,j.get("STATUS_KIRIM"));return g},onRenderEmail:function(g,e,f){var b=this,a=f.get("EMAIL_AKTIF");b.setBackGround(e,f.get("STATUS_KIRIM"));return a},onRendererTgl:function(e,b,j){var f=this,a=j.get("TANGGAL")?j.get("TANGGAL"):"-",g=Ext.Date.format(a,"d-m-Y");f.setBackGround(b,j.get("STATUS_KIRIM"));return g},onRenderTotal:function(g,e,f){var b=this,a=f.get("TOTALPAYROLL");b.setBackGround(e,f.get("STATUS_KIRIM"));return Ext.util.Format.number(a,"0,000.00")},onRendererTglKirim:function(e,b,g){var f=this,a=g.get("TANGGAL_KIRIM")?g.get("TANGGAL_KIRIM"):"0000-00-00";f.setBackGround(b,g.get("STATUS_KIRIM"));return a},setBackGround:function(b,a){if(a==1){b.style="background-color:#0df775;color:#000000;font-weight: bold"}},onKirimEmail:function(e,j,b){var f=this,a=f.getView(),g=e.getStore().getAt(j);f.onKirimPayroll(g)},onFilter:function(b){var e=this,a=e.getView();a.fireEvent("filter")},onKirimPayroll:function(e){var b=this,a=b.getView(),f=Ext.create("msdm.kirimpayroll.Model",{});if(e){a.setLoading(true);a.setLoading(true);f.set("NIP",e.get("NIP"));f.set("PAYROLL",e.get("ID"));f.set("EMAIL",e.get("EMAIL_AKTIF"));f.set("NAMA",e.get("REFERENSI").PEGAWAI.NAMA);f.set("PERIODE",Ext.Date.format(e.get("TANGGAL"),"Y-m-d"));f.save({callback:function(j,g,k){if(k){a.notifyMessage("Payroll Berhasil Di Kirim")}else{a.notifyMessage("Payroll Gagal Di Kirim")}a.setLoading(false)}})}}});Ext.define("msdm.kirimpayroll.Workspace",{extend:"com.Form",xtype:"msdm-kirimpayroll-workspace",controller:"msdm-kirimpayroll-workspace",bodyPadding:5,layout:{type:"hbox",align:"stretch"},items:[{xtype:"ruangan-tree",reference:"ruanganpegawaipayroll",flex:1,ui:"panel-cyan",header:{iconCls:"x-fa fa-list",padding:"11px 11px 11px 11px",title:"Ruangan"},listeners:{select:"onRuanganSelect"}},{xtype:"msdm-kirimpayroll-list",reference:"listpayrollpegawai",flex:3,listeners:{filter:"onFilter"}}],load:function(){var a=this,b=a.down("msdm-kirimpayroll-list")}});Ext.define("msdm.kirimpayroll.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kirimpayroll-workspace",ruanganSelected:undefined,onRuanganSelect:function(b,f){var e=this,a=e.getReferences();if(f){e.ruanganSelected=f;a.listpayrollpegawai.onLoadRecord(f)}},onFilter:function(b){var e=this,a=e.getReferences();a.listpayrollpegawai.onLoadRecord(e.ruanganSelected)}});Ext.define("msdm.Pencarian",{extend:"com.Form",xtype:"msdm-pencarian",controller:"msdm-pencarian",layout:{type:"hbox",align:"stretch"},viewModel:{formConfig:{baru:false}},bodyPadding:0,items:[{xtype:"search-field",cls:"x-text-border",iconCls:"iconSearch",autoFocus:true,emptyText:"Cari pegawai dgn Memasukkan NIP/No.KTP/Nama",enableKeyEvents:true,flex:1,listeners:{search:"onSearch",change:"onChange"}},{iconCls:"x-fa fa-list x-color-gray",cls:"x-btn-white",width:50,xtype:"button",handler:"onList",tooltip:"Daftar Pegawai"}],onLoadRecord:function(){var a=this;a.setFormConfig({})}});Ext.define("msdm.PencarianController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pencarian",onSearch:function(){this.doCari()},doCari:function(){var a=this,b=a.getView().down("search-field").getValue();if(b.trim().length==0){return}if(Ext.isNumeric(b)){if(b.length==16){a.cariDgnNomorKtp(b)}else{a.cariDgnNip(b)}}else{a.cariDgnNama(b)}},cariDgnNip:function(e){var b=this,a=b.getView();if(data.model){data.model.Pegawai.load(e,{success:function(f){a.fireEvent("opentab",f,b.getIconSex(f),true,"msdm.dashboard.Workspace","pgw-"+f.getId(),f.getId())},failure:function(){a.notifyMessage("Pegawai tidak ditemukan","danger-red")}})}},cariDgnNomorKtp:function(e){var b=this,a=b.getView();if(data.model){pegawai.kartuidentitas.Model.load(e,{success:function(f){b.cariDgnNip(f.get("NIP"))},failure:function(){a.notifyMessage("pegawai tidak ditemukan","danger-red")}})}},cariDgnNama:function(e){var b=this,a=b.getView();a.openDialog("",true,0,0,{xtype:"msdm-pegawai-list",title:"Daftar Pegawai",ui:"panel-gray",showCloseButton:true,hideColumns:false,viewModel:{data:{filter:{FILTERNAMA:e}}}},function(f,j){var g=j.down("msdm-pegawai-list");g.on({detilpegawai:function(k){j.close();a.fireEvent("opentab",k,b.getIconSex(k),true,"msdm.dashboard.Workspace","pgw-"+k.getId(),k.getId())}})})},onList:function(){this.cariDgnNama("")},onClearText:function(){this.getReferences().cari_text.onClearClick()},onChange:function(e,g){var f=this,a=f.getView(),b=a.down("search-field");if(g==""){b.onClearClick()}},privates:{getIconSex:function(a){return"x-fa fa-"+(a.get("JENIS_KELAMIN")==1?"male":"female")}}});Ext.define("msdm.Workspace",{extend:"com.Form",xtype:"msdm-workspace",layout:"fit",bodyPadding:0,items:[{xtype:"com-form",ui:"panel-black",title:" MSDM / Kepegawaian",titleFieldConfig:{},fullscreenEnabled:true,menuConfig:{enabled:true,width:257,buttonConfig:{}},fullscreenConfig:{},header:{items:[{}]}}],load:function(a){var f=this,e=this.down("com-form");var g=[],b=Ext.JSON.decode(Ext.util.Base64.decode(f.app.xuam));b.forEach(function(k,j){k=Ext.JSON.decode(Ext.util.Base64.decode(k));if(k.ID.substring(0,4)=="9005"&&k.LEVEL==3){if(k.CLASS!=null){g.push({text:k.DESKRIPSI,leaf:true,iconCls:k.ICON_CLS,className:k.CLASS,idClassName:f.replaceAll(k.CLASS.toLowerCase(),".","_")})}}});e.setMenus(g)}});Ext.define("msdm.absensi.dashboard.Workspace",{extend:"com.Form",xtype:"msdm-absensi-dashboard-workspace",controller:"msdm-absensi-dashboard-workspace",viewModel:{data:{pegawai:undefined}},title:"Laporan Absensi Pegawai",ui:"panel-cyan",defaults:{border:false},layout:"border",initComponent:function(){var a=this;a.items=[{layout:{type:"vbox",align:"stretch"},region:"north",items:[{xtype:"container",defaultType:"combobox",flex:1,defaults:{margin:4},layout:{type:"hbox",align:"stretch"},items:[{xtype:"datefield",fieldLabel:"Periode Awal",submitFormat:"Y-m-d",format:"d-m-Y",reference:"pawal"},{xtype:"datefield",fieldLabel:"Periode Akhir",submitFormat:"Y-m-d",format:"d-m-Y",reference:"pakhir"}]},{xtype:"checkboxfield",name:"KALKULASI",margin:4,reference:"kalkulasi",inputValue:"1",boxLabel:"Kalkulasi ulang absen sebelum menampilkan"}]}];a.buttons=[{text:"Rincian",iconCls:"x-fa fa-file-pdf-o",listeners:{click:"OnRincian"},ui:"soft-red"},{text:"Rekapan",iconCls:"x-fa fa-file-pdf-o",listeners:{click:"OnRekap"},ui:"soft-blue"}];a.callParent(arguments)},load:function(e){var b=this,a=b.getViewModel();a.set("pegawai",e)}});Ext.define("msdm.absensi.dashboard.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-dashboard-workspace",OnRincian:function(a){this.cetak(true,"plugins.msdm.CetakRincianAbsensi")},OnRekap:function(a){this.cetak(true,"plugins.msdm.cetakRekapAbsensi")},privates:{cetak:function(g,m){var j=this,l=j.getView(),b=l.getViewModel().get("pegawai"),k=l.getReferences(),f=k.pawal.getSubmitValue(),a=k.pakhir.getSubmitValue(),e=k.kalkulasi.getValue();if(e==1){Ext.Ajax.request({url:webservice.location+"msdm/rincianabsensi",method:"GET",params:{KALKULASI:e,TGLAWAL:f,TGLAKHIR:a,NIP:b.get("NIP")},success:function(n,o){l.cetak({NAME:m,TYPE:g?"Pdf":"Word",EXT:g?"pdf":"docx",PARAMETER:{PPAWAL:f,PPAKHIR:a,PNIP:b.get("NIP")},REQUEST_FOR_PRINT:!g,PRINT_NAME:"CetakHasil"},function(p){if(g){l.printPreview("Preview Rincian Absensi",p)}})},failure:function(n,o){console.log("server-side failure with status code "+n.status)}})}else{l.cetak({NAME:m,TYPE:g?"Pdf":"Word",EXT:g?"pdf":"docx",PARAMETER:{PPAWAL:f,PPAKHIR:a,PNIP:"'"+b.get("NIP")+"'"},REQUEST_FOR_PRINT:!g,PRINT_NAME:"CetakHasil"},function(n){if(g){l.printPreview("Preview Rincian Absensi",n)}})}}}});Ext.define("msdm.absensi.dokterpoli.scan.Form",{extend:"com.Form",xtype:"msdm-absensi-dokterpoli-scan-form",model:"msdm.absensi.dokterpoli.scan.Model",controller:"msdm-absensi-dokterpoli-scan-form",layout:{type:"vbox",align:"stretch"},items:[{layout:{type:"hbox"},defaults:{margin:"1 1 1 1",flex:1},items:[{xtype:"dokter-combo",name:"NIP",valueField:"NIP",emptyText:"[ Dokter ]"},{xtype:"combo",name:"JENIS",emptyText:"[ Jenis Absen ]",store:Ext.create("data.store.Store",{field:["ID","DESKRIPSI"],data:[{ID:0,DESKRIPSI:"Masuk"},{ID:1,DESKRIPSI:"Pulang"}]}),displayField:"DESKRIPSI",valueField:"ID"}]},{layout:{type:"hbox"},defaults:{margin:"1 1 1 1",flex:1},items:[{xtype:"ruangan-combo",name:"RUANGAN",params:{JENIS_KUNJUNGAN:1,JENIS:5,STATUS:1},firstLoad:true,emptyText:"[ Ruangan ]"},{xtype:"datetimefield",name:"SCAN_DATE",emptyText:"[ Tanggal dan Jam ]",format:"Y-m-d H:i:s"}]}],buttons:[{text:"Simpan",ui:"soft-purple",iconCls:"fas fa-save",handler:"onSimpan"}]});Ext.define("msdm.absensi.dokterpoli.scan.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-dokterpoli-scan-form",onSimpan:function(b){var e=this,a=e.getView();a.showMessageBox({title:"Konfirmasi",message:"Anda yakin ingin menyimpan absen dokter ini ?",ui:"window-red",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:b,fn:function(g){a.setLoading(true);a.save(b,{},function(k,f,j){a.setLoading(false)})}})}});Ext.define("msdm.absensi.dokterpoli.scan.Grid",{extend:"com.Grid",xtype:"msdm-absensi-dokterpoli-scan-grid",controller:"msdm-absensi-dokterpoli-scan-grid",viewModel:{stores:{store:{type:"msdm-absensi-dokterpoli-scan-store"}},data:{listConfig:{paging:false}}},columns:[{xtype:"templatecolumn",text:"Pegawai",flex:1,dataIndex:"NIP",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div style="font-size: 13px;">{[this.getDeskripsi(values)]}</div>',"</tpl>",{getDeskripsi:function(b){var a=b.REFERENSI?b.REFERENSI.PEGAWAI?b.REFERENSI.PEGAWAI:undefined:undefined;if(a){return a.NIP+" - "+a.NAMA}return""}})},{xtype:"templatecolumn",text:"Ruangan",flex:1,dataIndex:"RUANGAN",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div style="font-size: 13px;">{[this.getDeskripsi(values)]}</div>',"</tpl>",{getDeskripsi:function(b){var a=b.REFERENSI?b.REFERENSI.RUANGAN?b.REFERENSI.RUANGAN.DESKRIPSI:"":"";return a}})},{xtype:"templatecolumn",text:"Ket",flex:0.5,dataIndex:"JENIS",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div style="font-size: 13px;">{[this.getDeskripsi(values.JENIS)]}</div>',"</tpl>",{getDeskripsi:function(b){var a=b==0?"Masuk":"Pulang";return a}})},{xtype:"templatecolumn",text:"Jenis Absen",flex:1,dataIndex:"JENIS",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div style="font-size: 13px;">{[this.getDeskripsi(values.ABSEN)]}</div>',"</tpl>",{getDeskripsi:function(e){var a=["Dokter Poli","Onsite","Tindakan Ruangan","Visite"],b=(e>0)?a[e-1]:"";return b}})},{xtype:"templatecolumn",text:"Metode Absen",flex:0.5,dataIndex:"METHOD",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div style="font-size: 13px;">{[this.getDeskripsi(values.METHOD)]}</div>',"</tpl>",{getDeskripsi:function(e){var a=["Mobile","PC"],b=a[e];return b}})},{text:"Tanggal",flex:1,columns:[{text:"Absen",flex:1,align:"center",xtype:"datecolumn",format:"Y-m-d H:i:s",dataIndex:"SCAN_DATE"},{text:"Input",flex:1,align:"center",xtype:"datecolumn",format:"Y-m-d H:i:s",dataIndex:"TANGGAL"}]},{xtype:"widgetcolumn",menuDisabled:true,sortable:false,align:"center",width:60,widget:{xtype:"button",ui:"soft-blue",style:"border-radius:10px;",padding:2,tootip:"Approve Absen",defaultType:"button",iconCls:"fas fa-thumbs-up",handler:"onClickApprove"},onWidgetAttach:"onWidgetAttach"}]});Ext.define("msdm.absensi.dokterpoli.scan.GridController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-dokterpoli-scan-grid",onWidgetAttach:function(b,a,f){var e=this;a.setHidden(!(f.get("METHOD")==1))},onClickApprove:function(b){var e=this,a=e.getView(),f=b.getWidgetRecord();a.openDialog("",true,200,450,{xtype:"msdm-absensi-dokterpoli-scan-approve-form",title:b.tootip,ui:"panel-black",iconCls:b.iconCls,showCloseButton:true},function(k,j){var g=j.down("msdm-absensi-dokterpoli-scan-approve-form");g.load(f);g.on("save",function(l){j.close()})})}});Ext.define("msdm.absensi.dokterpoli.scan.Workspace",{extend:"com.Form",xtype:"msdm-absensi-dokterpoli-scan-workspace",controller:"msdm-absensi-dokterpoli-scan-workspace",layout:{type:"vbox",align:"stretch"},bodyPadding:0,title:"Absen Dokter",ui:"panel-purple",iconCls:"fas fa-user-check",header:{items:[{xtype:"dokter-combo",emptyText:"[ Dokter ]",flex:1,listeners:{select:"onSelectFilter"}},{xtype:"combo",displayField:"desk",valueField:"id",flex:1,store:Ext.create("data.store.Store",{fields:["desk","id"],data:[{id:1,desk:"Dokter Poli"},{id:2,desk:"Onsite"},{id:3,desk:"Tindakan Ruangan"},{id:4,desk:"Visite"}]}),listeners:{select:"onSelectFilter"}},{xtype:"datefield",emptyText:"[ Tanggal ]",flex:0.5,format:"Y-m-d",reference:"tanggalfilter",listeners:{select:"onSelectFilter"}},{xtype:"button",ui:"soft-red",iconCls:"fas fa-plus",tooltip:"Absen Dokter",handler:"onTambahAbsen"}]},items:[{flex:1,reference:"gridabsen",xtype:"msdm-absensi-dokterpoli-scan-grid"}],load:function(){}});Ext.define("msdm.absensi.dokterpoli.scan.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-dokterpoli-scan-workspace",params:{},privates:{loadgrid:function(){var e=this,a=e.getReferences(),b=a.gridabsen,f=e.params;if(f.NIP&&f.SCAN_DATE&&f.ABSEN){f.DATESORT=true;b.load(f)}}},onTambahAbsen:function(f){var g=this,b=g.getReferences(),e=b.tanggalfilter,a=g.getView();a.openDialog("",true,700,180,{xtype:"msdm-absensi-dokterpoli-scan-form",title:"Form Lupa Absen",ui:"panel-red",iconCls:"fas fa-plus",showCloseButton:true},function(l,k){var j=k.down("msdm-absensi-dokterpoli-scan-form");j.createRecord({SCAN_DATE:e.getValue(),STATUS:1,VERSION:"APPS"});j.on("save",function(){j.createRecord({SCAN_DATE:e.getValue(),STATUS:1,VERSION:"APPS"})});k.on("close",function(){g.loadgrid()})})},onSelectFilter:function(a,f){var b=this,e=b.params;if(a.xtype=="dokter-combo"){e.NIP=f.get("NIP")}if(a.xtype=="combo"){e.ABSEN=f.get("id")}if(a.xtype=="datefield"){e.SCAN_DATE=Ext.Date.format(f,"Y-m-d")}b.params=e;b.loadgrid()}});Ext.define("msdm.absensi.dokterpoli.scan.approve.Form",{extend:"com.Form",xtype:"msdm-absensi-dokterpoli-scan-approve-form",controller:"msdm-absensi-dokterpoli-scan-approve-form",viewModel:{data:{absenscan:undefined,image:undefined}},model:"msdm.absensi.dokterpoli.scan.approve.Model",layout:{type:"hbox"},items:[{xtype:"image",border:true,style:"display: inline-block;",bind:{src:webservice.location+"msdm/imagesabsendokter?SHOWIMAGE=true&NIP={absenscan.NIP}&JADWAL={absenscan.ID_JADWAL}&TANGGAL={tanggal}"},width:350,height:350,alt:"no-image"}],buttons:[{text:"Approve Absen",ui:"soft-blue",handler:"onClickApprove"}],load:function(e){var b=this,a=b.getViewModel();a.set("absenscan",e);a.set("tanggal",Ext.Date.format(e.get("SCAN_DATE"),"Y-m-d"));b.createRecord({SCAN:e.get("ID")})}});Ext.define("msdm.absensi.dokterpoli.scan.approve.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-dokterpoli-scan-approve-form",onClickApprove:function(b){var e=this,a=e.getView();a.setLoading(true);a.save(b)}});Ext.define("msdm.absensi.laporan.Link",{extend:"com.Form",xtype:"msdm-absensi-laporan-link",border:false,initComponent:function(){var a=this;a.items=[{xtype:"container",flex:1,height:"100%",layout:"card",items:[{xtype:"msdm-penempatan-sekarang-grid",checkboxModel:true,selModel:{selType:"checkboxmodel",mode:"MULTI",checkOnly:true},ui:"panel-cyan"}]}];a.callParent(arguments)},removeHeader:function(){var f=this,b=f.down("dokterruangan-list"),e=f.down("perawatruangan-list"),a=f.down("staffruangan-list");f.actionRemove(b,1);f.actionRemove(b,3);f.actionRemove(e,1);f.actionRemove(e,1);f.actionRemove(e,3);f.actionRemove(a,1);f.actionRemove(a,1);f.actionRemove(a,3)},actionRemove:function(b,a){},setCardActive:function(a){var e=this,b=e.down("container");b.setActiveItem(a)},load:function(e){var b=this,a=b.down("msdm-penempatan-sekarang-grid");if(e){a.load({RUANGAN:e.get("ID"),STATUS:1})}}});Ext.define("msdm.absensi.laporan.Workspace",{extend:"com.Form",xtype:"msdm-absensi-laporan-workspace",controller:"msdm-absensi-laporan-workspace",title:"Laporan Absensi Pegawai",ui:"panel-cyan",defaults:{border:false},layout:"border",initComponent:function(){var a=this;a.items=[{layout:{type:"hbox",align:"stretch"},region:"north",items:[{xtype:"container",defaultType:"combobox",flex:1,defaults:{margin:4},layout:{type:"vbox",align:"stretch"},items:[{xtype:"datefield",fieldLabel:"Periode Awal",submitFormat:"Y-m-d",format:"d-m-Y",reference:"pawal"},{xtype:"datefield",fieldLabel:"Periode Akhir",submitFormat:"Y-m-d",format:"d-m-Y",reference:"pakhir"}]},{xtype:"container",defaultType:"combobox",flex:1,defaults:{margin:4},layout:{type:"vbox",align:"stretch"},items:[{xtype:"combobox",name:"RUANGAN",fieldLabel:"Ruangan",allowBlank:false,enterFocus:true,enforceMaxLength:true,forceSelection:true,validateOnBlur:true,displayField:"DESKRIPSI",valueField:"ID",queryMode:"local",typeAhead:true,emptyText:"[ Ruangan ]",store:{model:"data.model.Ruangan"},listeners:{select:"onSelectRuangan"}},{xtype:"combobox",fieldLabel:"Profesi",emptyText:" [ Profesi ] ",reference:"profesi",store:Ext.create("Ext.data.Store",{fields:["jenis","desk"],data:[{jenis:0,desk:"Dokter"},{jenis:1,desk:"Paramedis"},{jenis:2,desk:"Staff"}]}),displayField:"desk",valueField:"jenis",listeners:{}}]}]},{region:"center",layout:"fit",xtype:"msdm-absensi-laporan-link",reference:"pegawaiabsensi",flex:1}];a.buttons=[{text:"rincian",iconCls:"x-fa fa-file-pdf-o",listeners:{click:"OnRincian"},ui:"soft-red"},{text:"rekapan",iconCls:"x-fa fa-file-pdf-o",listeners:{click:"OnRekap"},ui:"soft-blue"}];a.callParent(arguments)},load:function(){var b=this,a=b.down("[name = RUANGAN]"),f=b.down("[reference = profesi]"),e=f.getStore().getData();link=b.down("msdm-absensi-laporan-link");f.setSelection(e.items[0]);a.getStore().loadData(b.getPenggunaRuangan());link.removeHeader()}});Ext.define("msdm.absensi.laporan.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-laporan-workspace",onSelectProfesi:function(b,g){var f=this,a=f.getView(),e=a.down("msdm-absensi-laporan-link");e.setCardActive(g.get("jenis"))},onSelectRuangan:function(b,g){var f=this,a=f.getView(),e=a.down("msdm-absensi-laporan-link");e.load(g)},OnRincian:function(a){this.cetak(true,"plugins.msdm.CetakRincianAbsensi")},OnRekap:function(a){this.cetak(true,"plugins.msdm.CetakRekapAbsensi")},privates:{cetak:function(f,m){var g=this,l=g.getView(),j=g.getReferences(),n=j.pegawaiabsensi.down("msdm-penempatan-sekarang-grid"),k=n.getSelection(),o="",e=j.pawal.getSubmitValue(),b=j.pakhir.getSubmitValue(),a="";k.forEach(function(p){if(o==""){o="'"+p.data.REFERENSI.PEGAWAI.NIP+"'"}else{o="'"+p.data.REFERENSI.PEGAWAI.NIP+"',"+o}});l.cetak({NAME:m,TYPE:f?"Pdf":"Word",EXT:f?"pdf":"docx",PARAMETER:{PPAWAL:e,PPAKHIR:b,PNIP:o},REQUEST_FOR_PRINT:!f,PRINT_NAME:"CetakHasil"},function(p){if(f){l.printPreview("Preview Rincian Absensi",p)}})}}});Ext.define("msdm.absensi.mesin.Combo",{extend:"com.Combo",alias:"widget.msdm-absensi-mesin-combo",viewModel:{stores:{store:{type:"msdm-absensi-mesin-store"}}},emptyText:"[Pilih Schedule]",displayField:"NAMA_MESIN"});Ext.define("msdm.absensi.mesin.Form",{extend:"com.Form",xtype:"msdm-absensi-mesin-form",controller:"msdm-absensi-mesin-form",model:"msdm.absensi.mesin.Model",defaultType:"textfield",layout:"hbox",defaults:{margin:"2.2.2.2",flex:1,allowBlank:false},items:[{name:"NAMA_MESIN",bind:"{NAMA_MESIN}",emptyText:"NAMA MESIN"},{name:"IP",bind:"{IP}",emptyText:"IP ADRESS"},{name:"SN",bind:"{SN}",emptyText:"SERIAL NUMBER"},{name:"ALG_VER",bind:"{ALG_VER}",emptyText:"ALG VERSION"}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:["->",{text:"Tambah",padding:4,xtype:"button",formBind:true,ui:"soft-blue",iconCls:"x-fa fa-plus",handler:"onSimpan"}]}]});Ext.define("msdm.absensi.mesin.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-mesin-form",onSimpan:function(b){var e=this,a=e.getView();a.save(b)}});Ext.define("msdm.absensi.mesin.Grid",{extend:"com.Grid",alias:"widget.msdm-absensi-mesin-grid",controller:"msdm-absensi-mesin-grid",viewModel:{stores:{store:{type:"msdm-absensi-mesin-store"}},data:{record:undefined,hideColumns:false}},columns:[{text:"ID",dataIndex:"ID",flex:1},{text:"MESIN",dataIndex:"NAMA_MESIN",flex:2},{text:"IP",dataIndex:"IP",flex:2},{text:"SERIAL NUMBER",dataIndex:"SN",flex:2},{text:"ALG VER",dataIndex:"ALG_VER",width:60},{xtype:"templatecolumn",text:"STATUS ",dataIndex:"STATUS",flex:1,tpl:'<div style="white-space:normal !important;">{REFERENSI.MESIN.STATUS}</div>'},{xtype:"widgetcolumn",text:"#",widget:{xtype:"fieldcontainer",defaultType:"button",layout:{type:"vbox",align:"stretch"},defaults:{padding:2,margin:"0 2 1 0"},items:[{text:"Hapus",action:0,handler:"onHapus",ui:"soft-red"}]}}]});Ext.define("msdm.absensi.mesin.GridController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-mesin-grid",onHapus:function(f){var e=this,b=e.getViewModel(),a=e.getView();a.showMessageBox({title:"Hapus data mesin",message:"Anda yakin ingin menghapus ?",ui:"window-red",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:f,fn:function(j){if(j==="yes"){model=f.ownerCt.getWidgetRecord();model.set("STATUS",0);model.scope=this;model.save({callback:function(g,k,l){if(l){a.notifyMessage("Data Mesin dihapus","danger-red")}else{model.set("STATUS",val?0:1)}}})}a.fireEvent("hapus",f)}})},onChange:function(k,l,j){var g=this,f=g.getViewModel(),a=g.getView(),b=f.get("store"),e=b.getAt(l);e.set("STATUS",j?1:0);e.scope=this;e.save({callback:function(m,n,o){if(o){a.notifyMessage("Status di "+(j==true?"Aktifkan":"NonAktifkan"),"danger-red")}else{e.set("STATUS",j?0:1)}}})}});Ext.define("msdm.absensi.mesin.Service",{extend:"com.Service",xtype:"mesinservice",serviceName:"msdm/mesin",timeout:30000,request:function(b,a,f,g){var e=this;Ext.Ajax.request({url:webservice.location+e.serviceName+"/"+b,method:a,jsonData:f,timeout:e.timeout,success:function(k,j){if(Ext.isFunction(g)){g(true,Ext.JSON.decode(k.responseText),j)}},failure:function(m,l){if(e.showError){try{var n=Ext.JSON.decode(m.responseText),k=n.detail?(Ext.isObject(n.detail)?Ext.JSON.encode(n.detail):n.detail):"Koneksi Gagal",j=Ext.create("Ext.window.MessageBox",{ui:"window-red",title:m.status+" - "+m.statusText,header:{padding:5}});j.show({msg:k,buttons:Ext.MessageBox.OK,animateTarget:e.animateTarget,scope:e.scope,icon:Ext.Msg.ERROR})}catch(o){var j=Ext.create("Ext.window.MessageBox",{ui:"window-red",title:"Error",header:{padding:5}});j.show({msg:"Koneksi Gagal",buttons:Ext.MessageBox.OK,animateTarget:e.animateTarget,scope:e.scope,icon:Ext.Msg.ERROR})}}if(Ext.isFunction(g)){g(false,m,l)}}})},deviceInfo:function(a,b){this.request("deviceInfo","POST",a,b)},downloadAllUserWithPaging:function(a,b){this.request("downloadAllUserWithPaging","POST",a,b)},uploadAllUser:function(a,b){this.request("uploadAllUser","POST",a,b)},uploadUser:function(a,b){this.request("uploadUser","POST",a,b)},deleteUser:function(a,b){this.request("deleteUser","POST",a,b)},deleteAllUser:function(a,b){this.request("deleteAllUser","POST",a,b)},downloadAllScanlogWithPaging:function(a,b){this.request("downloadAllScanlogWithPaging","POST",a,b)},downloadAllScanlogWithPagingAndDelete:function(a,b){this.request("downloadAllScanlogWithPagingAndDelete","POST",a,b)},downloadNewScanlog:function(a,b){this.request("downloadNewScanlog","POST",a,b)},downloadNewScanlogAndDelete:function(a,b){this.request("downloadNewScanlogAndDelete","POST",a,b)},downloadScanGPS:function(a,b){this.request("downloadScanGPS","POST",a,b)},deleteScanlog:function(a,b){this.request("deleteScanlog","POST",a,b)},syncDateTime:function(a,b){this.request("syncDateTime","POST",a,b)},deleteAdmin:function(a,b){this.request("deleteAdmin","POST",a,b)},deleteDeviceLog:function(a,b){this.request("deleteDeviceLog","POST",a,b)},initialization:function(a,b){this.request("initialization","POST",a,b)}});Ext.define("msdm.absensi.mesin.Workspace",{extend:"com.Form",xtype:"msdm-absensi-mesin-workspace",controller:"msdm-absensi-mesin-workspace",model:"msdm.absensi.presensi.Model",viewModel:{stores:{store:{type:"msdm-absensi-presensi-store"}},data:{pegawai:undefined}},layout:"border",defaults:{border:false},items:[{region:"north",width:"100%",title:"Form Mesin Absensi",ui:"panel-cyan",iconCls:"x-fa fa-edit",xtype:"msdm-absensi-mesin-form",listeners:{save:"onSave"}},{region:"center",layout:"fit",flex:1,title:"Daftar Mesin Absensi",ui:"panel-cyan",iconCls:"x-fa fa-table",xtype:"msdm-absensi-mesin-grid",checkboxModel:true,selModel:{selType:"checkboxmodel",mode:"MULTI",checkOnly:true},listeners:{hapus:"onHapus"}}],buttons:[{text:"Tarik Data Semua",ui:"soft-green",iconCls:"x-fa fa-clock-o",actionIdx:1,handler:"onAction"},{text:"Tarik Data Terbaru",ui:"soft-cyan",iconCls:"x-fa fa-keyboard",actionIdx:2,handler:"onAction"},"->",{text:"Sinkronisasi Tgl & Jam Mesin",ui:"soft-blue",iconCls:"fas fa-clock",actionIdx:3,handler:"onAction"}],initContext:false,onLoadRecord:function(b,f){var a=b.down("msdm-absensi-mesin-form"),e=b.down("msdm-absensi-mesin-grid");if(!b.initContext){if(e.setMenuContext){e.setMenuContext([{text:"Device Info",iconCls:"x-fa fa-info",actionIdx:0,scope:b.getController(),handler:"onMenuAction"},{text:"Tarik Semua Data",iconCls:"x-fa fa-clock-o",actionIdx:1,scope:b.getController(),handler:"onMenuAction"},{text:"Tarik Data Terbaru",iconCls:"x-fa fa-keyboard",actionIdx:2,scope:b.getController(),handler:"onMenuAction"},"-",{text:"<span style='color: red'>Tarik Semua Data & Hapus</span>",iconCls:"x-fa fa-clock-o",actionIdx:8,scope:b.getController(),handler:"onMenuAction"},{text:"<span style='color: red'>Tarik Data Terbaru & Hapus</span>",iconCls:"x-fa fa-keyboard",actionIdx:9,scope:b.getController(),handler:"onMenuAction"},"-",{text:"Sinkronisasi Tgl & Jam Mesin",iconCls:"fas fa-clock",actionIdx:3,scope:b.getController(),handler:"onMenuAction"},"-",{text:"<span style='color: red'>Hapus data Scanlog</span>",iconCls:"fas fa-recycle",actionIdx:4,scope:b.getController(),handler:"onMenuAction"},"-",{text:"Download data pengguna",iconCls:"fas fa-download",actionIdx:5,scope:b.getController(),handler:"onMenuAction"},{text:"Upload data pengguna",iconCls:"fas fa-upload",actionIdx:6,scope:b.getController(),handler:"onMenuAction"},{text:"<span style='color: red'>Hapus semua data pengguna</span>",iconCls:"fas fa-users-slash",actionIdx:7,scope:b.getController(),handler:"onMenuAction"}]);b.initContext=true}}e.setParams({STATUS:1});e.load();a.createRecord({STATUS:1});a.focus("NAMA_MESIN")}});Ext.define("msdm.absensi.mesin.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-mesin-workspace",mesin:undefined,init:function(){this.mesin=Ext.create("msdm.absensi.mesin.Service")},onSave:function(b){var e=this,a=e.getView();a.load()},onHapus:function(b){var e=this,a=e.getView();a.load()},onAction:function(f){var g=this,b=g.getView(),a=b.down("msdm-absensi-mesin-grid"),e=a.getSelection();e.forEach(function(j){g.doAction(f,j,f.actionIdx)})},onMenuAction:function(e){var f=this,b=f.getView(),a=b.down("msdm-absensi-mesin-grid"),g=a.getSelection();if(g.length==0){return}f.doAction(e,g[0],e.actionIdx)},privates:{doAction:function(b,k,j){var f=this,a=f.getView(),g=k.get("SN"),e=undefined;if(j==0){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.deviceInfo({sn:g},function(n,l,m){if(n){a.openWindow({title:"Mesin: "+g,iconCls:"fas fa-fingerprint",ui:"danger-blue",header:{margin:0,padding:"10 15 10 15"},maximized:false,width:300,height:"70%",items:{xtype:"propertygrid",source:l.data}},function(o,p){})}if(e){e.close()}else{a.setLoading(false)}})}if(j==1){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.timeout=5400000;f.mesin.downloadAllScanlogWithPaging({sn:g},function(n,l,m){if(n){a.notifyMessage("Semua data presensi di Mesin "+g+" berhasil disimpan ke database")}if(e){e.close()}else{a.setLoading(false)}})}if(j==2){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.timeout=1800000;f.mesin.downloadNewScanlog({sn:g},function(n,l,m){if(n){a.notifyMessage("Data presensi terbaru di Mesin "+g+" berhasil disimpan ke database")}if(e){e.close()}else{a.setLoading(false)}})}if(j==3){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.syncDateTime({sn:g},function(n,l,m){if(n){a.notifyMessage("Sinkronisasi Tgl & Waktu di Mesin "+g+" berhasil")}if(e){e.close()}else{a.setLoading(false)}})}if(j==4){a.showMessageBox({title:"Pengguna",message:"Anda yakin ingin hapus semua data scanlog / presensi di Mesin "+g+" ?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:b,fn:function(l){if(l==="yes"){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.deleteScanlog({sn:g},function(o,m,n){if(o){a.notifyMessage("Hapus semua data presensi di Mesin "+g+" berhasil")}if(e){e.close()}else{a.setLoading(false)}})}}})}if(j==5){a.showMessageBox({title:"Pengguna",message:"<span style='color: red; font-weight: bold'>PERHATIAN:</span><br/>Download semua data pengguna di mesin memerlukan waktu kurang lebih 45menit s/d 2jam<br/>Mohon untuk tidak melakukan reload atau menutup browser sampai proses selesai<br/><br/>Anda yakin ingin download semua data pengguna di Mesin "+g+" ?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:b,fn:function(l){if(l==="yes"){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.timeout=5400000;f.mesin.downloadAllUserWithPaging({sn:g},function(o,m,n){if(o){a.notifyMessage("Download semua data pengguna di Mesin "+g+" berhasil")}if(e){e.close()}else{a.setLoading(false)}})}}})}if(j==6){a.showMessageBox({title:"Pengguna",message:"Anda yakin ingin upload semua data pengguna di Mesin "+g+" ?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:b,fn:function(l){if(l==="yes"){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.timeout=5400000;f.mesin.uploadUser({sn:g},function(o,m,n){if(o){a.notifyMessage("Upload semua data pengguna di Mesin "+g+" berhasil")}if(e){e.close()}else{a.setLoading(false)}})}}})}if(j==7){a.showMessageBox({title:"Pengguna",ui:"window-red",message:"Anda yakin ingin hapus semua data pengguna di Mesin "+g+" ?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.WARNING,animateTarget:b,fn:function(l){if(l==="yes"){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.deleteAllUser({sn:g},function(o,m,n){if(o){a.notifyMessage("Hapus semua data pengguna di Mesin "+g+" berhasil")}if(e){e.close()}else{a.setLoading(false)}})}}})}if(j==8){a.showMessageBox({title:"Pengguna",ui:"window-red",message:"Anda yakin ingin tarik semua data scanlog / presensi dan kemudian di hapus pada Mesin "+g+" ?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.WARNING,animateTarget:b,fn:function(l){if(l==="yes"){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.timeout=5400000;f.mesin.downloadAllScanlogWithPagingAndDelete({sn:g},function(o,m,n){if(o){a.notifyMessage("Semua data presensi di Mesin "+g+" berhasil disimpan ke database dan telah dihapus pada mesin tsb")}if(e){e.close()}else{a.setLoading(false)}})}}})}if(j==9){a.showMessageBox({title:"Pengguna",ui:"window-red",message:"Anda yakin ingin tarik data scanlog / presensi terbaru dan kemudian di hapus pada Mesin "+g+" ?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.WARNING,animateTarget:b,fn:function(l){if(l==="yes"){if(a.showElapsedTime){e=a.showElapsedTime()}else{a.setLoading(true)}f.mesin.timeout=1800000;f.mesin.downloadNewScanlogAndDelete({sn:g},function(o,m,n){if(o){a.notifyMessage("Data presensi terbaru di Mesin "+g+" berhasil disimpan ke database dan telah dihapus pada mesin tsb")}if(e){e.close()}else{a.setLoading(false)}})}}})}}}});Ext.define("msdm.absensi.mesin.penarikan.Form",{extend:"com.Form",xtype:"msdm-absensi-mesin-penarikan-form",model:"msdm.absensi.waktupenarikan.Model",defaultType:"textfield",layout:"hbox",defaults:{margin:"2.2.2.2",flex:1,allowBlank:false},items:[{xtype:"msdm-absensi-mesin-combo",name:"MESIN",emptyText:"NAMA MESIN"},{xtype:"timefield",name:"WAKTU",emptyText:"WAKTU PENARIKAN DATA"}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:["->",{text:"Tambah",padding:4,xtype:"button",ui:"soft-blue",iconCls:"x-fa fa-plus",handler:"onSimpan"}]}]});Ext.define("msdm.absensi.presensi.Workspace",{extend:"com.Form",xtype:"msdm-absensi-presensi-workspace",model:"msdm.absensi.presensi.Model",controller:"msdm-absensi-presensi-workspace",viewModel:{stores:{store:{type:"msdm-absensi-presensi-store"}},data:{pegawai:undefined}},title:"Penarikan Data Absensi",ui:"panel-cyan",layout:{type:"vbox",align:"stretch"},items:[{xtype:"msdm-absensi-mesin-grid",checkboxModel:true,selModel:{selType:"checkboxmodel",mode:"MULTI",checkOnly:true}}],buttons:[{text:"Tarik Semua Data",ui:"soft-red",iconCls:"x-fa fa-keyboard",actionIdx:1,handler:"OnTarikData"},{text:"Tarik Data Terbaru",ui:"soft-cyan",iconCls:"x-fa fa-keyboard",actionIdx:2,handler:"OnTarikData"}],onLoadRecord:function(b,e){var a=b.down("msdm-absensi-mesin-grid");a.load()}});Ext.define("msdm.absensi.presensi.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-absensi-presensi-workspace",mesin:undefined,init:function(){this.mesin=Ext.create("msdm.absensi.mesin.Service")},OnTarikData:function(f){var g=this,b=g.getView(),a=b.down("msdm-absensi-mesin-grid"),e=a.getSelection();e.forEach(function(j){g.tarikdata(j,f.actionIdx)})},privates:{tarikdata:function(g,f){var b=this,a=b.getView(),e=g.get("SN");a.setLoading(true);if(f==1){b.mesin.downloadAllScanlogWithPaging({sn:e},function(l,j,k){if(l){a.notifyMessage("Data Presensi Mesin "+e+" berhasil disimpan ke database")}a.setLoading(false)})}if(f==2){b.mesin.downloadNewScanlog({sn:e},function(l,j,k){if(l){a.notifyMessage("Data Presensi Mesin "+e+" berhasil disimpan ke database")}a.setLoading(false)})}}}});Ext.define("msdm.dasarjadwal.Workspace",{extend:"com.Tab",xtype:"msdm-dasarjadwal-workspace",controller:"msdm-dasarjadwal-workspace",viewModel:{data:{pegawai:undefined}},defaults:{textAlign:"left"},layout:"fit",tabPosition:"top",tabRotation:0,cls:"x-br-right x-br-top",ui:"nav-tab",initComponent:function(){var a=this;a.items=[{title:"Kode Absensi",iconCls:"x-fa fa-registered",xtype:"msdm-dasarjadwal-kodeabsen-workspace"},{title:"Dasar Jadwal",iconCls:"x-fa fa-bell",xtype:"msdm-dasarjadwal-jadwal-workspace"}];a.callParent(arguments)},load:function(f){var e=this,b=e.getViewModel(),a=this.getActiveTab();if(a){a.load(f)}b.set("pegawai",f)},listeners:{tabchange:"onTabChange"}});Ext.define("msdm.dasarjadwal.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-dasarjadwal-workspace",onTabChange:function(g,a){var e=this,b=e.getViewModel(),f=b.get("pegawai");if(a.load){a.load(f)}}});Ext.define("msdm.dasarjadwal.jadwal.Form",{extend:"com.Form",xtype:"msdm-dasarjadwal-jadwal-form",controller:"msdm-dasarjadwal-jadwal-form",model:"msdm.dasarjadwal.Model",defaultType:"textfield",layout:"hbox",defaults:{margin:"2.2.2.2",flex:1,allowBlank:false},items:[{name:"SCHEDULE",emptyText:"DASAR JADWAL",xtype:"msdm-schedule-combo",flex:1},{xtype:"datefield",flex:1,format:"d-m-Y",submitFormat:"Y-m-d",name:"TANGGAL_BERLAKU",emptyText:"TANGGAL BERLAKU"},{text:"SET",padding:4,flex:0.2,xtype:"button",ui:"soft-blue",iconCls:"x-fa fa-plus",handler:"onSimpan"}],load:function(){var a=this,b=a.down("msdm-schedule-combo");b.load()}});Ext.define("msdm.dasarjadwal.jadwal.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-dasarjadwal-jadwal-form",onSimpan:function(b){var e=this,a=e.getView();if(a.getForm().isValid()){a.save(b)}}});Ext.define("msdm.dasarjadwal.jadwal.List",{extend:"com.Grid",xtype:"msdm-dasarjadwal-jadwal-list",controller:"msdm-dasarjadwal-jadwal-list",viewModel:{stores:{store:{type:"msdm-dasarjadwal-store"}},data:{listConfig:{paging:true}}},columns:[{text:"Dasar Jadwal",flex:1,dataIndex:"SCHEDULE",xtype:"templatecolumn",tpl:'<div style="white-space:normal !important;">{REFERENSI.SCHEDULE.DESK}</div>'},{text:"Tanggal Berlaku",flex:1,dataIndex:"TANGGAL_BERLAKU",xtype:"datecolumn",format:"d-m-Y"},{xtype:"checkcolumn",text:"#",dataIndex:"STATUS",width:50,listeners:{checkchange:"onChange"}}]});Ext.define("msdm.dasarjadwal.jadwal.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-dasarjadwal-jadwal-list",onChange:function(k,l,j){var g=this,f=g.getViewModel(),a=g.getView(),b=f.get("store"),e=b.getAt(l);e.set("STATUS",j?1:0);e.scope=this;e.save({callback:function(m,n,o){if(o){a.notifyMessage("Status di "+(j==true?"Aktifkan":"NonAktifkan"),"danger-red")}else{e.set("STATUS",j?0:1)}}})}});Ext.define("msdm.dasarjadwal.jadwal.Workspace",{extend:"com.Form",xtype:"msdm-dasarjadwal-jadwal-workspace",controller:"msdm-dasarjadwal-jadwal-workspace",viewModel:{data:{pegawai:undefined}},layout:"border",defaults:{border:false},items:[{region:"north",width:"100%",title:"Form Dasar Jadwal Pegawai",ui:"panel-cyan",iconCls:"x-fa fa-edit",xtype:"msdm-dasarjadwal-jadwal-form",listeners:{save:"onSave"}},{region:"center",layout:"fit",flex:1,title:"Dasar Jadwal",ui:"panel-cyan",iconCls:"x-fa fa-table",xtype:"msdm-dasarjadwal-jadwal-list"}],load:function(e){var b=this,a=b.getViewModel();form=b.down("msdm-dasarjadwal-jadwal-form"),list=b.down("msdm-dasarjadwal-jadwal-list");if(e){form.load();a.set("pegawai",e);form.createRecord({NIP:e.get("NIP"),STATUS:1});list.load({NIP:e.get("NIP"),STATUS:1})}}});Ext.define("msdm.dasarjadwal.jadwal.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-dasarjadwal-jadwal-workspace",onSave:function(b){var f=this,a=f.getView(),e=f.getViewModel();a.load(e.get("pegawai"))}});Ext.define("msdm.dasarjadwal.kodeabsen.Form",{extend:"com.Form",xtype:"msdm-dasarjadwal-kodeabsen-form",controller:"msdm-dasarjadwal-kodeabsen-form",model:"msdm.kodeabsensi.Model",defaultType:"textfield",layout:"hbox",defaults:{margin:"2.2.2.2",flex:1,allowBlank:false},items:[{name:"KODE_ABSEN",emptyText:"KODE ABSENSI",fieldLabel:"Kode Absensi"},{text:"SET",padding:4,flex:0.2,xtype:"button",ui:"soft-blue",iconCls:"x-fa fa-plus",handler:"onSimpan"}]});Ext.define("msdm.dasarjadwal.kodeabsen.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-dasarjadwal-kodeabsen-form",onSimpan:function(b){var e=this,a=e.getView();if(a.getForm().isValid()){a.save(b)}}});Ext.define("msdm.dasarjadwal.kodeabsen.Workspace",{extend:"com.Form",xtype:"msdm-dasarjadwal-kodeabsen-workspace",viewModel:{stores:{kodeabsensi:{type:"msdm-kodeabsensi-store"}},data:{pegawai:undefined}},layout:"border",defaults:{border:false},items:[{xtype:"msdm-dasarjadwal-kodeabsen-form"}],load:function(g){var f=this,a=f.getViewModel(),e=a.get("kodeabsensi"),b=f.down("msdm-dasarjadwal-kodeabsen-form");if(g){e.queryParams={NIP:g.get("NIP")};e.load({callback:function(j,k,l){if(l){b.loadRecord(j[0])}else{b.createRecord({NIP:g.get("NIP"),STATUS:1})}}})}}});Ext.define("msdm.dashboard.Form",{extend:"com.Form",xtype:"msdm-dashboard-form",controller:"msdm-dashboard-form",scrollable:true,items:[{xtype:"container",cls:"containerDashboard",style:"padding:35px;padding-bottom:15px",layout:{type:"hbox",align:"stretch"},border:false,reference:"leftwidget"},{xtype:"container",layout:{type:"hbox",align:"stretch"},cls:"badges1",padding:"15 35 35 35",reference:"rightwidget"}],createInfoWidget:function(){var a=this,b=a.down("[reference=leftwidget]");b.add({xtype:"msdm-widget-identitas-workspace",padding:"0 15 0 0",flex:1.3})},createInfoDetilWidget:function(){var a=this,b=a.down("[reference=leftwidget]");b.add({xtype:"msdm-widget-identitas-detail",flex:1.7})},createPenempatanWidget:function(){var b=this,a=b.down("[reference=rightwidget]");a.add({xtype:"msdm-widget-penempatanmutasi-info",padding:"0 15 0 0",flex:1})},createJadwalDinasWidget:function(){var b=this,a=b.down("[reference=rightwidget]");a.add({xtype:"msdm-widget-jadwaldinas-info",flex:1})},createAbsensiWidget:function(){var b=this,a=b.down("[reference=rightwidget]");a.add({xtype:"msdm-widget-absensi-info",padding:"0 0 0 15",flex:1})},listeners:{afterrender:"onAfterRender"}});Ext.define("msdm.dashboard.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-dashboard-form",task:undefined,onAfterRender:function(){var f=this,a=f.getView(),e=f.getViewModel().get("pegawai"),b=f.getReferences(),j=webservice.app,g=j.xpriv;a.suspendLayouts();a.createInfoWidget();a.createInfoDetilWidget();a.createPenempatanWidget();a.createJadwalDinasWidget();a.createAbsensiWidget();f.updateLayoutData();a.resumeLayouts();f.task={run:function(){if(!j.pauseAutoRefresh){f.task.interval=60000;b.leftwidget.items.each(function(l){try{l.refresh()}catch(k){}});b.rightwidget.items.each(function(l){try{}catch(k){}})}},interval:500};Ext.TaskManager.start(f.task)},updateLayoutData:function(){var e=this,b=e.getViewModel(),a=e.getReferences(),f=b.get("pegawai");a.leftwidget.items.each(function(k){var j=k.getViewModel(),g=j.get("pegawai");j.set("pegawai",f);j.notify()});a.rightwidget.items.each(function(k){var j=k.getViewModel(),g=j.get("pegawai");k.load(f)})},setActiveItem:function(f){var e=this,a=e.getView().ownerCt,b=a.getLayout();if(f=="pasien-form"){a.createPasienForm()}if(f=="pendaftaran-form"){a.createPendaftaranForm()}b.setActiveItem(a.getIndexItem(f));return b.getActiveItem()},onActivate:function(){if(this.task){this.task.interval=500;Ext.TaskManager.start(this.task)}},onDeactivate:function(){Ext.TaskManager.stop(this.task)},destroy:function(){var a=this;Ext.TaskManager.stop(a.task);a.callParent()}});Ext.define("msdm.dashboard.Workspace",{extend:"com.Form",xtype:"msdm-dashboard-workspace",viewModel:{data:{record:undefined,xpriv:undefined}},layout:{type:"vbox",align:"stretch"},border:false,cls:"containerDashboard",initComponent:function(){var a=this,b=a.getViewModel().get("record");a.items=[{xtype:"msdm-dashboard-form",reference:"pegawaidashboard",viewModel:{data:{pegawai:b}}}];a.callParent(arguments)}});Ext.define("msdm.indexskoring.Form",{extend:"com.Form",xtype:"msdm-indexskoring-form",controller:"msdm-indexskoring-form",viewModel:{data:{temp:undefined}},model:"msdm.indexskoring.Model",layout:"fit",border:false,fieldDefaults:{labelAlign:"top"},initComponent:function(){var a=this;a.items=[{flex:1,layout:{type:"vbox",align:"stretch"},title:"Form",iconCls:"x-fa fa-file-o",border:false,items:[{layout:"hbox",defaults:{flex:1,margin:"2 2 2 2",bind:{readOnly:"{formConfig.viewOnly}"},border:false},bodyPadding:10,border:false,items:[{xtype:"numberfield",hideTrigger:true,reference:"indexskoringform",fieldLabel:"Nilai",name:"NILAI",bind:{value:"{record.NILAI}"},decimalPrecision:2,allowDecimals:true,bind:{decimalPrecision:"{decimalPrecision}",value:"{value}"},setDecimalPrecision:function(b){this.decimalPrecision=b},decimalSeparator:"."},{fieldLabel:"Tanggal Berlaku",xtype:"datefield",name:"TANGGAL_BERLAKU",enterFocus:true,allowBlank:false,format:"Y-m-d",bind:{value:"{record.TANGGAL_BERLAKU}"}}]}],buttons:[{text:"Simpan",ui:"soft-blue",iconCls:"x-fa fa-save",handler:"onSimpan",bind:{hidden:"{formConfig.simpan}"},tooltip:{text:"Simpan",mouseOffset:[0,-75]}},{text:"Reset",ui:"soft-red",iconCls:"x-fa fa-refresh",handler:"onReset",bind:{hidden:"{formConfig.simpan}"},tooltip:{text:"Reset",mouseOffset:[0,-75]}},{text:"Ganti Nilai",ui:"soft-green",iconCls:"x-fa fa-history",handler:"onGanti",bind:{hidden:"{!formConfig.simpan}"},tooltip:{text:"Ganti Nilai",mouseOffset:[0,-75]}}]}];a.callParent(arguments)}});Ext.define("msdm.indexskoring.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-indexskoring-form",onReset:function(){var e=this,a=e.getView(),b=e.getViewModel().get("temp"),f=a.getRecord();if(b){obj={NIP:b.get("NIP"),STATUS:1,TANGGAL:a.getSysdate()}}else{obj={NIP:f.get("NIP"),STATUS:1,TANGGAL:a.getSysdate()}}a.getForm().reset();a.createRecord(obj)},onSimpan:function(f){var g=this,b=g.getView(),a=b.getRecord(),e=g.getViewModel().get("temp");if(e){e.set("STATUS",0);e.animateTarget=f;e.scope=g;e.showError=true;e.save({callback:function(l,j,k){if(k){b.save(f,{},function(o,m,n){if(n){g.getViewModel().set("temp",undefined)}})}}})}else{b.save(f)}},onGanti:function(f){var j=this,b=j.getView(),g=j.getViewModel(),a=b.getRecord(),e={success:"Data telah terganti",failed:"Gagal menganti data"};b.showMessageBox({title:"Konfirmasi",message:"Apakah anda ingin mengganti data?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,fn:function(k){if(k=="yes"){g.set("temp",Ext.create("msdm.indexskoring.Model",a.data));b.setFormConfig({viewOnly:true,simpan:false});j.onReset()}}})}});Ext.define("msdm.indexskoring.List",{extend:"com.Grid",alias:"widget.msdm-indexskoring-list",viewModel:{stores:{store:{type:"msdm-indexskoring-store"}}},cls:"x-br-top",border:true,initComponent:function(){var a=this;a.columns=[{xtype:"rownumberer",text:"No",align:"left",width:70},{text:"Nilai",dataIndex:"NILAI",flex:1,align:"left"},{xtype:"datecolumn",text:"Tanggal Berlaku",dataIndex:"TANGGAL_BERLAKU",align:"left",formatter:'date("d-m-Y")',flex:1}];a.callParent(arguments)}});Ext.define("msdm.indexskoring.Workspace",{extend:"com.Tab",xtype:"msdm-indexskoring-workspace",controller:"msdm-indexskoring-workspace",viewModel:{stores:{store:{type:"msdm-indexskoring-store"}}},defaults:{flex:1,bodyPadding:5},layout:"fit",ui:"header-tab",initComponent:function(){this.items=[{title:"Form ",xtype:"msdm-indexskoring-form",flex:1,layout:"fit",reference:"indexskoringform",history:false,listeners:{reload:"onReload",save:"onSuccess"}},{title:"History",flex:1,xtype:"msdm-indexskoring-list"}];this.callParent(arguments)},load:function(g){var e=this,a=e.getViewModel().get("store"),b=e.down("msdm-indexskoring-form"),f=e.down("msdm-indexskoring-list");if(g){f.setListConfig({paging:true});f.setParams({NIP:g,STATUS:0});a.queryParams={NIP:g,STATUS:1};a.load({callback:function(l,k,n){if(n){var j=l[0].get("STATUS")==1;b.setFormConfig({viewOnly:!j,simpan:j});b.loadRecord(l[0])}else{b.setFormConfig({viewOnly:false,simpan:false});var m={NIP:g,TANGGAL_BERLAKU:e.getSysdate(),STATUS:1};b.createRecord(m)}}});f.load()}}});Ext.define("msdm.indexskoring.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-indexskoring-workspace",onSuccess:function(e){var b=this,a=b.getView();if(e){a.load(e.get("NIP"))}}});Ext.define("msdm.jadwaldinas.Form",{extend:"com.Form",xtype:"msdm-jadwaldinas-form",items:[{xtype:"referensi-combo",params:{JENIS:82,STATUS:1},allowBlank:false,firstLoad:true,reference:"referensi",name:"JENIS_JADWAL"}],buttons:[{text:"Proses",iconCls:"x-fa fa-refresh",ui:"soft-red"}],load:function(b){var a=this}});Ext.define("msdm.jadwaldinas.List",{extend:"com.Grid",xtype:"msdm-jadwaldinas-list",controller:"msdm-jadwaldinas-list",viewModel:{stores:{store:Ext.create("Ext.data.Store",{fields:["NIP"]}),jadwalDinasStore:{type:"msdm-jadwaldinas-store"},jadwalDinasStoreTemp:{type:"msdm-jadwaldinas-store"},shift:{type:"msdm-schedule-shift-store"}},data:{datesend:undefined,column:undefined,daftarpegawai:undefined,ruangan:undefined,jenis:undefined,day:1,bln:1,tahun:"2019"}},ui:"panel-cyan",dockedItems:[{xtype:"toolbar",dock:"top",items:[{text:"Previous",padding:3,width:80,xtype:"button",ui:"soft-red",listeners:{click:"onPrevious"}},"->",{bind:{html:"{deskbulan}"}},"->",{text:"Next",padding:3,width:80,xtype:"button",ui:"soft-red",listeners:{click:"onNext"}}]}],initComponent:function(){var a=this;a.cellEditing=new Ext.grid.plugin.CellEditing({clicksToEdit:1,listeners:{afteredit:"onAfterEdit",beforeedit:"onBeforeEdit"}});a.plugins=[a.cellEditing];a.columns=[{xtype:"templatecolumn",text:"Nama Pegawai",sortable:false,dataIndex:"NIP",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div style="font-size: 13px;">{REFERENSI.PEGAWAI.NIP} - {REFERENSI.PEGAWAI.NAMA} ( {[this.getSchedule(values.REFERENSI)]} )</div>',"</tpl>",{getSchedule:function(e){var b=(e.DASAR_JADWAL)?(e.DASAR_JADWAL.REFERENSI)?e.DASAR_JADWAL.REFERENSI.SCHEDULE.DESK:"":"";return b}}),width:300}];a.callParent(arguments)},setColumns:function(l){var j=this,a=j.getViewModel(),m=Ext.Date.format(l,"Y-m"),g=new Date(m+"-1"),e=1,n=Ext.Date.format(l,"F ( Y )"),o=Ext.Date.format(l,"m"),k=Ext.Date.format(l,"Y"),f=Ext.Date.format(l,"m"),b=[];while(o==f){tanggal=Ext.Date.subtract(g,Ext.Date.DAY,-e);f=Ext.Date.format(tanggal,"m");b.push({text:e,dataIndex:e,width:60,editable:false,renderer:"onRenderDinas",editor:{xtype:"combobox",queryMode:"local",valueField:"ID",displayField:"JENIS_JADWAL",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="x-boundlist-item">','<div style="font-size: 12px;">{REFERENSI.JENIS_JADWAL.DESKRIPSI}</div>',"</div>","</tpl>"),displayTpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"{REFERENSI.JENIS_JADWAL.DESKRIPSI}","</tpl>"),bind:{store:"{shift}"}}});a.set("day",e);a.set("bln",o);a.set("tahun",k);e++}a.set("deskbulan",n);column={text:n,flex:1,sortable:false,columns:b};if(a.get("datesend")){head=j.getHeaderContainer();itmHead1=head.items.items[1];j.getHeaderContainer().remove(itmHead1)}j.getHeaderContainer().add(column);a.set("datesend",l)},setLoadJadwal:function(j){var e=this,b=e.getViewModel(),a=b.get("jadwalDinasStore"),f=b.get("jadwalDinasStoreTemp"),g={RUANGAN:j.get("ID"),FILTERTANGGAL:1,STATUS:1,TANGGAL:Ext.Date.format(b.get("datesend"),"Y-m"),start:0,limit:1000};a.removeAll();f.removeAll();a.setQueryParams(g);a.load();f.setQueryParams(g);f.load({callback:function(l,k,m){e.fireEvent("successload")}});b.set("ruangan",j)},insertPegawaiInJadwal:function(l){var k=this,e=k.getReferences(),j=k.getViewModel(),a=j.get("jadwalDinasStore"),g=0,f=Ext.create("msdm.jadwaldinas.Model",{}),b=k.getStore();obj={};j.set("daftarpegawai",l);l.forEach(function(p,u){if(p.get("REFERENSI")){var n=p.get("REFERENSI");if(n.PEGAWAI){var q=n.PEGAWAI,o=q.GELAR_DEPAN+" "+q.NAMA+" "+q.GELAR_BELAKANG,r=n.DASAR_JADWAL?n.DASAR_JADWAL:false,s=Ext.create("msdm.jadwaldinas.Model",{NIP:q.NIP,REFERENSI:{PEGAWAI:q}});if(r){var m=Ext.apply(s.get("REFERENSI"),{DASAR_JADWAL:r});s.set("REFERENSI",m)}var t=k.findJadwalPegawai(q.NIP);if(t.length>0){t.forEach(function(w,v){modrec=s.get("REFERENSI");nip=s.get("NIP");bt=Ext.Date.format(w.get("TANGGAL"),"j"),bt2=w.get("DINAS"),modrec[bt]=w.getData();obj[bt]=bt2;s.set(obj);s.set("REFERENSI",modrec);s.set("NIP",nip);delete obj[bt]})}b.insert(g,s);g++}}});k.setLoading(false)},findJadwalPegawai:function(e){var g=this,f=g.getViewModel(),a=f.get("jadwalDinasStoreTemp"),b=true,k=true,j=[];while(b==k){findjadwal=a.findRecord("NIP",e,0,false,true,true);if(findjadwal){j.push(findjadwal);a.remove(findjadwal);k=true}else{k=false}}return j},save:function(l){var k=this,a=k.getViewModel(),e=a.get("datesend"),g=a.get("ruangan"),m=a.get("daftarpegawai"),f=a.get("jadwalDinasStore"),j=a.get("jadwalDinasStoreTemp"),b={RUANGAN:g.get("ID"),FILTERTANGGAL:1,STATUS:1,TANGGAL:Ext.Date.format(e,"Y-m"),start:0,limit:1000};f.sync({callback:function(p,o,n){k.notifyMessage("Jadwal Telah Tersimpan");f.removeAll();j.removeAll();f.setQueryParams(b);f.load();j.setQueryParams(b);j.load({callback:function(r,q,s){k.getStore().removeAll();k.insertPegawaiInJadwal(m)}})}})}});Ext.define("msdm.jadwaldinas.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-jadwaldinas-list",nippegawai:undefined,onPrevious:function(o){var k=this,l=k.getView(),a=k.getViewModel(),m=a.get("store"),n=a.get("jadwalDinasStore"),f=a.get("jadwalDinasStoreTemp"),e=a.get("datesend"),g=a.get("ruangan"),j=a.get("daftarpegawai"),b=Ext.Date.subtract(e,Ext.Date.MONTH,1);if(g){n.removeAll();f.removeAll();param={RUANGAN:g.get("ID"),FILTERTANGGAL:1,STATUS:1,TANGGAL:Ext.Date.format(b,"Y-m"),start:0,limit:1000};l.setLoading(true);f.setQueryParams(param);f.load({callback:function(q,p,r){m.removeAll();l.setColumns(b);l.insertPegawaiInJadwal(j)}});n.setQueryParams(param);n.load()}},onNext:function(o){var k=this,l=k.getView(),a=k.getViewModel(),n=a.get("jadwalDinasStore"),f=a.get("jadwalDinasStoreTemp"),m=a.get("store"),e=a.get("datesend"),g=a.get("ruangan"),j=a.get("daftarpegawai"),b=Ext.Date.subtract(e,Ext.Date.MONTH,-1);if(g){n.removeAll();f.removeAll();params={RUANGAN:g.get("ID"),FILTERTANGGAL:1,STATUS:1,TANGGAL:Ext.Date.format(b,"Y-m"),start:0,limit:1000};l.setLoading(true);f.setQueryParams(params);f.load({callback:function(q,p,r){m.removeAll();l.setColumns(b);l.insertPegawaiInJadwal(j)}});n.setQueryParams(params);n.load()}},onAfterEdit:function(p,b){var r=this,l=b.record,s=l.get("REFERENSI"),o=l.getData(),f=r.getViewModel(),t=b.field,t=t.toString(),e=f.get("shift"),q=f.get("jadwalDinasStore"),n=f.get("ruangan"),j=f.get("datesend"),u=Ext.Date.format(j,"Y-m"),g=new Date(u+"-"+t),m={},k={};if(b.value){console.log(t);shiftfind=e.findRecord("ID",b.value,0,false,true,true);if(Ext.isNumeric(b.value)){k[t]={NIP:l.get("NIP"),RUANGAN:n.get("ID"),DINAS:b.value,TANGGAL:g,STATUS:1};if(o[t]){if(Ext.isNumeric(s[t].ID)&&s[t].ID!=0){var a=s[t].ID;k[t].ID=a;find=q.findRecord("ID",a,0,false,true,true)}else{find=q.findRecord("FILTER",l.get("NIP")+""+t,0,false,true,true)}}else{find=q.findRecord("FILTER",l.get("NIP")+""+t,0,false,true,true)}if(find){if(Ext.isNumeric(find.get("ID"))&&find.get("ID")!=0){find.set("DINAS",k[t].DINAS)}else{find.set(k[t])}}else{k[t].FILTER=l.get("NIP")+""+t;model=Ext.create("msdm.jadwaldinas.Model",k[t]);q.add(model)}if(shiftfind){k[t].REFERENSI={SHIFT:shiftfind.getData()}}m[t]=b.value;s[t]=k[t];l.set(m);l.set("REFERENSI",s);delete k[t]}}},onBeforeEdit:function(n,a){var l=this,k=l.nippegawai,g=l.getViewModel(),j=a.record,f=j.get("REFERENSI"),e=f?(f.DASAR_JADWAL)?f.DASAR_JADWAL:false:false,m=f?(f.PEGAWAI)?f.PEGAWAI.NIP:false:false,e=(e.REFERENSI)?(e.REFERENSI.SCHEDULE)?e.REFERENSI.SCHEDULE:false:false,b=g.get("shift");if(e){if(e.STATUS_SHIFT==0){a.cancel=true}else{if(k!=m){b.setQueryParams({SCHEDULE:e.ID});b.load();l.nippegawai=m}}}else{a.cancel=true}},onRenderDinas:function(o,b,l){var n=this,k=n.getViewModel(),g="",p=b.columnIndex,j=l.get("REFERENSI"),m=(j.DASAR_JADWAL)?j.DASAR_JADWAL:false,f=(j[p])?j[p].REFERENSI:g,e=(f.SHIFT)?(f.SHIFT.REFERENSI)?f.SHIFT.REFERENSI:g:g,g=(e.JENIS_JADWAL)?e.JENIS_JADWAL.DESKRIPSI:g,a=(f.SHIFT)?(f.SHIFT.JENIS_JADWAL)?f.SHIFT.JENIS_JADWAL:0:0;if(m){if(m.REFERENSI.SCHEDULE.STATUS_SHIFT==0){b.style="background-color:#24c5d6;"}else{if(a==0){b.style="background-color:#ff6699;"}else{if(a==1){b.style="background-color:#99ff99;"}else{if(a==2){b.style="background-color:#ffffcc;"}else{if(a==3){b.style="background-color:#bfbfbf;"}}}}}}else{b.style="background-color:#4c4c4c;"}return g},onInputJadwal:function(b){var e=this,a=e.getView();a.openDialog("",true,800,450,{xtype:"msdm-jadwaldinas-form",ui:"panel-cyan",title:"Form",showCloseButton:true,iconCls:"x-fa fa-edit"},function(g,j){var f=j.down("msdm-jadwaldinas-form");f.load()})}});Ext.define("msdm.jadwaldinas.Workspace",{extend:"com.Form",xtype:"msdm-jadwaldinas-workspace",controller:"msdm-jadwaldinas-workspace",viewModel:{stores:{penempatansekarang:{type:"msdm-penempatan-sekarang-store"}}},layout:"border",ui:"panel-cyan",title:"Jadwal Dinas",initComponent:function(){var a=this;a.items=[{region:"north",title:"Ruangan",iconCls:"x-fa fa-edit",ui:"panel-cyan",layout:"hbox",defaults:{margin:"2.2.2.0",width:"17%"},items:[{xtype:"ruangan-combo",emptyText:" [ Direktur Utama ] ",params:{JENIS:1,STATUS:1},firstLoad:true,reference:"direktur",nextCombo:"direktorat",nextJenis:2,listeners:{select:"onSelectRuangan",blur:"onBlurRuangan"}},{xtype:"ruangan-combo",emptyText:" [ Direktorat ] ",reference:"direktorat",nextCombo:"instalasi",nextJenis:3,listeners:{select:"onSelectRuangan",blur:"onBlurRuangan"}},{xtype:"ruangan-combo",emptyText:" [ Instalasi ] ",reference:"instalasi",nextCombo:"unit",nextJenis:4,listeners:{select:"onSelectRuangan",blur:"onBlurRuangan"}},{xtype:"ruangan-combo",emptyText:" [ Unit ] ",reference:"unit",nextCombo:"subunit",nextJenis:5,listeners:{select:"onSelectRuangan",blur:"onBlurRuangan"}},{xtype:"ruangan-combo",emptyText:" [ Subunit ] ",reference:"subunit",nextJenis:6,listeners:{select:"onSelectRuangan"}},{xtype:"button",width:80,disabled:true,ui:"soft-blue",text:"View",reference:"btnview",handler:"onProsesView"}]},{xtype:"msdm-jadwaldinas-list",iconCls:"x-fa fa-calendar",title:"Tanggal",reference:"jadwal",region:"center",flex:1,listeners:{successload:"onSuccessLoad"}}];a.buttons=[{text:"Cetak",iconCls:"x-fa fa-save",ui:"soft-black",iconCls:"x-fa fa-print",handler:"onCetak"},{text:"Simpan",iconCls:"x-fa fa-save",ui:"soft-green",iconCls:"x-fa fa-save",handler:"onSimpan"}];a.callParent(arguments)},load:function(){var e=this,f=e.down("msdm-jadwaldinas-list"),a=e.down("[reference=btnview]"),b=e.down("[reference=subunit]");e.getForm().reset();a.setDisabled(true);f.getStore().removeAll();f.setColumns(e.getSysdate())}});Ext.define("msdm.jadwaldinas.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-jadwaldinas-workspace",subRuangan:undefined,privates:{loadCombo:function(e,f,g){var k=this,l=k.getReferences(),j=l.jadwal,a=l.btnview,m=k.getView(),b=e.getStore();k.subRuangan=g;b.removeAll();b.setQueryParams(f);b.load();a.setDisabled(true);j.setLoadJadwal(k.subRuangan);j.getStore().removeAll()},blurRuangan:function(e,b){var f=b+1,a=e.nextJenis;if(f!=a){e.getStore().removeAll()}e.select(null)}},onSelectRuangan:function(m,f,b){var j=this,l=j.getView(),k=j.getReferences(),g=k.jadwal,a=k.btnview,e=(m.nextCombo)?l.down("[reference="+m.nextCombo+"]"):false;j.subRuangan=f;if(e){j.loadCombo(e,{ID:f.get("ID"),JENIS:m.nextJenis,STATUS:1},f)}else{a.setDisabled(true);g.setLoadJadwal(j.subRuangan);g.getStore().removeAll()}},onBlurRuangan:function(e){var g=this,f=e.nextJenis+1,b=g.getView();for(i=f;i<=6;i++){g.blurRuangan(b.down("[nextJenis="+i+"]"),e.nextJenis)}},onSelectSubUnit:function(e,j){var f=this,b=f.getReferences(),g=b.jadwal,a=b.btnview;f.subRuangan=j;a.setDisabled(true);g.setLoadJadwal(f.subRuangan);g.getStore().removeAll()},onProsesView:function(n){var g=this,a=g.getViewModel(),k=g.getReferences(),l=k.profesi,f=k.jadwal,j=k.subunit,e=(g.subRuangan)?g.subRuangan:null,m=a.get("penempatansekarang"),b={RUANGAN:(e)?e.get("ID"):1,STATUS:1};f.setLoading(true);f.getStore().removeAll();m.setQueryParams(b);m.load({callback:function(p,o,q){if(q){f.insertPegawaiInJadwal(p)}else{f.setLoading(false)}}})},onSimpan:function(e){var f=this,a=f.getView(),b=f.getReferences(),g=b.jadwal;a.showMessageBox({title:"Simpan Jadwal",message:"Anda yakin ingin menyimpan jadwal?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:e,fn:function(j){if(j==="yes"){g.setLoading(true);g.save(e)}}})},onSuccessLoad:function(){var e=this,b=e.getReferences(),a=b.btnview;a.setDisabled(false)},onCetak:function(){var j=this,n=j.getView(),e=j.subRuangan,k=j.getReferences(),f=k.jadwal,l=f.getViewModel().get("tahun"),p=f.getViewModel().get("bln"),m=f.getViewModel().get("day"),a=new String(p),b=(a.length==2)?l+"-"+p+"-01":l+"-0"+p+"-01",o=(a.length==2)?l+"-"+p+"-"+m:l+"-0"+p+"-"+m,g=true;n.cetak({NAME:"plugins.msdm.CetakJadwalShift",TYPE:g?"Pdf":"Word",EXT:g?"pdf":"docx",PARAMETER:{TGLAWAL:b,TGLAKHIR:o,PRUANGAN:e.get("ID")},REQUEST_FOR_PRINT:!g,PRINT_NAME:"CetakHasil"},function(q){if(g){n.printPreview("Preview",q)}})}});Ext.define("msdm.jadwalwfh.List",{extend:"com.Grid",xtype:"msdm-jadwalwfh-list",viewModel:{stores:{store:Ext.create("Ext.data.Store",{fields:["NIP"]}),storeJadwalWFH:{type:"msdm-jadwalwfh-store"},storeJadwalWFHTemp:{type:"msdm-jadwalwfh-store"}},data:{datesend:undefined,column:undefined,daftarpegawai:undefined,ruangan:undefined,jenis:undefined,day:1,bln:1,tahun:new Date().getFullYear()}},ui:"panel-cyan",initComponent:function(){var a=this;a.cellEditing=new Ext.grid.plugin.CellEditing({clicksToEdit:1,listeners:{afteredit:"onAfterEdit",beforeedit:"onBeforeEdit"}});a.plugins=[a.cellEditing];a.columns=[{xtype:"templatecolumn",text:"Nama Pegawai",sortable:false,dataIndex:"NIP",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div style="font-size: 13px;">{REFERENSI.PEGAWAI.NAMA} <br> {REFERENSI.PEGAWAI.NIP} </div>',"</tpl>"),width:300}];a.callParent(arguments)},setColumns:function(l){var j=this,a=j.getViewModel(),m=Ext.Date.format(l,"Y-m"),g=new Date(m+"-1"),e=1,n=Ext.Date.format(l,"F ( Y )"),o=Ext.Date.format(l,"m"),k=Ext.Date.format(l,"Y"),f=Ext.Date.format(l,"m"),b=[];while(o==f){tanggal=Ext.Date.subtract(g,Ext.Date.DAY,-e);f=Ext.Date.format(tanggal,"m");b.push({text:e,dataIndex:e,width:60,editable:false,editor:{xtype:"combobox",queryMode:"local",valueField:"ID",displayField:"JENIS_JADWAL",store:Ext.create("Ext.data.Store",{fields:["ID","WFH"],data:[{ID:"0",WFH:"-"},{ID:"1",WFH:"WFH"}]})}});a.set("day",e);a.set("bln",o);a.set("tahun",k);e++}a.set("deskbulan",n);column={text:n,flex:1,sortable:false,columns:b};if(a.get("datesend")){head=j.getHeaderContainer();itmHead1=head.items.items[1];j.getHeaderContainer().remove(itmHead1)}j.getHeaderContainer().add(column);a.set("datesend",l)},setLoadJadwal:function(j){var e=this,b=e.getViewModel(),a=b.get("storeJadwalWFH"),f=b.get("storeJadwalWFHTemp"),g={RUANGAN:j.RUANGAN,STATUS:1,FILTERTANGGAL:1,TANGGAL:j.TANGGAL,start:0,limit:1000};a.removeAll();f.removeAll();f.setQueryParams(g);a.setQueryParams(g);a.load();f.load()},insertPegawaiInJadwal:function(m){var k=this,l=k.getReferences(),b=k.getViewModel(),a=b.get("storeJadwalWFH"),g=0,j=Ext.create("msdm.jadwalwfh.Model",{}),e=k.getStore(),f={};b.set("daftarpegawai",m);m.forEach(function(s,n){if(s.get("REFERENSI")){var p=s.get("REFERENSI");if(p.PEGAWAI){var o=p.PEGAWAI,q=o.GELAR_DEPAN+" "+o.NAMA+" "+o.GELAR_BELAKANG;j=Ext.create("msdm.jadwalwfh.Model",{NIP:o.NIP,REFERENSI:{Pegawai:{NAMA:q,NIP:o.NIP}}});var r=k.findJadwalPegawai(o.NIP);e.insert(g,j);g++}}});k.setLoading(false)},findJadwalPegawai:function(e){var g=this,f=g.getViewModel(),a=f.get("storeJadwalWFHTemp"),b=true,k=true,j=[];while(b==k){findjadwal=a.findRecord("NIP",e,0,false,true,true);if(findjadwal){j.push(findjadwal);a.remove(findjadwal);k=true}else{k=false}}return j}});Ext.define("msdm.jadwalwfh.Workspace",{extend:"com.Form",xtype:"msdm-jadwalwfh-workspace",controller:"msdm-jadwalwfh-workspace",viewModel:{stores:{penempatansekarang:{type:"msdm-penempatan-sekarang-store"}},data:{ruangan:""}},layout:"border",ui:"panel-cyan",title:"Jadwal Dinas",initComponent:function(){var a=this;a.items=[{region:"west",title:"Ruangan",flex:0.3,iconCls:"x-fa fa-edit",ui:"panel-cyan",xtype:"ruangan-tree",listeners:{select:"onRuanganSelect"}},{xtype:"panel",layout:{type:"vbox",align:"stretch"},iconCls:"x-fa fa-calendar",title:"Jadwal WFH",reference:"jadwal",flex:1,region:"center",flex:1,items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"combobox",queryMode:"local",displayField:"BULAN",fieldLabel:"Periode",flex:0.3,reference:"refbulan",value:new Date().getMonth(),allowBlank:false,valueField:"ID",store:Ext.create("Ext.data.Store",{fields:["ID","BULAN"],data:[{ID:"1",BULAN:"Januari"},{ID:"2",BULAN:"Februari"},{ID:"3",BULAN:"Maret"},{ID:"4",BULAN:"April"},{ID:"5",BULAN:"Mei"},{ID:"6",BULAN:"Juni"},{ID:"7",BULAN:"Juli"},{ID:"8",BULAN:"Agustus"},{ID:"9",BULAN:"September"},{ID:"10",BULAN:"Oktober"},{ID:"11",BULAN:"November"},{ID:"12",BULAN:"Desember"}]}),name:"BULAN"},{xtype:"combobox",queryMode:"local",displayField:"TAHUN",flex:0.3,reference:"reftahun",value:new Date().getFullYear(),allowBlank:false,valueField:"TAHUN",store:Ext.create("Ext.data.Store",{fields:["TAHUN"],data:[{TAHUN:"2020"},{TAHUN:"2021"},{TAHUN:"2022"},{TAHUN:"2023"},{TAHUN:"2024"},{TAHUN:"2025"}]}),name:"TAHUN",listeners:{change:"onSelectTahun"}},{xtype:"button",text:"View",handler:"onViewJadwal"}]},{xtype:"msdm-jadwalwfh-list"}],listeners:{successload:"onSuccessLoad"}}];a.buttons=[{text:"Cetak",iconCls:"x-fa fa-save",ui:"soft-black",iconCls:"x-fa fa-print",handler:"onCetak"},{text:"Simpan",iconCls:"x-fa fa-save",ui:"soft-green",iconCls:"x-fa fa-save",handler:"onSimpan"}];a.callParent(arguments)},load:function(){var a=this,b=a.down("msdm-jadwalwfh-list");b.getStore().removeAll();b.setColumns(a.getSysdate())}});Ext.define("msdm.jadwalwfh.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-jadwalwfh-workspace",onRuanganSelect:function(b,g){var f=this,a=f.getView(),e=a.getViewModel();e.set("ruangan",g.get("ID"))},onViewJadwal:function(p){var m=this,n=m.getView(),b=n.getViewModel(),k=n.down("msdm-jadwalwfh-list"),j=b.get("ruangan"),a=n.down("[name=TAHUN]").getValue(),e=n.down("[name=BULAN]").getValue(),l=a+"-"+e.padStart(2,"0"),o=b.get("penempatansekarang"),g={RUANGAN:j,STATUS:1},f={RUANGAN:j,TANGGAL:l};k.setLoadJadwal(f);k.getStore().removeAll();o.setQueryParams(g);o.load({callback:function(r,q,s){if(s){k.insertPegawaiInJadwal(r)}else{k.setLoading(false)}}})},onSimpan:function(a){var b=this;view=b.getView(),refs=b.getReferences(),jadwal=refs.jadwal;view.showMessageBox({title:"Simpan Jadwal",message:"Anda yakin ingin menyimpan jadwal?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:a,fn:function(e){if(e==="yes"){jadwal.setLoading(true);jadwal.save(a)}}})},onSuccessLoad:function(){var e=this,b=e.getReferences(),a=b.btnview;a.setDisabled(false)},onCetak:function(){var f=this,l=f.getView(),b=f.subRuangan,g=f.getReferences(),e=g.jadwal,j=e.getViewModel().get("tahun"),m=e.getViewModel().get("bln"),k=e.getViewModel().get("day"),a=new String(m);awal=(a.length==2)?j+"-"+m+"-01":j+"-0"+m+"-01";akhir=(a.length==2)?j+"-"+m+"-"+k:j+"-0"+m+"-"+k;preview=true;l.cetak({NAME:"plugins.msdm.CetakJadwalShift",TYPE:preview?"Pdf":"Word",EXT:preview?"pdf":"docx",PARAMETER:{TGLAWAL:awal,TGLAKHIR:akhir,PRUANGAN:b.get("ID")},REQUEST_FOR_PRINT:!preview,PRINT_NAME:"CetakHasil"},function(n){if(preview){l.printPreview("Preview",n)}})}});Ext.define("msdm.kartuasuransi.Form",{extend:"com.Form",xtype:"msdm-kartuasuransi-form",requires:["Ext.picker.Time"],controller:"msdm-kartuasuransi-form",viewModel:{data:{isNewForm:true,pegawai:undefined}},layout:{type:"hbox"},model:"msdm.kartuasuransi.Model",defaults:{margin:"0 5 0 0"},initComponent:function(){var a=this;a.items=[{xtype:"textfield",emptyText:"[ Nomor ]",name:"NOMOR",bind:"{record.NOMOR}",reference:"nomor",flex:2},{xtype:"referensi-combo",params:{JENIS:10,STATUS:1},firstLoad:true,name:"JENIS",enterFocus:true,typeAhead:true,forceSelection:true,validateOnBlur:true,emptyText:"[Jenis kartuasuransi]",bind:"{record.JENIS}",flex:1},{xtype:"button",iconCls:"x-fa fa-plus",ui:"soft-blue",handler:"onSimpan",formBind:true}];a.callParent(arguments)},onLoadRecord:function(b){var a=this;a.getViewModel().set("isNewForm",false);a.getViewModel().set("pegawai",b)}});Ext.define("msdm.kartuasuransi.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kartuasuransi-form",onSimpan:function(e){var f=this,a=f.getView(),b=a.getRecord(),g=a.down("[name = JENIS]"),j=g.getSelection();if(b){a.fireEvent("simpan",e,j)}}});Ext.define("msdm.kartuasuransi.List",{extend:"com.Grid",xtype:"msdm-kartuasuransi-list",controller:"msdm-kartuasuransi-list",viewModel:{stores:{store:{type:"msdm-kartuasuransi-store"}}},ui:"panel-gray",layout:"fit",initComponent:function(){var a=this;a.columns=[{align:"left",text:"Nomor",dataIndex:"NOMOR",flex:2},{xtype:"templatecolumn",align:"left",text:"Jenis",dataIndex:"JENIS",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.JENIS.DESKRIPSI}</div>',flex:1},{xtype:"checkcolumn",header:"Status",dataIndex:"STATUS",width:90,listeners:{checkchange:"onChange"}}];a.callParent(arguments)},load:function(e){var a=this;if(Ext.getClassName(e)=="data.model.Pegawai"){var b=e;e={NIP:b.get("NIP")}}a.setParams(e);a.callParent(e)}});Ext.define("msdm.kartuasuransi.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kartuasuransi-list",onChange:function(k,l,j){var g=this,f=g.getViewModel(),a=g.getView(),b=f.get("store"),e=b.getAt(l);e.set("STATUS",j?1:0);e.scope=this;e.save({callback:function(m,n,o){if(o){a.notifyMessage("Status di "+(j==true?"Aktifkan":"NonAktifkan"),"danger-red")}else{e.set("STATUS",j?0:1)}}})}});Ext.define("msdm.kartuasuransi.Workspace",{extend:"com.Form",xtype:"msdm-kartuasuransi-workspace",controller:"msdm-kartuasuransi-workspace",viewModel:{data:{pgwi:undefined}},title:"Kartu Asuransi",header:{iconCls:"x-fa fa-credit-card",margin:0},layout:"border",items:[{region:"north",border:true,xtype:"msdm-kartuasuransi-form",reference:"formkartuasuransipegawai",listeners:{simpan:"onSimpan"}},{region:"center",layout:"fit",flex:1,xtype:"msdm-kartuasuransi-list",reference:"listkartuasuransipegawai",listeners:{success:"onSuccess"}}],load:function(f,a){var e=this,b=e.getViewModel(),a=a?a:false;form=e.down("msdm-kartuasuransi-form"),list=e.down("msdm-kartuasuransi-list"),params={NIP:f.get("NIP")};list.load({NIP:f.get("NIP")});list.setGridConfig({paging:a});form.createRecord({STATUS:1,NIP:f.get("NIP")});b.set("pgwi",f)},saveList:function(g,a){var b=this,f=b.down("msdm-kartuasuransi-list"),e=f.getStore();e.each(function(j){j.set("NIP",g.get("NIP_BARU"))});e.sync({callback:function(l,k,j){b.notifyMessage("Kartu asuransi tersimpan");if(a){b.load(g)}}})}});Ext.define("msdm.kartuasuransi.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kartuasuransi-workspace",onSuccess:function(f,k,e){var j=this,b=j.getView(),g=j.getViewModel(),a=g.get("pgwi");b.load(a)},onSimpan:function(o,f){var j=this,l=j.getView(),b=j.getViewModel(),p=b.get("pgwi"),k=j.getReferences(),a=k.formkartuasuransipegawai,g=k.listkartuasuransipegawai,n=g.getStore(),m=(n.length==0)?0:n.length+1,e=a.getRecord();if(Ext.isNumeric(p.get("ID"))){a.save(o);l.load(p)}else{e.set("REFERENSI",{JENIS:f.getData()});n.insert(m,e)}}});Ext.define("msdm.kartuidentitas.Form",{extend:"com.Form",alias:"widget.msdm-kartuidentitas-form",title:"Kartu Identitas",header:{iconCls:"x-fa fa-credit-card",margin:0,padding:"5 15 5 15",layout:{type:"hbox",align:"middle"}},viewModel:{data:{isNewForm:true,pegawai:undefined}},layout:{type:"vbox",align:"stretch"},bodyPadding:5,defaults:{margin:"0 0 3"},items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"referensi-combo",params:{JENIS:9,STATUS:1},firstLoad:true,name:"JENIS",enterFocus:true,typeAhead:true,forceSelection:true,validateOnBlur:true,emptyText:"[Jenis Kartu]",margin:"0 1 0 1",flex:1,listeners:{specialkey:"onFocusEnter"}},{xtype:"textfield",name:"NOMOR",enterFocus:true,margin:"0 1 0 1",emptyText:"[Nomor Kartu]",flex:1}]},{xtype:"form-alamat",header:false,bodyPadding:0,border:false,listeners:{specialkey:"onFocusEnter"}}],getFormData:function(){var g=this.getForm().getValues(),f=this.down("form-alamat").getFormData(),e=!(g.NOMOR==""||g.NOMOR==null||Number(g.JENIS)==0);delete g.PROPINSI;delete g.KABUPATEN;delete g.KECAMATAN;g.WILAYAH=g.KELURAHAN;delete g.KELURAHAN;g=Ext.merge(g,f);return e?[g]:null},loadRecord:function(f){var e=this,g=f.get("KARTU_IDENTITAS")||null,g=Ext.isArray(g)?g[0]:g;g=Ext.getClassName(g)==""?new msdm.kartuidentitas.Model(g):g;if(g){e.down("form-alamat").loadRecord(g)}return e.getForm().loadRecord(g)}});Ext.define("msdm.kartuidentitas.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kartuidentitas-form",onSimpan:function(b){var e=this,a=e.getView();a.save(b)}});Ext.define("msdm.kartuidentitas.Workspace",{extend:"com.Form",xtype:"msdm-kartuidentitas-workspace",viewModel:{stores:{store:{type:"msdm-kartuidentitas-store"}},data:{pgwi:undefined}},items:[{xtype:"msdm-kartuidentitas-form",reference:"formkartuidentitaspegawai",listeners:{save:"onSuccess"}}],load:function(j){var g=this,e=g.getViewModel(),f=g.down("msdm-kartuidentitas-form"),b=g.getViewModel().get("store"),a=f.getViewModel().get("jeniskipstore");a.load();params={NIP:j.get("NIP")};b.setQueryParams(params);b.load(function(l,k,m){if(m){if(l.length>0){f.loadRecord(l[0])}}else{f.createRecord({STATUS:1,NIP:j.get("NIP")})}})}});Ext.define("msdm.keluarga.Form",{extend:"com.Form",xtype:"msdm-keluarga-form",controller:"msdm-keluarga-form",model:"msdm.keluarga.Model",defaults:{border:false,flex:1},items:[{layout:"hbox",defaultType:"textfield",defaults:{margin:"2.2.2.2",flex:1,allowBlank:false},items:[{name:"NAMA",emptyText:"NAMA"},{xtype:"referensi-combo",params:{JENIS:7,STATUS:1},name:"SHDK",emptyText:"SHDK",firstLoad:true}]},{layout:"hbox",defaultType:"textfield",defaults:{margin:"2.2.2.2",flex:1,allowBlank:true},items:[{xtype:"referensi-combo",emptyText:"JENIS KELAMIN",allowBlank:false,params:{JENIS:2,STATUS:1},name:"JENIS_KELAMIN",firstLoad:true},{xtype:"referensi-combo",emptyText:"PENDIDIKAN",params:{JENIS:3,STATUS:1},name:"PENDIDIKAN",firstLoad:true},{xtype:"referensi-combo",emptyText:"PEKERJAAN",params:{JENIS:4,STATUS:1},name:"PEKERJAAN",firstLoad:true}]},{layout:"hbox",defaultType:"textfield",defaults:{margin:"2.2.2.2",flex:1},items:[{name:"ALAMAT",allowBlank:true,emptyText:"ALAMAT"}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:["->",{text:"Tambah",padding:4,xtype:"button",ui:"soft-blue",iconCls:"x-fa fa-plus",handler:"onSimpan"}]}]});Ext.define("msdm.keluarga.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-keluarga-form",onSimpan:function(b){var e=this,a=e.getView();if(a.getForm().isValid()){a.save(b)}}});Ext.define("msdm.keluarga.List",{extend:"com.Grid",xtype:"msdm-keluarga-list",controller:"msdm-keluarga-list",viewModel:{stores:{store:{type:"msdm-keluarga-store"}},data:{listConfig:{paging:true}}},columns:[{text:"Nama",flex:1,dataIndex:"NAMA"},{text:"SHDK",flex:1,dataIndex:"SHDK",xtype:"templatecolumn",tpl:'<div style="white-space:normal !important;">{REFERENSI.SHDK.DESKRIPSI}</div>'},{text:"Jenis Kelamin",flex:1,dataIndex:"JENIS_KELAMIN",xtype:"templatecolumn",tpl:'<div style="white-space:normal !important;">{REFERENSI.JENIS_KELAMIN.DESKRIPSI}</div>'},{text:"Pendidikan",flex:1,dataIndex:"PENDIDIKAN",xtype:"templatecolumn",tpl:'<div style="white-space:normal !important;">{REFERENSI.PENDIDIKAN.DESKRIPSI}</div>'},{text:"Pekerjaan",flex:1,dataIndex:"PEKERJAAN",xtype:"templatecolumn",tpl:'<div style="white-space:normal !important;">{REFERENSI.PEKERJAAN.DESKRIPSI}</div>'},{text:"Alamat",flex:1,dataIndex:"ALAMAT"},{xtype:"checkcolumn",text:"#",dataIndex:"STATUS",width:50,listeners:{checkchange:"onChange"}}]});Ext.define("msdm.keluarga.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-keluarga-list",onChange:function(l,a,k){var g=this,f=g.getViewModel(),b=g.getView(),e=f.get("store"),j=e.getAt(a);j.set("STATUS",k?1:0);j.scope=g;j.save({callback:function(m,n,o){if(o){b.notifyMessage("Status di "+(k==true?"Aktifkan":"NonAktifkan"),"danger-blue")}}})}});Ext.define("msdm.keluarga.Workspace",{extend:"com.Form",xtype:"msdm-keluarga-workspace",controller:"msdm-keluarga-workspace",viewModel:{data:{pegawai:undefined}},layout:"border",defaults:{border:false},items:[{region:"north",width:"100%",title:"Form Keluarga Pegawai",ui:"panel-cyan",iconCls:"x-fa fa-edit",xtype:"msdm-keluarga-form",listeners:{save:"onSave"}},{region:"center",layout:"fit",flex:1,title:"Daftar Keluarga Pegawai",ui:"panel-cyan",iconCls:"x-fa fa-table",xtype:"msdm-keluarga-list"}],load:function(g){var e=this,a=e.getViewModel(),b=e.down("msdm-keluarga-form"),f=e.down("msdm-keluarga-list");if(g){a.set("pegawai",g);b.createRecord({NIP:g.get("NIP"),STATUS:1});f.load({NIP:g.get("NIP"),STATUS:1})}}});Ext.define("msdm.keluarga.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-keluarga-workspace",onSave:function(b){var f=this,a=f.getView(),e=f.getViewModel();a.load(e.get("pegawai"))}});Ext.define("msdm.kontak.Form",{extend:"com.Form",xtype:"msdm-kontak-form",requires:["Ext.picker.Time"],controller:"msdm-kontak-form",viewModel:{data:{isNewForm:true,pegawai:undefined}},layout:{type:"hbox"},defaults:{margin:"0 5 0 0"},model:"msdm.kontak.Model",initComponent:function(){var a=this;a.items=[{xtype:"textfield",emptyText:"[ Nomor ]",name:"NOMOR",reference:"nomor",flex:2},{xtype:"referensi-combo",params:{JENIS:8,STATUS:1},firstLoad:true,name:"JENIS",enterFocus:true,emptyText:"[Jenis Kontak]",flex:1},{xtype:"button",iconCls:"x-fa fa-plus",ui:"soft-blue",handler:"onSimpan"}];a.callParent(arguments)},onLoadRecord:function(b){var a=this;a.getViewModel().set("isNewForm",false);a.getViewModel().set("pegawai",b)}});Ext.define("msdm.kontak.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kontak-form",onSimpan:function(b){var e=this,a=e.getView(),f=a.down("[name = JENIS]"),g=f.getSelection();a.fireEvent("simpan",b,g)}});Ext.define("msdm.kontak.List",{extend:"com.Grid",xtype:"msdm-kontak-list",controller:"msdm-kontak-list",viewModel:{stores:{store:{type:"msdm-kontak-store"}}},ui:"panel-gray",layout:"fit",initComponent:function(){var a=this;a.columns=[{align:"left",text:"Nomor",dataIndex:"NOMOR",flex:2},{xtype:"templatecolumn",align:"left",text:"Jenis",dataIndex:"JENIS",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.JENIS.DESKRIPSI}</div>',flex:1},{xtype:"checkcolumn",header:"Status",dataIndex:"STATUS",width:90,listeners:{checkchange:"onChange"}}];a.callParent(arguments)},load:function(e){var a=this;if(Ext.getClassName(e)=="data.model.Pegawai"){var b=e;e={NIP:b.get("NIP")}}a.setParams(e);a.callParent(e)}});Ext.define("msdm.kontak.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kontak-list",onChange:function(k,l,j){var g=this,f=g.getViewModel(),a=g.getView(),b=f.get("store"),e=b.getAt(l);e.set("STATUS",j?1:0);e.scope=this;e.save({callback:function(m,n,o){if(o){a.notifyMessage("Status di "+(j==true?"Aktifkan":"NonAktifkan"),"danger-red")}else{e.set("STATUS",j?0:1)}}})}});Ext.define("msdm.kontak.Workspace",{extend:"com.Form",xtype:"msdm-kontak-workspace",controller:"msdm-kontak-workspace",viewModel:{data:{pgwi:undefined}},title:"Kontak",header:{iconCls:"x-fa fa-phone",margin:0},layout:"border",items:[{region:"north",border:true,xtype:"msdm-kontak-form",reference:"formkontakpegawai",listeners:{simpan:"onSimpan"}},{region:"center",layout:"fit",flex:1,xtype:"msdm-kontak-list",reference:"listkontakpegawai",listeners:{success:"onSuccess"}}],load:function(k,a){var f=this,b=f.getViewModel(),a=a?a:false,e=f.down("msdm-kontak-form"),g=f.down("msdm-kontak-list"),j={NIP:k.get("NIP")};g.load({NIP:k.get("NIP")});g.setGridConfig({paging:a});e.createRecord({STATUS:1,NIP:k.get("NIP")});b.set("pgwi",k)},saveList:function(f){var a=this,e=a.down("msdm-kontak-list"),b=e.getStore();b.each(function(g){g.set("NIP",f.get("NIP_BARU"))});b.sync({callback:function(l,k,j){a.notifyMessage("Kontak tersimpan");a.load(f)}})}});Ext.define("msdm.kontak.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-kontak-workspace",onSuccess:function(f,k,e){var j=this,b=j.getView(),g=j.getViewModel(),a=g.get("pgwi");b.load(a)},onSimpan:function(o,f){var j=this,l=j.getView(),b=j.getViewModel(),p=b.get("pgwi"),k=j.getReferences(),a=k.formkontakpegawai,g=k.listkontakpegawai,n=g.getStore(),m=(n.length==0)?0:n.length+1,e=a.getRecord();if(Ext.isNumeric(p.get("ID"))){a.save(o);l.load(p)}else{e.set("REFERENSI",{JENIS:f.getData()});n.insert(m,e)}}});Ext.define("msdm.laporan.Workspace",{extend:"com.Form",xtype:"msdm-laporan-workspace",controller:"msdm-laporan-workspace",viewModel:{data:{cetakperruangan:true}},layout:"border",cls:"x-br-top",border:false,initComponent:function(){var b=this;b.items=[{region:"west",width:300,cls:"x-br-right",layout:{type:"vbox",align:"stretch"},defaults:{margin:5},border:false,items:[{xtype:"laporan-filter",reference:"filter"},{xtype:"checkboxfield",boxLabel:"Cetak Per Pegawai",name:"tipecetak",listeners:{change:"onTipeCetak"},inputValue:"1"},{xtype:"ruangan-tree",reference:"treeRuangan",flex:1,listeners:{select:"onSelectRuangan"}},{xtype:"laporan-button-doc",height:30,reference:"doctype"}]},{xtype:"container",region:"center",border:false,items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},flex:1,bind:{hidden:"{cetakperruangan}"},items:[{xtype:"msdm-penempatan-sekarang-grid",border:false,checkboxModel:true,scrollable:true,autoScroll:true,selModel:{selType:"checkboxmodel",mode:"SINGLE",allowDeselect:true,checkOnly:true},reference:"pegawailist",flex:1},{xtype:"container",layout:{type:"vbox"},height:40,margin:"10 10 10 10",items:[{xtype:"button",text:"Preview",handler:"onTampilLaporan"}]}]},{xtype:"laporan-data-view",bind:{hidden:"{!cetakperruangan}"},viewModel:{stores:{store:{type:"laporan-detil-store",queryParams:{JENIS:"9005",STATUS:1}}}},border:false,reference:"laporanpegawai",listeners:{select:"onSelectReport"}}]}];b.callParent(arguments)},listeners:{afterrender:"onAfterRender"}});Ext.define("msdm.laporan.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-laporan-workspace",onAfterRender:function(){var b=this.getReferences();b.laporanpegawai.load()},onSelectReport:function(k,o,l){var m=this.getReferences(),g=m.filter.getParameters(),n=m.treeRuangan.getSelection().length>0?m.treeRuangan.getSelection()[0].get("ID"):"0",e=Ext.JSON.decode(o.get("REPORT_PARAMS"));g.PARAMETER.RUANGAN=n;g.PARAMETER.PNIP="";h=m.doctype.getDocType();e=Ext.apply(e,g);e=Ext.apply(e,h);this.getView().fireEvent("requestreport",o.get("DESKRIPSI"),e,true);m.laporanpegawai.deselect(l)},onTipeCetak:function(f,g){var e=this,a=e.getView(),b=a.getViewModel();if(g==true){b.set("cetakperruangan",false)}else{b.set("cetakperruangan",true)}},onSelectRuangan:function(g,j){var f=this,a=f.getView(),b=a.down("msdm-penempatan-sekarang-grid"),e=b.getViewModel().get("store");e.queryParams={STATUS:1,QUERY:j.get("ID")};e.load()},onTampilLaporan:function(a){var e=this;this.cetak(true,"plugins.msdm.cetakPayroll")},privates:{cetak:function(j,l){var g=this,b=g.getView(),f=g.getReferences(),e=b.down("msdm-penempatan-sekarang-grid"),a=f.filter.down("[reference=awal]").getValue(),k=e.getSelection();b.cetak({NAME:l,TYPE:j?"Pdf":"Word",EXT:j?"pdf":"docx",PARAMETER:{TGLAWAL:Ext.Date.format(a,"Y-m-d"),PNIP:k[0].get("NIP"),RUANGAN:""},REQUEST_FOR_PRINT:!j,PRINT_NAME:"CetakHasil"},function(m){if(j){b.printPreview("Preview Rincian Pay Roll",m)}})}}});Ext.define("msdm.liburnasional.Form",{extend:"com.Form",alias:"widget.msdm-liburnasional-form",model:"msdm.liburnasional.Model",controller:"msdm-liburnasional-form",viewModel:{data:{tanggal:"Pilih Tanggal"}},layout:{type:"vbox",align:"stretch"},defaults:{labelAlign:"top"},bodyPadding:5,items:[{xtype:"datefield",reference:"tanggal",fieldLabel:"Tanggal",name:"TANGGAL_LIBUR",format:"d-m-Y",submitFormat:"Y-m-d"},{xtype:"textareafield",fieldLabel:"Keterangan",name:"KETERANGAN",flex:1,margin:"0 5 10 5"}],buttons:[{xtype:"component",flex:1},{text:"Simpan",ui:"soft-green",iconCls:"x-fa fa-save",handler:"onSimpan"},{text:"Batal",xtype:"button",ui:"soft-red",iconCls:"x-fa fa-times",handler:"onBatal"}],load:function(){var e=this,b=e.getViewModel(),a=b.get("jenisabsen");a.load()}});Ext.define("msdm.liburnasional.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-liburnasional-form",onSimpan:function(e){var f=this,a=f.getView(),b=a.getRecord();a.save(e);a.fireEvent("simpan")},onBatal:function(f){var e=this,a=e.getView();a.fireEvent("batal")}});Ext.define("msdm.liburnasional.List",{extend:"com.Grid",alias:"widget.msdm-liburnasional-list",controller:"msdm-liburnasional-list",viewModel:{stores:{store:{type:"msdm-liburnasional-store"}}},bind:{store:"{store}"},cls:"x-br-top",border:false,columns:[{xtype:"rownumberer",text:"No",align:"left",width:40},{text:"TANGGAL",dataIndex:"TANGGAL_LIBUR",xtype:"datecolumn",dateFormat:"d-m-Y",flex:1},{text:"KETERANGAN",dataIndex:"KETERANGAN",flex:2,editor:"textfield"},{xtype:"checkcolumn",header:"STATUS",dataIndex:"STATUS",flex:0.3,stopSelection:true,listeners:{checkchange:"onChange"}}],plugins:{ptype:"cellediting",clicksToEdit:1},listeners:{edit:"onEdit"}});Ext.define("msdm.liburnasional.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-liburnasional-list",onChange:function(m,a,l){var k=this,e=k.getView(),j=e.getViewModel(),n=j.get("store"),f=n.getAt(a);f.set("STATUS",l?1:0);f.scope=this;f.save({callback:function(g,o,b){if(b){e.notifyMessage("Status "+(l==true?"di aktifkan":"di non aktifkan"))}}})},onEdit:function(g,k){var j=this,a=j.getView(),f=a.getViewModel(),l=f.get("store"),b=l.getAt(k.rowIdx);b.set("KETERANGAN",k.value);b.scope=this;b.save({callback:function(m,n,e){if(e){a.notifyMessage("Data berhasil diubah")}}});k.record.commit()}});Ext.define("msdm.liburnasional.Workspace",{extend:"com.Form",xtype:"msdm-liburnasional-workspace",controller:"msdm-liburnasional-workspace",viewModel:{data:{hideForm:true}},layout:"fit",ui:"panel-red",title:"Hari Libur Nasional dan Cuti Bersama",iconCls:"x-fa fa-list",header:{items:[{xtype:"button",margin:2,height:32,cls:"x-fa fa-plus hide-icon-tools",tooltip:"Tambah Hari Libur",listeners:{click:"onAddLiburNasional"}}]},layout:"fit",items:[{xtype:"msdm-liburnasional-list",reference:"liburnasionallist"}],load:function(e){var a=this,b=this.down("msdm-liburnasional-list");b.load({});b.setGridConfig({paging:true})}});Ext.define("msdm.liburnasional.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-liburnasional-workspace",onAddLiburNasional:function(b){var e=this,a=e.getView(),f=e.getReferences();a.openDialog("",true,"30%","50%",{xtype:"msdm-liburnasional-form",showCloseButton:true,ui:"panel-green",iconCls:"x-fa fa-pencil-square-o",title:"Form Input Libur Nasional"},function(g,k){var j=k.down("msdm-liburnasional-form");j.createRecord({STATUS:1});j.on("save",function(){f.liburnasionallist.reload();k.close()})},b)}});Ext.define("msdm.npwp.Form",{extend:"com.Form",xtype:"msdm-npwp-form",model:"msdm.npwp.Model",controller:"msdm-npwp-form",viewModel:{data:{tempNpwp:undefined}},layout:{type:"hbox",align:"stretch"},defaults:{margin:"2.2.2.2"},items:[{xtype:"textfield",name:"NOMOR",flex:1,allowBlank:false,fieldLabel:"Nomor NPWP"},{xtype:"button",tooltip:"Ganti",reference:"btnGanti",iconCls:"x-fa fa-sort-numeric-asc",ui:"soft-red",handler:"onBtnGanti"},{xtype:"button",tooltip:"Simpan",reference:"btnSimpan",hidden:true,iconCls:"x-fa fa-save",ui:"soft-blue",handler:"onBtnSimpan"},{xtype:"button",reference:"btnReload",tooltip:"Reload",iconCls:"x-fa fa-refresh",ui:"soft-black",handler:"onBtnReload"}],setConfigReadOnly:function(f){var g=this,b=g.getReferences(),e=b.btnGanti,a=b.btnSimpan,j=g.down("[name = NOMOR]");j.setReadOnly(f);a.setHidden(f);e.setHidden(!f)}});Ext.define("msdm.npwp.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-npwp-form",onBtnGanti:function(b){var f=this,e=f.getViewModel(),a=f.getView();e.set("tempNpwp",e.get("record"));a.createRecord({STATUS:1,NIP:e.get("tempNpwp").get("NIP")});a.setConfigReadOnly(false)},onBtnSimpan:function(b){var f=this,e=f.getViewModel(),g=e.get("tempNpwp")?e.get("tempNpwp"):undefined,a=f.getView();if(g){a.showMessageBox({title:"Perhatian",message:"Anda yakin ingin mengganti nomor npwp sebelumnya ?",ui:"window-red",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:b,fn:function(j){if(j==="yes"){g.set("STATUS",0);g.animateTarget=b;g.save({callback:function(l,k,m){if(m){a.save(b);e.set("tempNpwp",undefined)}}})}}})}else{a.save(b)}},onBtnReload:function(a){var b=this;b.getView().fireEvent("save",true)}});Ext.define("msdm.npwp.Workspace",{extend:"com.Form",xtype:"msdm-npwp-workspace",controller:"msdm-npwp-workspace",viewModel:{data:{pegawai:undefined}},items:[{xtype:"msdm-npwp-form",listeners:{save:"onReloadWorkspace"}}],load:function(f){var e=this,a=e.getViewModel(),b=e.down("msdm-npwp-form");a.set("pegawai",f);e.setLoading(true);storeNpwp=Ext.create("msdm.npwp.Store",{});storeNpwp.setQueryParams({NIP:f.get("NIP"),STATUS:1});storeNpwp.load({callback:function(j,g,k){e.setLoading(false);if(k){b.setConfigReadOnly(true);b.loadRecord(j[0])}else{b.setConfigReadOnly(false);b.createRecord({STATUS:1,NIP:f.get("NIP")})}}})}});Ext.define("msdm.npwp.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-npwp-workspace",onReloadWorkspace:function(a){var e=this,b=e.getViewModel();e.getView().load(b.get("pegawai"))}});Ext.define("msdm.pangkatgolonga.Form",{extend:"com.Form",xtype:"msdm-pangkatgolongan-form",controller:"msdm-pangkatgolongan-form",model:"msdm.pangkatgolongan.Model",layout:"hbox",defaults:{width:"49%",margin:"2.2.2.2",border:false},items:[{layout:"vbox",defaults:{width:"100%",margin:"1.1.1.1",allowBlank:false},items:[{xtype:"referensi-combo",name:"GOLONGAN",params:{JENIS:143,STATUS:1},firstLoad:true,fieldLabel:"Golongan"},{xtype:"textfield",name:"NAMA_GOLONGAN",fieldLabel:"Nama Golongan"},{xtype:"datefield",name:"TMT",fieldLabel:"T M T",format:"Y-m-d"},{xtype:"combobox",name:"STATUS_PEG",fieldLabel:"Status",store:Ext.create("data.store.Store",{fields:["ID","DESK"],data:[{ID:1,DESK:"Struktural"},{ID:2,DESK:"Fungsional"}]}),displayField:"DESK",valueField:"ID"}]},{layout:"vbox",defaults:{width:"100%",margin:"1.1.1.1",allowBlank:false},items:[{xtype:"textfield",name:"PEJABAT",fieldLabel:"Pejabat"},{xtype:"textfield",name:"NO_SK",fieldLabel:"Nomor SK"},{xtype:"datefield",name:"TGL_SK",fieldLabel:"Tanggal SK",format:"Y-m-d"},{xtype:"filefield",reference:"file",flex:0.2,fieldLabel:"Scan File",emptyText:"Dokumentasi",reference:"filerca",buttonConfig:{text:"",iconCls:"x-fa fa-upload",ui:"soft-blue",tooltip:"Import Data"},buttonOnly:false,listeners:{change:"onUpload"}}]}],buttons:[{text:"Simpan",iconCls:"x-fa fa-save",ui:"soft-blue",handler:"onSimpan"}]});Ext.define("msdm.pangkatgolongan.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pangkatgolongan-form",filedata:undefined,onSimpan:function(e){var f=this,a=f.getView(),b=a.getForm().getValues(),g=a.getRecord();b.FILE=f.filedata;if(a.getForm().isValid()){g.set(b);a.save(e)}},onUpload:function(f){var k=this,b=k.getView(),g=k.getViewModel(),j=f.fileInputEl.dom.files,e=j[0],a=new FileReader();Ext.Msg.show({title:"Perhatian",message:"Apakah anda yakin memilih file ini?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:f,fn:function(l){if(l==="yes"){a.readAsDataURL(e);a.addEventListener("loadend",function(){k.filedata=Ext.util.Base64.encode(a.result)})}}})}});Ext.define("msdm.pangkatgolongan.Grid",{extend:"com.Grid",xtype:"msdm-pangkatgolongan-grid",controller:"msdm-pangkatgolongan-grid",viewModel:{stores:{store:{type:"msdm-pangkatgolongan-store"}},data:{listConfig:{paging:true}}},columns:[{xtype:"rownumberer",text:"No",align:"left",width:60},{dataIndex:"GOLONGAN",xtype:"templatecolumn",flex:1,tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.GOLONGAN.DESKRIPSI}</div>',text:"Golongan"},{dataIndex:"NAMA_GOLONGAN",flex:1,text:"Nama Golongan"},{xtype:"datecolumn",format:"Y-m-d",dataIndex:"TMT",flex:1,text:"TMT"},{dataIndex:"PEJABAT",flex:1,text:"Pejabat"},{dataIndex:"NO_SK",flex:1,text:"No SK"},{dataIndex:"TGL_SK",flex:1,xtype:"datecolumn",format:"Y-m-d",text:"Tanggal SK"},{menuDisabled:true,sortable:false,align:"center",xtype:"actioncolumn",width:50,items:[{iconCls:"x-fa fa-file",tooltip:"Lihat File",handler:"onLihatFile"}]},{xtype:"checkcolumn",header:"Status",dataIndex:"STATUS",width:90,listeners:{checkchange:"onChange"}}]});Ext.define("msdm.pangkatgolongan.GridController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pangkatgolongan-grid",onChange:function(n,a,k){var l=this,m=l.getViewModel(),o=m.get("store"),j=o.getAt(a);j.set("STATUS",k?1:0);j.scope=this;j.save({callback:function(e,f,b){if(b){Ext.toast({headerPosition:"left",style:"padding: 7px 0px 0px 4px",border:false,header:{width:13},ui:"danger-blue",html:"Status di "+(k==true?"Aktifkan":"NonAktifkan "),align:"t"})}}})},onLihatFile:function(n,o,b,l,f,e){var j=this,a=j.getViewModel(),m=a.get("storeFile"),k=j.getView();msdm.pangkatgolongan.Model.load(e.get("ID"),{success:function(g,p){k.printPreview("FILE",g.get("FILE"))}})}});Ext.define("msdm.pangkatgolongan.Wokrspace",{extend:"com.Form",xtype:"msdm-pangkatgolongan-workspace",controller:"msdm-pangkatgolongan-workspace",viewModel:{data:{pegawai:undefined}},layout:"border",bodyPadding:0,items:[{region:"center",layout:"accordion",reference:"layoutcard",defaults:{cls:"shadow-panel",border:true},items:[{flex:1,title:"Daftar Pangkat / Golongan",ui:"panel-cyan",iconCls:"x-fa fa-list",xtype:"msdm-pangkatgolongan-grid"},{xtype:"msdm-pangkatgolongan-form",ui:"panel-red",iconCls:"x-fa fa-edit",title:"Form Pangkat / Golongan",listeners:{save:"onSave"}}]}],load:function(a){var e=this,g=e.down("[reference=layoutcard]"),f=e.down("msdm-pangkatgolongan-grid"),b=e.down("msdm-pangkatgolongan-form");e.getViewModel().set("pegawai",a);f.load({NIP:a.get("NIP")});b.createRecord({NIP:a.get("NIP"),STATUS:1})}});Ext.define("msdm.pangkatgolongan.WokrspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pangkatgolongan-workspace",onSave:function(b){var f=this,a=f.getView(),e=f.getViewModel();a.load(e.get("pegawai"))}});Ext.define("msdm.payroll.List",{extend:"com.Grid",xtype:"msdm-payroll-list",controller:"msdm-payroll-list",viewModel:{stores:{payrollStore:{type:"msdm-payroll-store"},payrollDetailStore:{type:"msdm-payroll-detail-store"},penempatansekarang:{type:"msdm-penempatan-sekarang-store"}},data:{store:undefined,disSimpan:true,disFinal:true,subunit:undefined,tanggal:undefined,statuspayroll:false,valperiodeawal:undefined,valperiodeakhir:undefined}},bind:{store:"{store}"},hideDocks:false,initComponent:function(){var a=this;a.columns=[{xtype:"rownumberer",text:"No",align:"left",width:40},{xtype:"templatecolumn",text:"Nama",flex:1,sortable:false,tpl:"<div>{REFERENSI.PEGAWAI.GELAR_DEPAN} {REFERENSI.PEGAWAI.NAMA} {REFERENSI.PEGAWAI.GELAR_BELAKANG}</div>"},{xtype:"templatecolumn",text:"Total Payroll",flex:1,sortable:false,tpl:"<div>{TOTALPAYROLL}</div>"}];a.dockedItems=[{xtype:"toolbar",dock:"bottom",ui:"footer",layout:{pack:"left"},items:[{xtype:"datefield",reference:"refperiodeawal",enterFocus:true,maxValue:new Date(),allowBlank:false,emptyText:"[ Periode Awal ]",format:"Y-m-d",editable:false},{xtype:"datefield",reference:"refperiodeakhir",enterFocus:true,maxValue:new Date(),allowBlank:false,emptyText:"[ Periode Akhir ]",format:"Y-m-d",editable:false},"->",{text:"Simpan",ui:"soft-green",iconCls:"x-fa fa-floppy-o",listeners:{click:"onClickSimpan"},bind:{disabled:"{disSimpan}"}},{text:"Samakan",ui:"soft-red",reference:"btnsamakan",hidden:a.hideDocks,iconCls:"x-fa fa-exchange",handler:"onSamakan",tooltip:"Samakan Data"},{text:"Final",ui:"soft-black",iconCls:"x-fa fa-check-circle",listeners:{click:"onClickFinal"},bind:{disabled:"{disFinal}"}}]}];a.callParent(arguments)},loadStore:function(b,k){var j=this,f=j.getViewModel(),g=j.getReferences(),a=f.get("payrollStore"),e=f.get("penempatansekarang");f.set("subunit",b);f.set("tanggal",k);a.removeAll();a.queryParams={RUANGAN:b,TANGGAL:Ext.Date.format(k,"Y-m"),FILTERTANGGAL:1};a.load({callback:function(o,m,n){if(n){j.setTitle("Ruangan : "+o[0].get("REFERENSI").RUANGAN.DESKRIPSI+" / Bulan : "+Ext.Date.format(k,"F, Y")+"");f.set("store",a);for(var l=0;l<o.length;l++){periodeawal=o[l].get("PERIODE_AWAL");periodeakhir=o[l].get("PERIODE_AKHIR");status=o[l].get("STATUS");if(periodeawal!=null){g.refperiodeawal.setValue(periodeawal);f.set("valperiodeawal",periodeawal)}if(periodeakhir!=null){g.refperiodeakhir.setValue(periodeakhir);f.set("valperiodeakhir",periodeakhir)}if(status==1){f.set("disSimpan",false);f.set("disFinal",false);g.btnsamakan.setHidden(true);f.set("statuspayroll",true)}else{f.set("disSimpan",true);f.set("disFinal",true);g.btnsamakan.setHidden(true)}}}else{e.removeAll();e.queryParams={RUANGAN:b,STATUS:1};e.load({callback:function(q,p,r){if(r){j.setTitle("Ruangan : "+q[0].get("REFERENSI").RUANGAN.DESKRIPSI+" / Bulan : "+Ext.Date.format(k,"F, Y")+"");f.set("store",e);blnkemarin=Ext.Date.subtract(k,Ext.Date.MONTH,1);a.removeAll();a.queryParams={RUANGAN:b,TANGGAL:Ext.Date.format(blnkemarin,"Y-m"),FILTERTANGGAL:1};a.load({callback:function(u,s,t){if(t){j.getView().setLoading(false);g.btnsamakan.setHidden(false);f.set("disSimpan",false);f.set("disFinal",true);g.refperiodeawal.setValue("");g.refperiodeakhir.setValue("")}else{j.getView().setLoading(false);g.btnsamakan.setHidden(true);f.set("disSimpan",false);f.set("disFinal",true);g.refperiodeawal.setValue("");g.refperiodeakhir.setValue("");f.set("statuspayroll",false)}}})}else{j.setTitle("Ruangan : / Bulan :");g.refperiodeawal.setValue("");g.refperiodeakhir.setValue("");g.btnsamakan.setHidden(true);f.set("disSimpan",true);f.set("disFinal",true);f.set("statuspayroll",false)}}})}}})},getData:function(){var e=this,f=e.getViewModel().get("store"),g=e.getViewModel().get("tanggal"),j=[];f.each(function(a){j.push({NIP:a.get("NIP"),RUANGAN:a.get("RUANGAN"),PERIODE_AWAL:e.getReferences().refperiodeawal.getValue(),PERIODE_AKHIR:e.getReferences().refperiodeakhir.getValue(),TANGGAL:g,STATUS:1})});return j},setFinal:function(){var e=this,f=e.getViewModel().get("store"),g=[];f.each(function(a){a.set("STATUS",2);g.push(a)});return g}});Ext.define("msdm.payroll.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-payroll-list",onClickSimpan:function(a){var b=this;view=b.getView(),datadetil=view.getData(),vm=b.getViewModel();if(b.getReferences().refperiodeawal.getValue()==null||b.getReferences().refperiodeakhir.getValue()==null){view.notifyMessage("Silahkan isi Periode Awal dan Periode Akhir terlebih dahulu.")}else{Ext.Msg.show({title:"Information",msg:"Simpan data?",icon:Ext.Msg.INFO,buttons:Ext.Msg.YESNO,animateTarget:a,fn:function(e){if(e=="yes"){if(vm.get("statuspayroll")){if(Ext.Date.format(b.getReferences().refperiodeawal.getValue(),"Y-m-d")!=Ext.Date.format(vm.get("valperiodeawal"),"Y-m-d")&&Ext.Date.format(b.getReferences().refperiodeakhir.getValue(),"Y-m-d")!=Ext.Date.format(vm.get("valperiodeakhir"),"Y-m-d")){vm.get("payrollStore").each(function(j,g){j.set("PERIODE_AWAL",Ext.Date.format(b.getReferences().refperiodeawal.getValue(),"Y-m-d"));j.set("PERIODE_AKHIR",Ext.Date.format(b.getReferences().refperiodeakhir.getValue(),"Y-m-d"))});vm.get("payrollStore").sync({callback:function(g){if(g){view.notifyMessage("Data Berhasil Di-update");view.loadStore(vm.get("subunit"),vm.get("tanggal"))}}})}}else{payroll=Ext.create("msdm.payroll.Model",{});length=datadetil.length;baris=0;for(var f=0;f<length;){payroll.set(datadetil[f]);payroll.animateTarget=a;payroll.scope=b;payroll.showError=true;payroll.save({callback:function(k,g,j){if(j){baris++;if(length==baris){view.notifyMessage("Data Berhasil Disimpan.");view.loadStore(vm.get("subunit"),vm.get("tanggal"))}}}});f++}}}}})}},onClickFinal:function(a){var e=this,b=e.getReferences();view=e.getView();vm=e.getViewModel();Ext.Msg.show({title:"Information",msg:"Finalkan data?",icon:Ext.Msg.INFO,buttons:Ext.Msg.YESNO,animateTarget:a,fn:function(f){if(f=="yes"){data=view.setFinal(),c=vm.get("store");c.sync({callback:function(g){if(g){Ext.toast({html:"Data berhasil difinalkan.",headerPosition:"left",style:"padding: 7px 0px 0px 4px",border:false,header:{width:13},ui:"danger-blue",align:"t"});view.loadStore(vm.get("subunit"),vm.get("tanggal"));view.fireEvent("finalPayroll")}}})}}})},onSamakan:function(f){var j=this,g=j.getViewModel(),a=j.getView(),e=g.get("subunit"),b=g.get("payrollStore");blnkemarin=Ext.Date.subtract(g.get("tanggal"),Ext.Date.MONTH,1);data=[];b.queryParams={RUANGAN:e,TANGGAL:Ext.Date.format(g.get("tanggal"),"Y-m"),FILTERTANGGAL:1};b.load({callback:function(m,k,l){if(l){a.notifyMessage("Data Bulan Ini Telah Diinput.")}else{Ext.Msg.show({title:"Information",msg:"Samakan data dengan bulan "+Ext.Date.format(blnkemarin,"F, Y")+"?",icon:Ext.Msg.INFO,buttons:Ext.Msg.YESNO,animateTarget:f,fn:function(n){if(n=="yes"){b.queryParams={RUANGAN:e,SHOW_DETIL:1,TANGGAL:Ext.Date.format(blnkemarin,"Y-m"),FILTERTANGGAL:1};b.load({callback:function(q,p,r){if(r){if(j.getReferences().refperiodeawal.getValue()==null&&j.getReferences().refperiodeakhir.getValue()==null){Ext.Msg.show({title:"Information",msg:"Data Periode Awal dan Periode Akhir disamakan dengan bulan "+Ext.Date.format(blnkemarin,"F, Y")+"?",icon:Ext.Msg.INFO,buttons:Ext.Msg.YESNO,animateTarget:f,fn:function(s){if(s=="yes"){b.each(function(w,v){var u=w.get("DETAIL");periodeawal=w.get("PERIODE_AWAL");periodeakhir=w.get("PERIODE_AKHIR");darr=[];Ext.Array.each(u,function(y,x){delete y.ID;darr.push(y)});data.push({NIP:w.get("NIP"),RUANGAN:w.get("RUANGAN"),PERIODE_AWAL:periodeawal,PERIODE_AKHIR:periodeakhir,TANGGAL:g.get("tanggal"),STATUS:1,PAYROLL_DETIL:darr})});b=Ext.create("msdm.payroll.Model",{});length=data.length;baris=0;for(var t=0;t<length;){b.set(data[t]);b.animateTarget=f;b.scope=j;b.showError=true;b.save({callback:function(v,u,w){if(w){baris++;if(length==baris){a.notifyMessage("Data Berhasil Disamakan.");a.loadStore(g.get("subunit"),g.get("tanggal"))}}}});t++}}}})}else{b.each(function(u,t){var s=u.get("DETAIL");darr=[];Ext.Array.each(s,function(w,v){delete w.ID;darr.push(w)});data.push({NIP:u.get("NIP"),RUANGAN:u.get("RUANGAN"),PERIODE_AWAL:j.getReferences().refperiodeawal.getValue(),PERIODE_AKHIR:j.getReferences().refperiodeakhir.getValue(),TANGGAL:g.get("tanggal"),STATUS:1,PAYROLL_DETIL:darr})});b=Ext.create("msdm.payroll.Model",{});length=data.length;baris=0;for(var o=0;o<length;){b.set(data[o]);b.animateTarget=f;b.scope=j;b.showError=true;b.save({callback:function(t,s,u){if(u){baris++;if(length==baris){a.notifyMessage("Data Berhasil Disamakan.");a.loadStore(g.get("subunit"),g.get("tanggal"))}}}});o++}}}}})}}})}}})}});Ext.define("msdm.payroll.Workspace",{extend:"com.Form",xtype:"msdm-payroll-workspace",controller:"msdm-payroll-workspace",layout:"border",ui:"panel-cyan",title:"Payroll",initComponent:function(){var a=this;a.items=[{region:"west",title:"Form",iconCls:"x-fa fa-pencil",ui:"panel-cyan",layout:{type:"vbox",align:"stretch"},collapsed:false,collapsible:true,scrollable:true,split:true,flex:1,items:[{layout:{type:"hbox",align:"stretch"},items:[{xtype:"ruangan-combo",emptyText:" [ Unit ] ",params:{JENIS:4},firstLoad:true,reference:"unit",listeners:{select:"onSelectRuangan"},flex:1},{xtype:"ruangan-combo",emptyText:" [ Subunit ] ",reference:"subunit",listeners:{select:"onSelectSubUnit"},flex:1},{xtype:"datefield",reference:"tanggal",enterFocus:true,maxValue:new Date(),allowBlank:false,emptyText:"[ Pilih Tanggal ]",format:"F, Y",listeners:{select:"onSelectTanggal"},editable:false,flex:1}]},{xtype:"msdm-payroll-list",iconCls:"x-fa fa-list-alt",ui:"panel-cyan",title:"Ruangan : / Bulan :",reference:"listpegawai",flex:1,listeners:{select:"onSelectPegPayroll",successload:"onSuccessLoad",finalPayroll:"onFinalPayroll"},hideDocks:true}]},{xtype:"msdm-payroll-detil-form-workspace",iconCls:"x-fa fa-list",ui:"panel-cyan",title:"Nama : / Ruangan : / Bulan :",reference:"payrolldetilformws",region:"center",flex:1}];a.callParent(arguments)},load:function(){}});Ext.define("msdm.payroll.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-payroll-workspace",onSelectRuangan:function(f,j){var g=this,a=g.getView(),e=g.getReferences(),b=e.subunit;store=b.getStore();b.select(null);e.tanggal.reset();store.removeAll();store.setQueryParams({ID:j.get("ID"),JENIS:5});store.load()},onSelectSubUnit:function(b,f){var e=this,a=e.getReferences();a.tanggal.reset()},onSelectTanggal:function(b){var e=this,a=e.getReferences();view=e.getView();if(a.unit.getValue()&&a.subunit.getValue()){a.listpegawai.loadStore(a.subunit.getValue(),a.tanggal.getValue());view.down("msdm-payroll-detil-form-workspace").loadRecord();a.payrolldetilformws.setTitle("Nama : / Ruangan : / Bulan :")}else{view.notifyMessage("Silahkan pilih Unit dan Sub Unit visite terlebih dahulu")}},onSelectPegPayroll:function(e,q,n,l,p){var o=this,m=o.getView(),r=o.getReferences(),b=o.getViewModel(),a=q.get("REFERENSI"),s=a.PEGAWAI;if(!q.get("TANGGAL")){r.payrolldetilformws.setTitle("Nama : "+s.GELAR_DEPAN+" "+s.NAMA+" "+s.GELAR_BELAKANG+" / Ruangan : "+a.RUANGAN.DESKRIPSI+" / Bulan : Payroll Belum Ada.")}else{r.payrolldetilformws.setTitle("Nama : "+s.GELAR_DEPAN+" "+s.NAMA+" "+s.GELAR_BELAKANG+" / Ruangan : "+a.RUANGAN.DESKRIPSI+" / Bulan : "+Ext.Date.format(q.get("TANGGAL"),"F, Y")+"")}m.down("msdm-payroll-detil-form-workspace").loadRecord(q)},onFinalPayroll:function(){var b=this,a=b.getView();a.down("msdm-payroll-detil-form-workspace").loadRecord()}});Ext.define("msdm.payroll.detil.Form",{extend:"com.Form",alias:"widget.msdm-payroll-detil-form",controller:"msdm-payroll-detil-form",viewModel:{stores:{payrollDetailStore:{type:"msdm-payroll-detail-store"}},data:{payroll:undefined}},border:false,initComponent:function(){var a=this;a.items=[{xtype:"form",layout:{type:"hbox"},border:false,defaults:{margin:"2 2 2 2"},items:[{xtype:"datefield",name:"TANGGAL",reference:"reftanggal",emptyText:"[Samakan Tanggal]",enterFocus:true,flex:1,allowBlank:false,minValue:new Date(),format:"Y-m-d"},{xtype:"button",text:"Simpan",ui:"soft-green",iconCls:"x-fa fa-save",handler:"onSimpan"}]}];a.callParent(arguments)},setRecord:function(e){var b=this,a=b.getViewModel();a.set("payroll",e)}});Ext.define("msdm.payroll.detil.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-payroll-detil-form",onSimpan:function(k){var g=this,a=g.getView(),b=g.getViewModel(),f=g.getReferences(),j=[];payrollDetailStore=b.get("payrollDetailStore");payroll=b.get("payroll");if(a.getForm().isValid()){payrollDetailStore.removeAll();payrollDetailStore.queryParams={PAYROLL:payroll.get("ID")};payrollDetailStore.load({callback:function(m,e,l){if(l){payrollDetailStore.each(function(o,n){j.push({REF_JENIS:o.get("REF_JENIS"),REF_ID:o.get("REF_ID"),NILAI:o.get("NILAI")})});payroll=Ext.create("msdm.payroll.Model",{NIP:payroll.get("NIP"),RUANGAN:payroll.get("RUANGAN"),TANGGAL:f.reftanggal.getValue()});payroll.set("PAYROLL_DETIL",j);payroll.save({callback:function(p,n,o){if(o){a.notifyMessage("Data Berhasil Disamakan.");a.fireEvent("load")}}})}}})}}});Ext.define("msdm.payroll.detil.List",{extend:"com.Grid",xtype:"msdm-payroll-detil-list",viewModel:{stores:{store:{type:"msdm-payroll-store"},payrollDetailStore:{type:"msdm-payroll-detail-store"}}},columns:[{xtype:"rownumberer",text:"No",align:"left",width:40},{text:"TANGGAL",xtype:"datecolumn",dataIndex:"TANGGAL",format:"d-m-Y",flex:1}]});Ext.define("msdm.payroll.detil.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-payroll-detil-list",onClickEdit:function(a,k){var j=this,f=a.ownerCt.getWidgetRecord(),e=j.getView();e.fireEvent("payrollEdit",f)},onClickSamakan:function(a,k){var l=this,j=a.ownerCt.getWidgetRecord(),e=l.getView(),m=l.getViewModel();e.openDialog("",true,300,100,{title:"Tanggal sebelumnya : "+Ext.Date.format(j.get("TANGGAL"),"d-m-Y")+"",xtype:"msdm-payroll-detil-form",ui:"panel-cyan",scrollable:true,showCloseButton:true},function(g,f){var b=f.down("msdm-payroll-detil-form");b.setRecord(j);b.on("load",function(){e.fireEvent("reload",j);f.close()});f.on("close",function(){e.fireEvent("reload",j)})},j,true,false)}});Ext.define("msdm.payroll.detil.Workspace",{extend:"com.Form",xtype:"msdm-payroll-detil-workspace",controller:"msdm-payroll-detil-workspace",layout:"border",initComponent:function(){var a=this;a.items=[{region:"west",title:"Daftar",ui:"panel-gray",xtype:"msdm-payroll-detil-list",listeners:{select:"onSelectPayrollList"},flex:1},{xtype:"msdm-payroll-detil-form-workspace",iconCls:"x-fa fa-list",ui:"panel-gray",title:"Nama : / Ruangan : / Bulan :",reference:"payrolldetilformws",region:"center",flex:2}];a.callParent(arguments)},load:function(g){var e=this,b=e.getViewModel(),a=e.down("[reference=payrolldetilformws]"),f=e.down("msdm-payroll-detil-list");a.getViewModel().set("hideSimpanPayroll",true);f.load({NIP:g.get("NIP")});f.setGridConfig({paging:true})}});Ext.define("msdm.payroll.detil.WokrspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-payroll-detil-workspace",onSelectPayrollList:function(l,r,o,m,q){var p=this,n=p.getView(),s=p.getReferences(),b=p.getViewModel(),a=r.get("REFERENSI"),e=a.PEGAWAI;if(!r.get("TANGGAL")){s.payrolldetilformws.setTitle("Nama : "+e.GELAR_DEPAN+" "+e.NAMA+" "+e.GELAR_BELAKANG+" / Ruangan : "+a.RUANGAN.DESKRIPSI+" / Bulan : Payroll Belum Ada.")}else{s.payrolldetilformws.setTitle("Nama : "+e.GELAR_DEPAN+" "+e.NAMA+" "+e.GELAR_BELAKANG+" / Ruangan : "+a.RUANGAN.DESKRIPSI+" / Bulan : "+Ext.Date.format(r.get("TANGGAL"),"F, Y")+"")}n.down("msdm-payroll-detil-form-workspace").loadRecord(r)}});Ext.define("msdm.payroll.detil.form.List",{extend:"com.Grid",alias:"widget.msdm-payroll-detil-form-list",controller:"msdm-payroll-detil-form-list",viewModel:{stores:{refStore:{type:"referensi-store"},payrollDetailStore:{type:"msdm-payroll-detail-store"}},data:{store:undefined,idPayroll:undefined}},bind:{store:"{store}"},initComponent:function(){var a=this;a.cellEditing=new Ext.grid.plugin.CellEditing({clicksToEdit:1,listeners:{edit:"editCell"}});a.plugins=[a.cellEditing];a.columns=[{xtype:"rownumberer",text:"No",align:"left",width:40},{text:"DESKRIPSI",dataIndex:"DESKRIPSI",flex:2},{text:"Nilai",dataIndex:"NILAI",align:"right",flex:1,editor:{xtype:"numberfield",hideTrigger:true,reference:"nilai",name:"NILAI"},renderer:"onRenderJmlHarga",summaryRenderer:"onSummaryRendererTotalHrg"}];a.features=[{ftype:"summary",dock:"bottom"}];a.callParent(arguments)},loadStore:function(b){var e=this,a=e.getViewModel();listStore=e.getViewModel().get("refStore");if(b){e.getViewModel().set("store",listStore);e.getViewModel().set("idPayroll",b.get("ID"));listStore.removeAll();listStore.queryParams={JENIS:89,STATUS:1};listStore.load()}else{a.get("store").removeAll()}},loadStores:function(b){var e=this,a=e.getViewModel();listStore=e.getViewModel().get("refStore");if(b){e.getViewModel().set("store",listStore);e.getViewModel().set("idPayroll",b.get("ID"));listStore.removeAll();listStore.queryParams={JENIS:90,STATUS:1};listStore.load()}else{a.get("store").removeAll()}},payrollpenambah:function(b){var e=this,a=e.getViewModel().get("payrollDetailStore");if(b){e.getViewModel().set("store",a);a.removeAll();a.queryParams={PAYROLL:b[0].get("ID"),REF_JENIS:89};a.load()}else{a.removeAll()}},payrollpengurang:function(b){var e=this,a=e.getViewModel().get("payrollDetailStore");if(b){e.getViewModel().set("store",a);a.removeAll();a.queryParams={PAYROLL:b[0].get("ID"),REF_JENIS:90};a.load()}else{a.removeAll()}},getData:function(){var e=this,f=e.getViewModel().get("refStore"),g=[];f.each(function(a){if(a.getData().NILAI!=undefined){nilai=a.getData().NILAI}else{nilai=0}g.push({PAYROLL:e.getViewModel().get("idPayroll"),REF_JENIS:a.get("JENIS"),REF_ID:a.get("ID"),NILAI:nilai})});return g},getTotal:function(){var e=this,f=e.getViewModel().get("store"),g=0;f.each(function(a){if(a.getData().NILAI>0){g+=a.getData().NILAI}});return g}});Ext.define("msdm.payroll.detil.form.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-payroll-detil-form-list",editCell:function(f,e,b){var g=this,a=g.getView();a.fireEvent("celledit")},onRenderJmlHarga:function(j,e,b,g,k,f,a){return Ext.util.Format.number(j,"0,00")},onSummaryRendererTotalHrg:function(g,b,e){var a=this.getView(),f=Ext.util.Format.number(a.getTotal(),"0,00");return'<span style="color:black;"> Rp. '+f+"</span>"}});Ext.define("msdm.payroll.detil.form.Workspace",{extend:"com.Form",xtype:"msdm-payroll-detil-form-workspace",controller:"msdm-payroll-detil-form-workspace",viewModel:{stores:{payrollStore:{type:"msdm-payroll-store"},payrollDetailStore:{type:"msdm-payroll-detail-store"}},data:{nip:undefined,statusPayroll:false,sumPayrollPenambah:0,sumPayrollPengurang:0,sumTotal:0,disSimpanPayroll:true,hideSimpanPayroll:false}},layout:"border",border:false,defaults:{margin:"2.2.2.2",flex:1},initComponent:function(){var a=this;a.items=[{region:"west",title:"Payroll Penambah",xtype:"msdm-payroll-detil-form-list",reference:"payrollpenambah",listeners:{celledit:"onCellEdit"}},{region:"center",title:"Payroll Pengurang",xtype:"msdm-payroll-detil-form-list",reference:"payrollpengurang",listeners:{celledit:"onCellEdit"}}];a.buttons=[{xtype:"component",bind:{html:"<b>Total Rp. {sumTotal}</b>"}},"->",{text:"Simpan",reference:"btnsimpan",iconCls:"x-fa fa-save",ui:"soft-blue",handler:"onSimpan",bind:{disabled:"{disSimpanPayroll}",hidden:"{hideSimpanPayroll}"}}];a.callParent(arguments)},loadRecord:function(k){var f=this,e=f.getViewModel(),a=e.get("payrollStore"),b=e.get("payrollDetailStore"),j=f.down("[reference=payrollpenambah]"),g=f.down("[reference=payrollpengurang]");if(k){e.set("nip",k);a.removeAll();a.queryParams={NIP:k.get("NIP"),TANGGAL:Ext.Date.format(k.get("TANGGAL"),"Y-m-d")};a.load({callback:function(p,n,o){if(o){for(var m=0;m<p.length;m++){var l=[];l[0]=[p[m].get("TOTALIDPAY")];idPayroll=p[m];if(l[0]==0){e.set("statusPayroll",false);j.loadStore(idPayroll);g.loadStores(idPayroll);e.set("sumTotal",0);if(p[0].get("STATUS")==1){e.set("disSimpanPayroll",false)}else{e.set("disSimpanPayroll",true)}}else{e.set("statusPayroll",true);e.set("sumTotal",idPayroll.get("TOTALPAYROLL"));j.payrollpenambah(p);g.payrollpengurang(p);if(p[0].get("STATUS")==1){e.set("disSimpanPayroll",false)}else{e.set("disSimpanPayroll",true)}}}}else{f.notifyMessage("Silahkan tekan tombol <b>Simpan</b> atau <b>Samakan</b> terlebih dahulu.");e.set("disSimpanPayroll",true);e.set("sumTotal",0);j.loadStore();g.loadStore()}}})}else{e.set("disSimpanPayroll",true);e.set("sumTotal",0);j.loadStore();g.loadStore()}},setSumTotal:function(){var b=this,f=b.down("[reference=payrollpenambah]"),e=b.down("[reference=payrollpengurang]"),a=b.getViewModel();a.set("sumTotal",f.getTotal()-e.getTotal())}});Ext.define("msdm.payroll.detil.form.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-payroll-detil-form-workspace",onSimpan:function(m){var j=this,k=j.getReferences(),b=j.getViewModel(),g=b.get("nip"),l=j.getView(),a=k.payrollpenambah.getData(),f=k.payrollpengurang.getData(),e=a.concat(f);Ext.Msg.show({title:"Information",msg:"Simpan data?",icon:Ext.Msg.INFO,buttons:Ext.Msg.YESNO,animateTarget:m,fn:function(n){if(n=="yes"){if(b.get("statusPayroll")){k.payrollpenambah.getStore().sync({callback:function(p){if(p){l.notifyMessage("Data Berhasil Diubah.");l.loadRecord(g)}}});k.payrollpengurang.getStore().sync({callback:function(p){if(p){l.notifyMessage("Data Berhasil Diubah.");l.loadRecord(g)}}})}else{payrolldetail=Ext.create("msdm.payroll.detail.Model",{});length=e.length;baris=0;for(var o=0;o<length;){payrolldetail.set(e[o]);payrolldetail.animateTarget=m;payrolldetail.scope=j;payrolldetail.showError=true;payrolldetail.save({callback:function(r,p,q){if(q){baris++;if(length==baris){l.notifyMessage("Data Berhasil Disimpan.");l.loadRecord(g)}}}});o++}}}}})},onCellEdit:function(){var b=this,a=b.getView();a.setSumTotal()}});Ext.define("msdm.pegawai.List",{extend:"com.Grid",alias:"widget.msdm-pegawai-list",controller:"msdm-pegawai-list",viewModel:{stores:{store:{type:"pegawai-store"}}},hideColumns:true,initComponent:function(){var a=this;a.createMenuContext();a.columns=[{xtype:"rownumberer",text:"No",align:"left",width:60},{text:"NIP",dataIndex:"NIP",width:200},{text:"Nama Lengkap",dataIndex:"NAMA",flex:2},{text:"Tempat / Tgl.Lahir",flex:2,renderer:"onRendererTempatLahir"},{text:"Jenis Kelamin",dataIndex:"JENIS_KELAMIN",flex:1,renderer:"onRendererJenisKelamin"},{text:"Alamat",dataIndex:"ALAMAT",flex:2},{text:"Profesi",dataIndex:"PROFESI",flex:1,renderer:"onRendererProfesi"},{xtype:"checkcolumn",header:"STATUS",dataIndex:"STATUS",hidden:!a.hideColumns,width:90,listeners:{checkchange:"onChange"}},{text:"#",width:50,align:"center",xtype:"widgetcolumn",hidden:!a.hideColumns,widget:{xtype:"button",ui:"soft-red",iconCls:"x-fa fa-unlock-alt",padding:4,margin:"2.2.2.2",tooltip:"Create / Edit Pengguna",listeners:{click:"onClickPass"}}}];a.dockedItems=[{xtype:"pagingtoolbar",bind:{store:"{store}"},dock:"bottom",displayInfo:true,items:["-",{},{},{xtype:"search-field",cls:"x-text-border",autoFocus:true,emptyText:"Cari berdasarkan NIP / Nama",flex:1,hidden:!a.hideColumns,listeners:{search:"onsearch",clear:"onClear"}},{xtype:"textfield",hidden:a.hideColumns,cls:"x-text-border",bind:"{filter.FILTERNAMA}",autoFocus:true,emptyText:"Cari Nama Pegawai",flex:1,listeners:{change:"onCari"}}]}];a.callParent(arguments)},listeners:{rowcontextmenu:"onKlikKananMenu",itemdblclick:"onItemDoubleClick"},onLoadRecord:function(){var a=this;a.getViewModel().get("store").load()},createMenuContext:function(){var b=this;b.menucontext=new Ext.menu.Menu({items:[{text:"Detail Pegawai",glyph:"xf05a@FontAwesome",handler:function(){b.getController().onDetilPegawai()}}]});return b.menucontext}});Ext.define("msdm.pegawai.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pegawai-list",onCari:function(b,a){this.onsearch(b,a)},onRendererJenisKelamin:function(a){return a==1?"Laki - laki":"Perempuan"},onRendererTempatLahir:function(k,m,l,o,j,a){var n=Ext.Date.format(l.get("TANGGAL_LAHIR"),"d F Y");tempatlahir=l.get("TEMPAT_LAHIR")+",  "+n;return tempatlahir},onsearch:function(l,g){var j=this,k=j.getViewModel(),a=k.get("store");a.queryParams={QUERY:g,page:1,start:0};a.load()},onClear:function(){var e=this,f=e.getViewModel(),a=f.get("store");delete a.queryParams.QUERY;delete a.queryParams.page;delete a.queryParams.start;a.load()},onChange:function(o,a,l){var m=this,j=m.getView(),n=m.getViewModel(),p=n.get("store"),k=p.getAt(a);k.set("STATUS",l?1:0);k.scope=this;k.save({callback:function(e,f,b){if(b){j.notifyMessage("Status Pegawai di"+(l==true?"Aktifkan":"NonAktifkan "),"danger-blue")}}})},onRendererProfesi:function(p,l,o,a,n,f){var m=o.get("REFERENSI"),q=m?(m.PROFESI?m.PROFESI.DESKRIPSI:""):"";return q},onClickPass:function(a){var j=this,f=a.getWidgetRecord(),e=j.getView();e.openDialog("",true,"55%","50%",{xtype:"pengguna-form",showCloseButton:true,ui:"panel-red",iconCls:"x-fa fa-unlock-alt",title:f.get("NAMA")+" ("+f.get("NIP")+")"},function(b,k){var g=k.down("pengguna-form");g.storeload(f);g.on("getView",function(){k.close()})},a)},onKlikKananMenu:function(e,j,o,k,m){var l=this,n=m.getXY();m.stopEvent();l.getView().menucontext.showAt(n)},onDetilPegawai:function(){var b=this,a=b.getView(),e=a.getSelection()[0];a.fireEvent("detilpegawai",e)},onItemDoubleClick:function(b,f){var e=this,a=e.getView();a.fireEvent("detilpegawai",f)}});Ext.define("msdm.pegawaiabsen.Form",{extend:"com.Form",alias:"widget.msdm-pegawaiabsen-form",model:"msdm.pegawaiabsen.Model",controller:"msdm-pegawaiabsen-form",viewModel:{stores:{jenisabsen:{type:"referensi-store",queryParams:{JENIS:77}}},data:{tanggal:"Pilih Tanggal"}},layout:{type:"vbox",align:"stretch"},bodyPadding:5,items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"fieldset",flex:1,bind:{title:"{tanggal}"},layout:{type:"vbox",align:"stretch"},defaults:{labelAlign:"top"},defaultType:"combobox",items:[{name:"JENIS",fieldLabel:"Jenis Absen",enterFocus:true,typeAhead:true,forceSelection:true,validateOnBlur:true,emptyText:"[Jenis Absen]",queryMode:"local",flex:1,displayField:"DESKRIPSI",valueField:"ID",margin:"0 5 0 5",bind:{store:"{jenisabsen}"}},{xtype:"textfield",fieldLabel:"Keterangan",name:"KETERANGAN",flex:1,margin:"0 5 10 5"}]}]}],buttons:[{xtype:"component",flex:1},{text:"Simpan",ui:"soft-green",iconCls:"x-fa fa-save",handler:"onSimpan"},{text:"Batal",xtype:"button",ui:"soft-red",iconCls:"x-fa fa-times",handler:"onBatal"}],load:function(){var e=this,b=e.getViewModel(),a=b.get("jenisabsen");a.load()}});Ext.define("msdm.pegawaiabsen.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pegawaiabsen-form",onSimpan:function(e){var f=this,a=f.getView(),b=a.getRecord();a.save(e);a.fireEvent("save")}});Ext.define("msdm.pegawaiabsen.Grid",{extend:"com.Grid",alias:"widget.msdm-pegawaiabsen-grid",controller:"msdm-pegawaiabsen-grid",viewModel:{stores:{store:{type:"msdm-pegawaiabsen-store"}},data:{record:undefined}},columns:[{text:"TANGGAL",xtype:"datecolumn",dataIndex:"TANGGAL",format:"d-m-Y",flex:1},{xtype:"templatecolumn",text:"IZIN",dataIndex:"NIP",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.JENIS_ABSEN.DESKRIPSI}</div>',flex:1},{text:"KETERANGAN",flex:2,dataIndex:"KETERANGAN"},{text:"#",xtype:"checkcolumn",dataIndex:"STATUS",flex:1,bind:{hidden:"{record}"},listeners:{checkchange:"onChange"}}]});Ext.define("msdm.pegawaiabsen.GridController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pegawaiabsen-grid",onChange:function(k,l,j){var g=this,f=g.getViewModel(),a=g.getView(),b=f.get("store"),e=b.getAt(l);e.set("STATUS",j?1:0);e.scope=this;e.save({callback:function(m,n,o){if(o){a.notifyMessage("Status di "+(j==true?"Aktifkan":"NonAktifkan"),"danger-red")}else{e.set("STATUS",j?0:1)}}})}});Ext.define("msdm.pegawaiabsen.Workspace",{extend:"com.Form",alias:"widget.msdm-pegawaiabsen-workspace",controller:"msdm-pegawaiabsen-workspace",viewModel:{stores:{store:{type:"msdm-pegawaiabsen-store"}},data:{pegawai:undefined}},layout:{type:"hbox",align:"stretch"},bodyPadding:5,items:[{xtype:"datepicker",reference:"jadwaldinas",handler:"onPilihTanggal"},{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"msdm-pegawaiabsen-form",reference:"pegawaiabsenform",listeners:{simpan:"onSimpan"}},{xtype:"msdm-pegawaiabsen-grid",reference:"pegawaiabsengrid",flex:1}]}],load:function(j){var f=this,e=f.getViewModel(),b=f.down("msdm-pegawaiabsen-form"),a=f.down("msdm-pegawaiabsen-grid"),g=a.getViewModel().get("store");g.queryParams={NIP:j.get("NIP")};e.set("pegawai",j);b.load();g.load()}});Ext.define("msdm.pegawaiabsen.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pegawaiabsen-workspace",onPilihTanggal:function(k,b){var m=this,n=m.getView(),e=n.getViewModel(),f=n.down("msdm-pegawaiabsen-form"),l=f.getViewModel(),a=n.down("msdm-pegawaiabsen-form"),j=e.get("pegawai"),g=Ext.Date.format(b,"Y-m-d"),o=e.get("store");if(j){o.queryParams={NIP:j.get("NIP"),TANGGAL:g};o.load({callback:function(p,q,r){if(r){a.loadRecord(p[0])}else{a.createRecord({NIP:j.get("NIP"),TANGGAL:g,STATUS:1})}}})}l.set("tanggal",Ext.Date.format(b,"l, d-m-Y"))},onSimpan:function(){var e=this,a=e.getView(),b=a.down("msdm-pegawaiabsen-grid"),f=b.getViewModel().get("store");f.reload()}});Ext.define("msdm.pelatihan.Form",{extend:"com.Form",xtype:"msdm-pelatihan-form",controller:"msdm-pelatihan-form",model:"msdm.pelatihan.Model",defaults:{margin:"2.2.2.2",border:false},items:[{layout:"hbox",defaults:{margin:"2.2.2.2",width:"34%"},items:[{xtype:"textfield",allowBlank:false,emptyText:"[ NAMA PELATIHAN ]",name:"DESKRIPSI"},{xtype:"referensi-combo",allowBlank:false,emptyText:"[ JENIS PELATIHAN ]",params:{JENIS:"124"},firstLoad:true,width:"30%",name:"JENIS_PELATIHAN"},{xtype:"textfield",allowBlank:false,emptyText:"[ PENYELENGARA ]",name:"PENYELENGARA"}]},{layout:"hbox",defaults:{margin:"2.2.2.2",width:"49%"},items:[{xtype:"datefield",allowBlank:false,format:"Y-m-d",emptyText:"[ TANGGAL MULAI ]",name:"MULAI"},{xtype:"datefield",allowBlank:false,format:"Y-m-d",emptyText:"[ TANGGAL SELESAI ]",name:"SELESAI"}]},{layout:"hbox",defaults:{margin:"2.2.2.2",width:"49%"},items:[{xtype:"textarea",emptyText:"[ TEMPAT ]",name:"TEMPAT"},{xtype:"textarea",emptyText:"[ KETERANGAN ]",name:"KETERANGAN"}]}],buttons:[{text:"Simpan",ui:"soft-blue",handler:"onSimpan"}]});Ext.define("msdm.pelatihan.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pelatihan-form",onSimpan:function(b){var e=this,a=e.getView();a.save(b,{},function(j,f,g){if(g){a.showMessageBox({title:"Perhatian",message:"Apakah anda ingin menambahkan file ?",ui:"window-warning",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:b,fn:function(k){if(k==="yes"){a.openDialog("",true,300,150,{xtype:"msdm-pelatihan-file-form",ui:"panel-gray",title:"File",showCloseButton:true,iconCls:"x-fa fa-file"},function(l,n){var m=n.down("msdm-pelatihan-file-form");m.loadRecord(j)},b)}}})}})}});Ext.define("msdm.pelatihan.List",{extend:"com.Grid",xtype:"msdm-pelatihan-list",controller:"msdm-pelatihan-list",viewModel:{stores:{store:{type:"msdm-pelatihan-store"},storeFile:{type:"msdm-pelatihan-store"}},data:{listConfig:{paging:true}}},columns:[{text:"Nama Pelatihan",xtype:"templatecolumn",flex:1,tpl:'<div style="white-space:normal !important;color:black">{DESKRIPSI}</div>'},{xtype:"templatecolumn",text:"Jenis",flex:1,dataIndex:"JENIS_PELATIHAN",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.PELATIHAN.DESKRIPSI}</div>'},{text:"Penyelengara",flex:1,dataIndex:"PENYELENGARA"},{xtype:"datecolumn",text:"Tgl. Mulai",flex:1,dataIndex:"MULAI",format:"Y-m-d"},{xtype:"datecolumn",text:"Tgl. Selesai",flex:1,dataIndex:"SELESAI",format:"Y-m-d"},{text:"Tempat",xtype:"templatecolumn",flex:1,tpl:'<div style="white-space:normal !important;color:black">{TEMPAT}</div>'},{text:"Keterangan",xtype:"templatecolumn",flex:1,tpl:'<div style="white-space:normal !important;color:black">{KETERANGAN}</div>'},{xtype:"checkcolumn",text:"Status",dataIndex:"STATUS",width:70,listeners:{checkchange:"onChange"}},{xtype:"widgetcolumn",text:"#",align:"center",width:90,widget:{xtype:"fieldcontainer",defaultType:"button",layout:{type:"vbox",align:"stretch"},defaults:{padding:2,margin:"0 2 1 0"},items:[{text:"File",ui:"soft-black",menu:[{text:"View File",action:1,iconCls:"x-fa fa-print",handler:"onLihatFile"},{text:"Ubah File",action:2,iconCls:"x-fa fa-cog",handler:"onUbahFile"}]}]}}]});Ext.define("msdm.pelatihan.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pelatihan-list",onLihatFile:function(e){var g=this,f=g.getViewModel(),b=f.get("storeFile"),a=g.getView();record=e.ownerCt.ownerCmp.ownerCt.getWidgetRecord();b.setQueryParams({ID:record.get("ID"),SHOW_FILE:1});b.load({callback:function(k,j,l){if(l){rec=k[0];if(rec.get("TYPE")=="application/pdf"){a.printPreview("View File",k[0].get("FILE"))}else{window.open(k[0].get("FILE"))}}}})},onUbahFile:function(b){var f=this,e=f.getViewModel(),a=f.getView();record=b.ownerCt.ownerCmp.ownerCt.getWidgetRecord();a.openDialog("",true,300,150,{xtype:"msdm-pelatihan-file-form",ui:"panel-gray",title:"File",showCloseButton:true,iconCls:"x-fa fa-file"},function(g,k){var j=k.down("msdm-pelatihan-file-form");j.loadRecord(record)},b)},onChange:function(k,j,g){var f=this,e=f.getViewModel(),a=f.getView(),b=e.get("store");model=b.getAt(j);model.set("STATUS",g?1:0);model.save({callback:function(l,m,n){if(n){a.notifyMessage("Status di"+(g==true?"Aktifkan":"NonAktifkan"),"danger-red")}else{model.set("STATUS",g?0:1)}}})}});Ext.define("msdm.pelatihan.Workspace",{extend:"com.Form",xtype:"msdm-pelatihan-workspace",controller:"msdm-pelatihan-workspace",layout:"border",viewModel:{data:{pegawai:undefined}},defaults:{border:false,margin:"1.1.1.1"},items:[{region:"north",title:"Form Pelatihan Pegawai",ui:"panel-blue",collapsible:true,collapsed:true,iconCls:"x-fa fa-edit",xtype:"msdm-pelatihan-form",listeners:{save:"onSave"}},{region:"center",layout:"fit",title:"Daftar Pelatihan Pegawai",ui:"panel-blue",iconCls:"x-fa fa-table",xtype:"msdm-pelatihan-list",flex:1}],load:function(b){var a=this;vm=a.getViewModel(),form=a.down("msdm-pelatihan-form"),list=a.down("msdm-pelatihan-list");if(b){vm.set("pegawai",b);form.createRecord({NIP:b.get("NIP"),STATUS:1});list.load({NIP:b.get("NIP"),STATUS:1})}}});Ext.define("msdm.pelatihan.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pelatihan-workspace",onSave:function(b){var f=this,e=f.getViewModel(),a=f.getView();a.load(e.get("pegawai"))}});Ext.define("msdm.pelatihan.file.Form",{extend:"com.Form",xtype:"msdm-pelatihan-file-form",controller:"msdm-pelatihan-file-form",model:"msdm.pelatihan.Model",defaults:{margin:"2.2.2.2",border:false},items:[{layout:"hbox",defaults:{margin:"2.2.2.2",width:"34%"},items:[{xtype:"filefield",reference:"file",flex:0.2,emptyText:"File",reference:"filerca",buttonConfig:{text:"",iconCls:"x-fa fa-upload",ui:"soft-blue",tooltip:"Import Data"},buttonOnly:false,listeners:{change:"onUpload"}}]}],buttons:[{text:"Simpan",ui:"soft-blue",handler:"onSimpan"}]});Ext.define("msdm.pelatihan.file.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pelatihan-file-form",filedata:undefined,onSimpan:function(b){var e=this,a=e.getView(),f=a.getRecord();if(a.getForm().isValid()){f.set("FILE",e.filedata);a.save(b)}},onUpload:function(f){var k=this,b=k.getView(),g=k.getViewModel(),j=f.fileInputEl.dom.files,e=j[0],a=new FileReader();Ext.Msg.show({title:"Perhatian",message:"Apakah anda yakin memilih file ini?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:f,fn:function(l){if(l==="yes"){a.readAsDataURL(e);a.addEventListener("loadend",function(){k.filedata=Ext.util.Base64.encode(a.result)})}}})}});Ext.define("msdm.pendidikan.Form",{extend:"com.Form",xtype:"msdm-pendidikan-form",controller:"msdm-pendidikan-form",model:"msdm.pendidikan.Model",items:[{layout:"hbox",width:"100%",border:false,defaults:{margin:"2.2.2.2",flex:1},defaultType:"textfield",items:[{xtype:"referensi-combo",params:{JENIS:3,STATUS:1},name:"JENIS_PENDIDIKAN",firstLoad:true,emptyText:"JENIS PENDIDIKAN"},{name:"NAMA_LEMBAGA",flex:1.5,emptyText:"NAMA LEMBAGA PENDIDIKAN"},{name:"ALAMAT",emptyText:"ALAMAT"},{name:"TAHUN_KELULUSAN",flex:0.5,emptyText:"TAHUN KELULUSAN"},{xtype:"filefield",reference:"file",flex:0.2,emptyText:"Dokumentasi",reference:"filerca",buttonConfig:{text:"",iconCls:"x-fa fa-upload",ui:"soft-blue",tooltip:"Import Data"},buttonOnly:true,listeners:{change:"onUpload"}}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:["->",{text:"Tambah",padding:4,xtype:"button",ui:"soft-black",iconCls:"x-fa fa-plus",handler:"onSimpan"}]}]});Ext.define("msdm.pendidikan.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pendidikan-form",filedata:undefined,onSimpan:function(e){var f=this,a=f.getView(),b=a.getForm().getValues(),g=a.getRecord();b.FILE=f.filedata;if(a.getForm().isValid()){g.set(b);a.save(e)}},onUpload:function(f){var k=this,b=k.getView(),g=k.getViewModel(),j=f.fileInputEl.dom.files,e=j[0],a=new FileReader();Ext.Msg.show({title:"Perhatian",message:"Apakah anda yakin memilih file ini?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:f,fn:function(l){if(l==="yes"){a.readAsDataURL(e);a.addEventListener("loadend",function(){k.filedata=Ext.util.Base64.encode(a.result)})}}})}});Ext.define("msdm.pendidikan.List",{extend:"com.Grid",xtype:"msdm-pendidikan-list",controller:"msdm-pendidikan-list",viewModel:{stores:{store:{type:"msdm-pendidikan-store"},storeFile:{type:"msdm-pendidikan-store"}},data:{listConfig:{paging:true}}},columns:[{text:"Jenis Pendidikan",xtype:"templatecolumn",flex:1,dataIndex:"JENIS_PENDIDIKAN",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.PENDIDIKAN.DESKRIPSI}</div>'},{text:"Nama Lembaga Pendidikan",flex:1,dataIndex:"NAMA_LEMBAGA"},{text:"Alamat",flex:1,dataIndex:"ALAMAT"},{xtype:"datecolumn",text:"Tahun Kelulusan",flex:1,dataIndex:"TAHUN_KELULUSAN",format:"Y"},{xtype:"checkcolumn",text:"#",dataIndex:"STATUS",width:50},{menuDisabled:true,sortable:false,align:"center",xtype:"actioncolumn",width:50,items:[{iconCls:"x-fa fa-file",tooltip:"Lihat File",handler:"onLihatFile"}]}]});Ext.define("msdm.pendidikan.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pendidikan-list",onLihatFile:function(n,o,b,l,f,e){var j=this,a=j.getViewModel(),m=a.get("storeFile"),k=j.getView();m.setQueryParams({ID:e.get("ID"),SHOW_FILE:1});m.load({callback:function(p,g,q){if(q){k.printPreview("View File",p[0].get("FILE"))}}})}});Ext.define("msdm.pendidikan.Workspace",{extend:"com.Form",xtype:"msdm-pendidikan-workspace",controller:"msdm-pendidikan-workspace",viewModel:{data:{pegawai:undefined}},layout:"border",defaults:{border:false},items:[{region:"north",layout:"fit",title:"Form Pendidikan Pegawai",ui:"panel-blue",iconCls:"x-fa fa-edit",xtype:"msdm-pendidikan-form",listeners:{save:"onSave"}},{region:"center",layout:"fit",title:"Daftar Pendidikan Pegawai",ui:"panel-blue",iconCls:"x-fa fa-table",xtype:"msdm-pendidikan-list",flex:1}],load:function(g){var e=this,a=e.getViewModel(),b=e.down("msdm-pendidikan-form"),f=e.down("msdm-pendidikan-list");if(g){a.set("pegawai",g);b.createRecord({NIP:g.get("NIP"),STATUS:1});f.load({NIP:g.get("NIP"),STATUS:1})}}});Ext.define("msdm.pendidikan.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-pendidikan-workspace",onSave:function(b){var f=this,a=f.getView(),e=f.getViewModel();a.load(e.get("pegawai"))}});Ext.define("msdm.penempatan.Combo",{extend:"com.Combo",xtype:"msdm-penempatan-combo",viewModel:{stores:{store:{type:"msdm-penempatan-store"}}},emptyText:"[Masukkan Nomor SK]",queryMode:"remote",hideTrigger:true,queryParam:"SK",displayField:"SK",valueField:"ID",minChars:2,tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="x-boundlist-item">','<div style="font-size: 12px;">{SK}</div>',"</div>","</tpl>"),displayTpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"{SK}","</tpl>")});Ext.define("msdm.penempatan.Form",{extend:"com.Form",xtype:"msdm-penempatan-form",model:"msdm.penempatan.Model",controller:"msdm-penempatan-form",viewModel:{stores:{store:{type:"msdm-penempatan-store"},detilPenempatanStore:{type:"msdm-penempatan-detil-store"}},data:{recordDetil:undefined}},layout:{type:"vbox",align:"stretch"},border:true,defaultType:"container",items:[{defaultType:"combobox",flex:1,defaults:{margin:2},layout:{type:"vbox",align:"stretch"},items:[{xtype:"ruangan-combo",emptyText:"[Pilih Direktorat]",params:{JENIS:1},firstLoad:true,name:"DIREKTORAT",reference:"direktorat",fieldLabel:"Direktorat",listeners:{select:"onselect"}},{xtype:"ruangan-combo",emptyText:"[Pilih Bagian]",reference:"bagian",name:"BAGIAN",displayField:"DESKRIPSI",fieldLabel:"Bagian",listeners:{select:"onselectInstalasi"}},{xtype:"ruangan-combo",emptyText:"[Pilih Instalasi]",reference:"instalasi",name:"INSTALASI",fieldLabel:"Instalasi",listeners:{select:"onselectUnit"}},{xtype:"ruangan-combo",fieldLabel:"Unit",emptyText:"[Pilih Unit]",name:"RUANGAN",reference:"unit",listeners:{select:"onselectSubUnit"}},{xtype:"ruangan-combo",emptyText:"[Pilih Sub Unit]",fieldLabel:"Sub Unit",reference:"subunit",name:"SUBUNIT",reference:"subunit"}]},{defaultType:"combobox",flex:1,defaults:{margin:2},layout:{type:"vbox",align:"stretch"},items:[{fieldLabel:"Tanggal Berlaku",name:"TANGGAL_BERLAKU",reference:"tanggalberlaku",format:"Y-m-d",allowBlank:false,xtype:"datefield",emptyText:"[Pilih Tanggal]"},{fieldLabel:"Pegawai",xtype:"pegawai-combo",emptyText:"[Masukkan NIP/Nama]",reference:"namapegawai",name:"NIP",allowBlank:false},{fieldLabel:"Jabatan",reference:"jabatan",xtype:"referensi-combo",displayField:"DESKRIPSI",displayValue:"ID",emptyText:"[Jabatan]",firstLoad:true,params:{JENIS:18,STATUS:1},name:"JABATAN",allowBlank:false},{layout:{type:"hbox",align:"left"},defaults:{margin:2},xtype:"container",width:"100%",items:[{xtype:"component",width:"60%"},{xtype:"button",text:"Add",iconCls:"x-fa fa-plus",ui:"soft-blue",width:"20%",reference:"tomboladdpegawai",listeners:{click:"onClickPegawai"}},{xtype:"button",text:"Reset",iconCls:"x-fa fa-history",ui:"soft-red",width:"20%",listeners:{click:"onClickReset"}}]}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"combobox",bind:{store:"{store}"},emptyText:"[Masukan Nomor SK]",name:"SK",flex:1,reference:"nomorsk",queryMode:"remote",hideTrigger:true,queryParam:"SK",displayField:"SK",valueField:"ID",minChars:2,label:"Nomor SK",listeners:{select:"onSelectSK",focusleave:"onBlurSk"}},{xtype:"button",ui:"soft-black",tooltip:"History",iconCls:"x-fa fa-history",handler:"onHandlerHistory"}]}],setForm:function(f){var l=this,e=l.getViewModel(),n=Ext.util.Format.substr(f.get("RUANGAN"),0,1),b=Ext.util.Format.substr(f.get("RUANGAN"),0,3),j=Ext.util.Format.substr(f.get("RUANGAN"),0,5),m=Ext.util.Format.substr(f.get("RUANGAN"),0,7),a=Ext.util.Format.substr(f.get("RUANGAN"),0,9),o=l.down("[name=NIP]"),k=l.down("[name=DIREKTORAT]"),g=l.down("[name=BAGIAN]");cmbIns=l.down("[name=INSTALASI]");cmbRng=l.down("[name=RUANGAN]");cmbSbn=l.down("[name=SUBUNIT]");l.loaValueForm(k);l.loaValueForm(g,{ID:n,STATUS:1,JENIS:2},b);l.loaValueForm(cmbIns,{ID:b,STATUS:1,JENIS:3},j);l.loaValueForm(cmbRng,{ID:j,STATUS:1,JENIS:4},m);l.loaValueForm(cmbSbn,{ID:m,STATUS:1,JENIS:5},a);o.setReadOnly(true);l.loadRecord(f);l.setDataPegawai(f.get("REFERENSI"));e.set("recordDetil",f)},loaValueForm:function(b,e,f){var a=b.getStore();if(e){b.setSelection(null);if(e.ID!=f){a.setQueryParams(e);a.load({callback:function(k,g,j){if(j){find=a.findRecord("ID",f,0,false,true,true);b.setValue(f)}}})}}else{b.setValue(1)}},setDataPegawai:function(f){var e=this,b=e.down("[reference = namapegawai]"),a=Ext.create("data.model.Pegawai",(f.PEGAWAI)?f.PEGAWAI:null);b.getStore().insert(0,a);b.setValue((f.PEGAWAI)?f.PEGAWAI.NIP:null)},getPenempatan:function(){var a=this,b=a.down("[reference = nomorsk]"),e=b.getSelection()?b.getSelection():false;return e},setAddPegawai:function(a){this.down("[reference=tomboladdpegawai]").setDisabled(a)}});Ext.define("msdm.penempatan.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-penempatan-form",onSelectSK:function(a,e){var b=this;view=b.getView(),ref=b.getReferences();ref.tomboladdpegawai.setDisabled(e.get("STATUS")!=1);view.fireEvent("loadDetil",e)},onBlurSk:function(b,f,a){var e=this.getReferences();c=b.getSelection();if(c===null){e.tomboladdpegawai.setDisabled(false)}},onClickPegawai:function(o){var j=this,l=j.getView(),b=j.getViewModel(),a=l.getForm(),n=a.getValues(),k=j.getReferences(),e=k.nomorsk,f=e.getSelection(),g="",m=b.get("recordDetil");if(n.SUBUNIT){g=n.SUBUNIT}else{if(n.RUANGAN){g=n.RUANGAN}else{if(n.INSTALASI){g=n.INSTALASI}else{if(n.BAGIAN){g=n.BAGIAN}else{if(n.DIREKTORAT){g=n.DIREKTORAT}}}}}modeldetil=Ext.create("msdm.penempatan.detil.Model",{PENEMPATAN:f?f.get("ID"):"",JABATAN:n.JABATAN,NIP:n.NIP,TANGGAL_BERLAKU:n.TANGGAL_BERLAKU,RUANGAN:g});if(a.isValid()){if(m){m.set("RUANGAN",g);m.set("JABATAN",n.JABATAN);m.set("TANGGAL_BERLAKU",n.TANGGAL_BERLAKU);j.saveModel(m,o)}else{if(f){j.saveModel(modeldetil,o)}else{model=Ext.create("msdm.penempatan.Model",{SK:e.rawValue,TANGGAL:Ext.Date.format(l.getSysdate(),"Y-m-d H:i:s")});model.animateTarget=o;model.scope=j;model.showError=true;model.save({callback:function(q,p,r){if(r){e.getStore().insert(0,q);e.setSelection(q);modeldetil.set("PENEMPATAN",q.get("ID"));j.saveModel(modeldetil,o);l.notifyMessage("Data Penempatan Tersimpan")}else{l.notifyMessage("Gagal Menyimpan")}}})}}}},saveModel:function(e,j){var g=this,a=g.getView(),f=g.getViewModel(),b=f.get("detilPenempatanStore");b.setQueryParams({PENEMPATAN:e.get("PENEMPATAN"),NIP:e.get("NIP")});b.load({callback:function(k,l,m){if(m){rec=k[0];if(rec.get("STATUS")!=0){a.notifyMessage("Pegawai bersangkutan telah diimput sebelumnya","danger-red")}else{rec.set("JABATAN",e.get("JABATAN"));rec.set("NIP",e.get("NIP"));rec.set("TANGGAL_BERLAKU",e.get("TANGGAL_BERLAKU"));rec.set("RUANGAN",e.get("RUANGAN"));rec.set("STATUS",1);rec.animateTarget=j;rec.scope=g;rec.showError=true;rec.save({callback:function(o,n,p){if(p){g.getReferences().namapegawai.setValue(null);g.getReferences().jabatan.setValue(null);g.getViewModel().set("recordDetil",undefined);a.notifyMessage("Data Tersimpan");a.fireEvent("save",o)}else{a.notifyMessage("Gagal Menyimpan","danger-red")}}})}}else{e.animateTarget=j;e.scope=g;e.showError=true;e.save({callback:function(o,n,p){if(p){g.getReferences().namapegawai.setValue(null);g.getReferences().jabatan.setValue(null);g.getViewModel().set("recordDetil",undefined);a.notifyMessage("Data Tersimpan");a.fireEvent("save",o)}else{a.notifyMessage("Gagal Menyimpan","danger-red")}}})}}})},onselect:function(a,g){var e=this,b=e.getReferences(),f=b.bagian.getStore();b.bagian.select(null);b.instalasi.select(null);b.unit.select(null);b.subunit.select(null);f.removeAll();b.bagian.getStore().removeAll();b.instalasi.getStore().removeAll();b.unit.getStore().removeAll();b.subunit.getStore().removeAll();f.setQueryParams({JENIS:2,STATUS:1,ID:g.get("ID")});f.load()},onselectInstalasi:function(b,g){var f=this,e=f.getReferences(),a=e.instalasi.getStore();e.instalasi.select(null);e.unit.select(null);e.subunit.select(null);a.removeAll();e.unit.getStore().removeAll();e.subunit.getStore().removeAll();if(g){a.setQueryParams({JENIS:3,STATUS:1,ID:g.get("ID")});a.load()}},onselectUnit:function(a,g){var f=this,e=f.getReferences(),b=e.unit.getStore();e.unit.select(null);e.subunit.select(null);b.removeAll();e.unit.getStore().removeAll();e.subunit.getStore().removeAll();if(g){b.setQueryParams({JENIS:4,STATUS:1,ID:g.get("ID")});b.load()}},onselectSubUnit:function(a,g){var f=this,e=f.getReferences(),b=e.subunit.getStore();e.subunit.select(null);b.removeAll();if(g){b.setQueryParams({JENIS:5,ID:g.get("ID")});b.load()}},onClickReset:function(l){var g=this,a=g.getViewModel(),k=g.getView(),j=g.getReferences(),b=j.nomorsk,f=b.getSelection(),m=k.down("[name=NIP]"),e=k.down("[reference=tomboladdpegawai]");k.getForm().reset();e.setDisabled(false);if(f){b.setSelection(f[0]);e.setDisabled(f.get("STATUS")==2)}a.set("recordDetil",undefined);m.setReadOnly(false);k.fireEvent("reset",true)},onHandlerHistory:function(e){var g=this,b=g.getReferences(),j=b.nomorsk,f=j.getStore(),a=g.getView();a.openDialog("",true,700,500,{xtype:"msdm-penempatan-list",ui:"panel-gray",title:"History SK Penempatan",showCloseButton:true,iconCls:"x-fa fa-history"},function(k,m){var l=m.down("msdm-penempatan-list");l.load({});l.setGridConfig({paging:true});l.on("sendData",function(n){f.insert(0,n);j.setSelection(n);m.close()})},e)}});Ext.define("msdm.penempatan.List",{extend:"com.Grid",xtype:"msdm-penempatan-list",controller:"msdm-penempatan-list",viewModel:{stores:{store:{type:"msdm-penempatan-store"}}},header:{items:[{xtype:"search-field",flex:1,emptyText:"Nomor SK",listeners:{search:"onSearch",clear:"onClear"}}]},columns:[{text:"Nomor SK",flex:1,dataIndex:"SK"},{xtype:"datecolumn",format:"s:i:H d-m-Y",text:"Tanggal",flex:0.5,dataIndex:"TANGGAL"},{text:"Status",align:"center",width:75,xtype:"templatecolumn",dataIndex:"STATUS",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="thumb-wrap-dis">','<div class="thumb">','<div style="color:{[this.getColor(values.STATUS)]};font-size: 18px;"> <il class="{[this.getIconStatus(values.STATUS)]}"></il></div>',"</div>","</div>","</tpl>",{getIconStatus:function(a){if(a==2){return"x-fa fa-check-circle"}else{if(a==1){return"x-fa fa-minus-circle"}else{return"x-fa fa-times-circle"}}},getColor:function(a){if(a==2){return"green"}else{if(a==1){return"blue"}else{return"red"}}}})},{xtype:"widgetcolumn",onWidgetAttach:"onWidgetAttach",text:"Act",widget:{xtype:"fieldcontainer",defaultType:"button",layout:{type:"vbox",align:"stretch"},defaults:{padding:2,margin:"0 2 1 0"},items:[{text:"Detail",handler:"onView",ui:"soft-blue"},{text:"Batal",handler:"onBatal",ui:"soft-red"}]}}]});Ext.define("msdm.penempatan.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-penempatan-list",onWidgetAttach:function(b,e,g){var f=this,a=e.items.items[0];btnbatal=e.items.items[1];btnbatal.setHidden(g.get("STATUS")!=1)},onSearch:function(b,j){var g=this,e=g.getViewModel(),a=e.get("store");a.queryParams={SK:j,page:1,start:0};a.load()},onClear:function(e){var f=this,g=f.getViewModel(),a=g.get("store");delete a.queryParams.SK;delete a.queryParams.page;delete a.queryParams.start;a.load()},onView:function(b){var e=this,f=b.ownerCt.getWidgetRecord(),a=e.getView();a.fireEvent("sendData",f)},onBatal:function(b){var e=this,f=b.ownerCt.getWidgetRecord(),a=e.getView();Ext.Msg.show({title:"Konfirmasi",message:"Apakah Anda ingin membatalkan SK dengan nomor "+f.get("SK")+" ..?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,fn:function(g){if(g=="yes"){f.set("STATUS",0);f.save({callback:function(j,k,l){if(l){a.notifyMessage("SK dengan nomor "+f.get("SK")+" telah dibatalkan","danger-blue");a.reload()}else{a.notifyMessage("terjadi kesalahan dalam  membatalkan SK","danger-red")}}})}}})}});Ext.define("msdm.penempatan.Workspace",{extend:"com.Form",xtype:"msdm-penempatan-workspace",controller:"msdm-penempatan-workspace",layout:"border",border:true,defaults:{margin:"1.1.1.1"},items:[{title:"Form",region:"east",flex:0.6,ui:"panel-cyan",iconCls:"x-fa fa-edit",xtype:"msdm-penempatan-form",reference:"formpenempatan",listeners:{save:"onSave",loadDetil:"onLoadDetil",reset:"onReset"}},{title:"Daftar Pegawai",flex:1,ui:"panel-cyan",iconCls:"x-fa fa-users",xtype:"msdm-penempatan-detil-grid",region:"center",reference:"gridpenempatan",listeners:{select:"onSelect"}}],buttons:[{text:"Final",reference:"btnfinal",iconCls:"x-fa fa-save",ui:"soft-blue",handler:"onFinal"}],load:function(){var b=this,a=b.down("msdm-penempatan-form");grid=b.down("msdm-penempatan-detil-grid");a.createRecord({STATUS:1});grid.getStore().removeAll()}});Ext.define("msdm.penempatan.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-penempatan-workspace",onSave:function(g){var f=this,a=f.getView(),e=f.getReferences(),b=a.down("msdm-penempatan-detil-grid");b.load({PENEMPATAN:g.get("PENEMPATAN"),limit:1000});b.setCheckbox(g.get("STATUS"));e.btnfinal.setDisabled(g.get("STATUS")!=1)},onLoadDetil:function(g){var f=this,a=f.getView(),e=f.getReferences(),b=a.down("msdm-penempatan-detil-grid");b.load({PENEMPATAN:g.get("ID"),STATUS:(g.get("STATUS")==0)?1:g.get("STATUS"),limit:1000});b.setCheckbox(g.get("STATUS"));e.btnfinal.setDisabled(g.get("STATUS")!=1)},onSelect:function(j,g,f){var e=this,a=e.getView(),b=e.getReferences();a.down("msdm-penempatan-form").setForm(g)},onFinal:function(){var j=this,g=j.getReferences(),f=g.formpenempatan,b=f.getPenempatan(),a=j.getView(),e=a.down("msdm-penempatan-detil-grid");Ext.Msg.show({title:"Konfirmasi",message:"Apakah Anda Yakin...?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,fn:function(k){if(k=="yes"){if(b){b.set("STATUS",2);b.save({callback:function(n,m,l){if(l){a.notifyMessage("Apakah anda yakin..?","danger-blue");g.btnfinal.setDisabled(true);e.load({PENEMPATAN:e.getStore().getQueryParams().PENEMPATAN,STATUS:2,limit:1000});e.setCheckbox(2);f.setAddPegawai(true)}}})}}}})},onReset:function(a){var e=this,b=e.getReferences();b.btnfinal.setDisabled(false);e.getView().load();b.gridpenempatan.setCheckbox(1)}});Ext.define("msdm.penempatan.detil.Grid",{extend:"com.Grid",alias:"widget.msdm-penempatan-detil-grid",controller:"msdm-penempatan-detil-grid",viewModel:{stores:{store:{type:"msdm-penempatan-detil-store"}},data:{record:false}},columns:[{xtype:"rownumberer",text:"No",menuDisabled:true,sortable:false,align:"left",width:70},{text:"NIP",dataIndex:"NIP",flex:1},{xtype:"templatecolumn",text:"NAMA",dataIndex:"NIP",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.PEGAWAI.NAMA}</div>',flex:1},{text:"PENEMPATAN SEBELUMNYA",flex:1},{xtype:"templatecolumn",text:"PENEMPATAN SEKARANG",dataIndex:"RUANGAN",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.RUANGAN.DESKRIPSI}</div>',flex:1},{xtype:"templatecolumn",text:"JABATAN",dataIndex:"JABATAN",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.JABATAN.DESKRIPSI}</div>',flex:1},{text:"TANGGAL_BERLAKU",xtype:"datecolumn",dataIndex:"TANGGAL_BERLAKU",format:"Y-m-d",flex:0.7},{text:"STATUS",align:"center",width:75,bind:{hidden:"{!record}"},xtype:"templatecolumn",dataIndex:"STATUS",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="thumb-wrap-dis">','<div class="thumb">','<div style="color:{[this.getColor(values.STATUS)]};font-size: 18px;"> <il class="{[this.getIconStatus(values.STATUS)]}"></il></div>',"</div>","</div>","</tpl>",{getIconStatus:function(a){if(a==2){return"x-fa fa-check-circle"}else{if(a==1){return"x-fa fa-minus-circle"}else{return"x-fa fa-times-circle"}}},getColor:function(a){if(a==2){return"green"}else{if(a==1){return"blue"}else{return"red"}}}})},{xtype:"actioncolumn",align:"center",bind:{hidden:"{record}"},width:50,items:[{xtype:"tool",iconCls:"x-fa fa-trash x-color-red",tooltip:"Hapus",handler:"onClickHapus"}]}],setCheckbox:function(a){this.getViewModel().set("record",a!=1)}});Ext.define("msdm.penempatan.detil.GridController",{extend:"Ext.app.ViewController",alias:"controller.msdm-penempatan-detil-grid",onChange:function(k,j,g){var f=this,e=f.getViewModel(),a=f.getView(),b=e.get("store");model=b.getAt(j);if(e.get("record").get("STATUS")!=2){model.set("STATUS",g?1:0);model.save({callback:function(l,m,n){if(n){a.notifyMessage("Status di"+(g==true?"Aktifkan":"NonAktifkan"),"danger-red")}else{model.set("STATUS",g?0:1)}}})}},onClickHapus:function(k,j,b){var f=this,a=f.getView(),e=f.getViewModel(),g=k.getStore().getAt(j);a.showMessageBox({title:"Hapus",message:"Anda yakin ingin menghapus ?",ui:"window-red",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,animateTarget:k,fn:function(l){if(l==="yes"){g.set("STATUS",0);g.save({callback:function(m,n,o){if(o){a.reload();a.notifyMessage("Penempatan Pegawai di hapus","danger-red")}}})}}})}});Ext.define("msdm.penempatan.sekarang.Grid",{extend:"com.Grid",alias:"widget.msdm-penempatan-sekarang-grid",viewModel:{stores:{store:{type:"msdm-penempatan-sekarang-store"}},data:{record:undefined}},columns:[{text:"NIP",dataIndex:"NIP",flex:1},{xtype:"templatecolumn",text:"NAMA",dataIndex:"NIP",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.PEGAWAI.NAMA}</div>',flex:2},{xtype:"templatecolumn",text:"PENEMPATAN SEKARANG",dataIndex:"RUANGAN",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.RUANGAN.DESKRIPSI}</div>',flex:2},{xtype:"templatecolumn",text:"JABATAN",dataIndex:"JABATAN",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.JABATAN.DESKRIPSI}</div>',flex:1}]});Ext.define("msdm.penempatanmutasi.Form",{extend:"com.Form",xtype:"msdm-penempatanmutasi-form",controller:"penempatan-mutasi-form",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:"Nama Pegawai"},{xtype:"bottom",iconCls:"x-fa fa-save",ui:"soft-blue"}]},{html:"list",flex:1},{xtype:"container",defaultType:"combobox",defaults:{flex:1,margin:4},layout:{type:"vbox",align:"stretch"},items:[{xtype:"ruangan-combo",emptyText:"[Pilih Direktorat]",params:{JENIS:1,STATUS:1},firstLoad:true,reference:"direktorat",fieldLabel:"Direktorat",listeners:{select:"onselect"}},{xtype:"ruangan-combo",emptyText:"[Pilih Bagian]",reference:"bagian",fieldLabel:"Bagian",listeners:{select:"onselectInstalasi"}},{xtype:"ruangan-combo",emptyText:"[Pilih Instalasi]",reference:"instalasi",fieldLabel:"Instalasi",listeners:{select:"onselectUnit"}},{xtype:"container",defaultType:"combobox",defaults:{flex:1,labelAlign:"top",margin:4},layout:{type:"hbox",align:"stretch"},items:[{xtype:"ruangan-combo",fieldLabel:"Unit",emptyText:"[Pilih Unit]",reference:"unit",listeners:{select:"onselectSubUnit"}},{fieldLabel:"Jabatan"}]},{xtype:"ruangan-combo",emptyText:"[Pilih Sub Unit]",fieldLabel:"Sub Unit",reference:"subunit"}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:["->",{name:"TANGGAL",fieldLabel:"Tanggal Berlaku",xtype:"datefield",emptyText:"[Pilih Tanggal]"},{text:"Simpan",iconCls:"x-fa fa-save",ui:"soft-blue"}]}]});Ext.define("msdm.penempatanmutasi.FormController",{extend:"Ext.app.ViewController",alias:"controller.penempatan-mutasi-form",onselect:function(a,g){var e=this,b=e.getReferences(),f=b.bagian.getStore();b.bagian.select(null);f.removeAll();f.setQueryParams({JENIS:2,STATUS:1,ID:g.get("ID")});f.load()},onselectInstalasi:function(b,g){var f=this,e=f.getReferences(),a=e.instalasi.getStore();e.instalasi.select(null);a.removeAll();a.setQueryParams({JENIS:3,STATUS:1,ID:g.get("ID")});a.load()},onselectUnit:function(a,g){var f=this,e=f.getReferences(),b=e.unit.getStore();e.unit.select(null);b.removeAll();b.setQueryParams({JENIS:4,STATUS:1,ID:g.get("ID")});b.load()},onselectSubUnit:function(a,g){var f=this,e=f.getReferences(),b=e.subunit.getStore();e.subunit.select(null);b.removeAll();b.setQueryParams({JENIS:5,STATUS:1,ID:g.get("ID")});b.load()}});Ext.define("msdm.penempatanmutasi.Grid",{extend:"Ext.grid.Panel",alias:"widget.penempatan-mutasi-pegawai",columns:[{text:"NIP",flex:2},{text:"PENEMPATAN",flex:3},{text:"RUANGAN",flex:3},{text:"JABATAN",flex:3},{text:"TANGGAL_BERLAKU",flex:1},{text:"#",flex:1}],bbar:{xtype:"pagingtoolbar",displayInfo:true,displayMsg:"Displaying topics {0} - {1} of {2}",emptyMsg:"No topics to display",items:["-",{bind:'{expanded ? "Hide Preview" : "Show Preview"}',pressed:"{expanded}",enableToggle:true,toggleHandler:"onToggleExpanded"}]},dockedItems:[{xtype:"toolbar",dock:"bottom",items:["->",{text:"Simpan",iconCls:"x-fa fa-save",ui:"soft-blue"}]}]});Ext.define("msdm.penempatanmutasi.Workspace",{extend:"com.Form",xtype:"msdm-penempatanmutasi-workspace",layout:{type:"hbox",align:"stretch"},items:[{xtype:"msdm-penempatanmutasi-form",flex:1},{xtype:"penempatan-mutasi-pegawai",flex:2}]});Ext.define("msdm.penempatanmutasi.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.penempatan-mutasi-workspace",onSuccess:function(f,k,e){var j=this,b=j.getView(),g=j.getViewModel(),a=g.get("pgwi");b.load(a)}});Ext.define("msdm.rekening.Grid",{extend:"com.Grid",xtype:"msdm-rekening-grid",controller:"msdm-rekening-grid",viewModel:{stores:{store:{type:"msdm-rekening-store"}}},showAddButton:false,initComponent:function(){var a=this;a.cellEditing=new Ext.grid.plugin.CellEditing({clicksToEdit:1,listeners:{beforeedit:"onBeforeEdit",afteredit:"onAfterEdit"}});a.comboBank=Ext.create("master.referensi.Combo",{params:{JENIS:16,STATUS:1},firstLoad:true,name:"BANK",listeners:{select:"onSelectCmbBank"}});if(a.showAddButton){a.plugins=[a.cellEditing];a.dockedItems=[{xtype:"toolbar",dock:"bottom",items:["->",{xtype:"button",text:"Tambah",ui:"soft-blue",iconCls:"x-fa fa-plus",reference:"btnAdd",handler:"onBtnAdd"},{xtype:"button",text:"Simpan",ui:"soft-green",hidden:true,iconCls:"x-fa fa-save",reference:"btnSave",handler:"onBtnSave"},{xtype:"button",text:"Refresh",ui:"soft-black",hidden:true,iconCls:"x-fa fa-refresh",reference:"btnRefresh",handler:"onBtnRefresh"}]}]}a.columns=[{dataIndex:"NOMOR_REKENING",flex:1,text:"Nomor Rekening",editor:{xtype:"textfield",maxLength:60,name:"NOMOR_REKENING"}},{xtype:"templatecolumn",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.BANK.DESKRIPSI}</div>',dataIndex:"BANK",flex:0.5,text:"Bank",editor:a.comboBank}];a.callParent(arguments)}});Ext.define("msdm.rekening.GridControlle",{extend:"Ext.app.ViewController",alias:"controller.msdm-rekening-grid",recCmbBank:undefined,privates:{setButtons:function(e){var g=this,b=g.getReferences(),j=b.btnAdd,f=b.btnRefresh,a=b.btnSave;j.setHidden(e);a.setHidden(!e);f.setHidden(!e)}},onBeforeEdit:function(e,a){var f=this,b=f.getViewModel(),g=a.record;if(Ext.isNumeric(g.get("ID"))&&g.get("ID")>0){a.cancel=true}},onAfterEdit:function(e,a){var f=this,b=f.getViewModel(),g=a.record;if(f.recCmbBank){g.set("REFERENSI",{BANK:f.recCmbBank.getData()})}},onBtnAdd:function(m){var j=this,k=j.getView(),b=j.getViewModel(),l=b.get("store"),e=l.getQueryParams(),g=k.comboBank,f=g.getStore(),a=f.getData().items[0];l.insert(0,Ext.create("msdm.rekening.Model",{NIP:e.NIP,BANK:a.get("ID"),STATUS:1,REFERENSI:{BANK:a.getData()}}));j.setButtons(true)},onBtnSave:function(e){var g=this,a=g.getView(),f=g.getViewModel(),b=f.get("store"),j=b.getModifiedRecords();a.setLoading(true);Ext.Array.each(j,function(l,k){l.scope=this;l.animateTarget=e;l.save({callback:function(n,m,o){a.setLoading(false);if(o){g.setButtons(false);a.reload()}}})})},onBtnRefresh:function(a){var b=this;b.getView().reload();b.setButtons(false)},onSelectCmbBank:function(a,e){var b=this;b.recCmbBank=e}});Ext.define("msdm.rekening.Workspace",{extend:"com.Form",xtype:"msdm-rekening-workspace",layout:"border",bodyPadding:0,items:[{region:"center",showAddButton:true,xtype:"msdm-rekening-grid",flex:1}],load:function(a){var e=this,b=e.down("msdm-rekening-grid");b.load({NIP:a.get("NIP")})}});Ext.define("msdm.schedule.Combo",{extend:"com.Combo",alias:"widget.msdm-schedule-combo",viewModel:{stores:{store:{type:"msdm-schedule-store"}}},emptyText:"[Pilih Schedule]",displayField:"DESK"});Ext.define("msdm.schedule.Form",{extend:"com.Form",xtype:"msdm-schedule-form",controller:"msdm-schedule-form",model:"msdm.schedule.Model",layout:"vbox",defaults:{margin:"2.2.2.2",width:"100%"},items:[{xtype:"textfield",emptyText:"[DESKRIPSI]",name:"DESK"},{xtype:"textarea",emptyText:"[KETERANGAN]",name:"KET"}],buttons:[{xtype:"checkbox",inputValue:1,uncheckedValue:0,boxLabel:"Status Shift",name:"STATUS_SHIFT"},"->",{ui:"soft-blue",reference:"btnsave",iconCls:"x-fa fa-save",text:"Simpan",handler:"onSimpan"}]});Ext.define("msdm.schedule.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-schedule-form",onSimpan:function(b){var e=this,a=e.getView();a.save(b)}});Ext.define("msdm.schedule.List",{extend:"com.Grid",xtype:"msdm-schedule-list",controller:"msdm-schedule-list",viewModel:{stores:{store:{type:"msdm-schedule-store"}}},columns:[{text:"Deskripsi",flex:1,dataIndex:"DESK"},{text:"Keterangan",flex:1,dataIndex:"KET"},{text:"Status Shift",xtype:"templatecolumn",dataIndex:"STATUS_SHIFT",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="thumb-wrap-dis">','<div class="thumb">','<div style="font-size: 12px;">{[this.getIconStatus(values.STATUS_SHIFT)]}</div>',"</div>","</div>","</tpl>",{getIconStatus:function(a){if(a==1){return"Shift"}else{return"Non Shift"}}})},{xtype:"checkcolumn",text:"Status",dataIndex:"STATUS",width:100,listeners:{checkchange:"onChange"}},{xtype:"widgetcolumn",text:"Act",widget:{xtype:"fieldcontainer",defaultType:"button",layout:{type:"vbox",align:"stretch"},defaults:{padding:2,margin:"0 2 1 0"},items:[{text:"Shift",handler:"onFormShift",ui:"soft-blue"}]}}]});Ext.define("msdm.schedule.ListController",{extend:"Ext.app.ViewController",alias:"controller.msdm-schedule-list",onFormShift:function(a){var e=this,f=a.ownerCt.getWidgetRecord(),b=(f.get("STATUS_SHIFT")==1)?"msdm-schedule-shift-workspace":"msdm-schedule-detail-workspace";view=e.getView();view.openDialog("",true,800,"60%",{title:"Detail Schedule ( "+f.get("DESK")+" )",xtype:b,ui:"panel-cyan",scrollable:true,showCloseButton:true},function(k,j){var g=j.down(b);g.load(f)},a,true,false)}});Ext.define("msdm.schedule.Workspace",{extend:"com.Form",xtype:"msdm-schedule-workspace",controller:"msdm-schedule-workspace",layout:"border",initComponent:function(){var a=this;a.items=[{title:"Schedule",ui:"panel-gray",header:{items:[{xtype:"button",margin:2,height:33,cls:"x-fa fa-plus hide-icon-tools",tooltip:"Tambah Schedule",listeners:{scope:a.getController(),click:"onAddSchedule"}}]},xtype:"msdm-schedule-list",region:"center"}];a.callParent(arguments)},load:function(){var a=this,b=a.down("msdm-schedule-list");b.load({});b.setGridConfig({paging:true})}});Ext.define("msdm.schedule.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-schedule-workspace",onAddSchedule:function(b){var e=this,a=e.getView();a.openDialog("",true,400,240,{title:"Form Shedule",xtype:"msdm-schedule-form",ui:"panel-cyan",scrollable:true,showCloseButton:true},function(j,g){var f=g.down("msdm-schedule-form");f.createRecord({STATUS_SHIFT:1,STATUS:1});g.on("close",function(){a.down("msdm-schedule-list").reload()})},b,true,false)}});Ext.define("msdm.schedule.detail.Form",{extend:"com.Form",xtype:"msdm-schedule-detail-form",model:"msdm.schedule.detail.Model",controller:"msdm-schedule-detail-form",viewModel:{stores:{shiftStore:{type:"msdm-schedule-shift-store"},detailStore:{type:"msdm-schedule-shift-detail-store"}},data:{schedule:undefined}},items:[{layout:"hbox",border:false,defaults:{margin:"2.2.2.2"},items:[{xtype:"combo",border:false,flex:1,name:"SHIFT",bind:{store:"{shiftStore}"},displayField:"REFERENSI",valueField:"ID",allowBlank:false,tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="x-boundlist-item">',"{JENIS_JADWAL.DESKRIPSI} - {KET}","</div>","</tpl>"),displayTpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"{JENIS_JADWAL.DESKRIPSI} - {KET}","</tpl>"),emptyText:"[ SHIFT ]"},{xtype:"button",margin:2,height:33,cls:"x-fa fa-plus hide-icon-tools",tooltip:"Tambah Shift",listeners:{click:"onFormShift"}}]},{xtype:"msdm-schedule-shift-detail-list",region:"east",flex:1,layout:"fit",ui:"panel-blue",title:"Detail Shift"}],buttons:[{ui:"soft-blue",reference:"btnsave",iconCls:"x-fa fa-save",text:"Simpan",handler:"onSimpan"}],load:function(g,f){var e=this,b=e.getViewModel(),a=b.get("shiftStore");b.set("schedule",f);e.loadRecord(g);e.loadDetil(g);a.setQueryParams({SCHEDULE:g.get("SCHEDULE")});a.load()},loadDetil:function(f){var e=this,b=e.getViewModel(),a=e.down("msdm-schedule-shift-detail-list");if(f.get("SHIFT")){a.load({STATUS:1,ID_SHIFT:f.get("SHIFT")})}}});Ext.define("msdm.schedule.detail.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-schedule-detail-form",onFormShift:function(b){var g=this,f="msdm-schedule-shift-workspace",a=g.getView(),e=g.getViewModel(),j=a.getRecord();a.openDialog("",true,800,"60%",{title:"Add Shift",xtype:f,ui:"panel-cyan",scrollable:true,showCloseButton:true},function(m,l){var k=l.down(f);k.load(e.get("schedule"))},b,true,false)},onSimpan:function(b){var e=this,a=e.getView();if(a.getForm().isValid()){a.save(b)}}});Ext.define("msdm.schedule.detail.List",{extend:"com.Grid",xtype:"msdm-schedule-detail-list",viewModel:{stores:{store:{type:"msdm-schedule-detail-store"}}},columns:[{xtype:"templatecolumn",text:"HARI",flex:1,dataIndex:"DAY",tpl:new Ext.XTemplate('<div style="font-size: 12px; white-space:normal !important;">{[this.getDeskHari(values.DAY)]}</div>',{getDeskHari:function(a){if(a==1){return"Minggu"}else{if(a==2){return"Senin"}else{if(a==3){return"Selasa"}else{if(a==4){return"Rabu"}else{if(a==5){return"Kamis"}else{if(a==6){return"Jum'at"}else{if(a==7){return"Sabtu"}else{return""}}}}}}}}})}],doAfterLoad:function(b,e,f,a){if(Ext.isArray(e)){if(e.length>0){b.setSelection(e[0])}else{if(e.length==0){b.createNewNonShift()}}(new Ext.util.DelayedTask(function(){})).delay(100)}},createNewNonShift:function(){var e=this,a=e.getStore(),f=a.getQueryParams();e.setLoading(true);for(var b=1;b<8;b++){model=Ext.create("msdm.schedule.detail.Model",{SCHEDULE:f.SCHEDULE,SHIFT:0,DAY:b,STATUS:1});a.insert(a.getCount(),model)}a.sync({callback:function(l,k,j){e.setLoading(false);e.notifyMessage("Data Tersimpan");e.reload()}})}});Ext.define("msdm.schedule.detail.Workspace",{extend:"com.Form",xtype:"msdm-schedule-detail-workspace",controller:"msdm-schedule-detail-workspace",viewModel:{data:{schedule:undefined}},layout:"border",defaults:{margin:"2.2.2.2",flex:1},initComponent:function(){var a=this;a.items=[{xtype:"msdm-schedule-detail-list",region:"west",ui:"panel-blue",title:"Jadwal Hari",listeners:{select:"onSelectHari"}},{xtype:"msdm-schedule-detail-form",region:"center",ui:"panel-blue",title:"Shift",listeners:{save:"onSave"}}];a.callParent(arguments)},load:function(f){var b=this,a=b.getViewModel(),e=b.down("msdm-schedule-detail-list");a.set("schedule",f);e.load({SCHEDULE:f.get("ID")})}});Ext.define("msdm.schedule.detail.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-schedule-detail-workspace",onSelectHari:function(b,j){var g=this,e=g.getViewModel(),a=g.getView(),f=a.down("msdm-schedule-detail-form");f.load(j,e.get("schedule"))},onSave:function(b){var f=this,e=f.getViewModel(),a=f.getView();a.load(e.get("schedule"))}});Ext.define("msdm.schedule.shift.Form",{extend:"com.Form",xtype:"msdm-schedule-shift-form",controller:"msdm-schedule-shift-form",layout:"hbox",defaults:{margin:"2 2 2 2"},model:"msdm.schedule.shift.Model",items:[{xtype:"referensi-combo",params:{JENIS:82,STATUS:1},width:"50%",allowBlank:false,emptyText:"[ JENIS SHIFT ]",firstLoad:true,reference:"referensi",name:"JENIS_JADWAL"},{xtype:"textfield",width:"50%",allowBlank:false,emptyText:"[ KETERANGAN ]",name:"KET"}],buttons:[{text:"Simpan",handler:"onSimpan"}],load:function(a){}});Ext.define("msdm.schedule.shift.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-schedule-shift-form",onSimpan:function(b){var e=this,a=e.getView();if(a.getForm().isValid()){a.fireEvent("onAddSendShift",b)}}});Ext.define("msdm.schedule.shift.List",{extend:"com.Grid",xtype:"msdm-schedule-shift-list",viewModel:{stores:{store:{type:"msdm-schedule-shift-store"}}},columns:[{xtype:"templatecolumn",text:"Referensi",flex:1,dataIndex:"JENIS_JADWAL",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.JENIS_JADWAL.DESKRIPSI}</div>'},{text:"Keterangan",flex:1,dataIndex:"KET"}],doAfterLoad:function(b,e,f,a){if(Ext.isArray(e)){if(e.length>0){b.setSelection(e[0])}(new Ext.util.DelayedTask(function(){})).delay(100)}}});Ext.define("msdm.schedule.shift.Wokrspace",{extend:"com.Form",xtype:"msdm-schedule-shift-workspace",controller:"msdm-schedule-shift-workspace",viewModel:{data:{schedule:undefined}},layout:"border",defaults:{margin:"2.2.2.2",flex:1},initComponent:function(){var a=this;a.items=[{xtype:"msdm-schedule-shift-list",region:"center",ui:"panel-blue",header:{items:[{xtype:"button",margin:2,height:33,cls:"x-fa fa-plus hide-icon-tools",tooltip:"Tambah Shift",listeners:{scope:a.getController(),click:"onAddShift"}}]},title:"Shift",listeners:{select:"onSelectShift"}},{xtype:"msdm-schedule-shift-detail-list",region:"east",ui:"panel-blue",header:{items:[{xtype:"button",margin:2,height:33,cls:"x-fa fa-plus hide-icon-tools",tooltip:"Tambah Detail",listeners:{scope:a.getController(),click:"onAddShiftDetail"}}]},title:"Detail Shift"}];a.callParent(arguments)},load:function(f){var b=this,a=b.getViewModel(),e=b.down("msdm-schedule-shift-list");a.set("schedule",f);e.load({SCHEDULE:f.get("ID")})}});Ext.define("msdm.schedule.shift.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-schedule-shift-workspace",onSelectShift:function(b,g){var e=this,a=e.getView(),f=a.down("msdm-schedule-shift-detail-list");f.load({ID_SHIFT:g.get("ID")})},onAddShift:function(e){var g=this,b=g.getView(),f=g.getViewModel(),a=b.down("msdm-schedule-shift-list"),j=f.get("schedule"),k=a.getStore(),b=g.getView();b.openDialog("",true,500,150,{title:"Form Shift - "+j.get("DESK"),xtype:"msdm-schedule-shift-form",ui:"panel-cyan",scrollable:true,showCloseButton:true},function(n,m){var l=m.down("msdm-schedule-shift-form");l.createRecord({SCHEDULE:j.get("ID"),STATUS:1,TANGGAL:Ext.Date.format(b.getSysdate(),"Y-m-d H:i:s")});l.on("onAddSendShift",function(o){var p=this,q=p.getRecord();find=k.findRecord("REFERENSI",q.get("REFERENSI"),0,false,true,true);if(find){b.notifyMessage("Shift sudah diimputkan sebelumnya","danger-red")}else{p.save(o);m.close();a.reload()}})},e,true,false)},onAddShiftDetail:function(e){var j=this,b=j.getView(),g=j.getViewModel(),a=b.down("msdm-schedule-shift-list"),l=b.down("msdm-schedule-shift-detail-list"),k=g.get("schedule"),f=a.getSelection(),b=j.getView();b.openDialog("",true,400,150,{title:"Form Waktu",xtype:"msdm-schedule-shift-detail-form",ui:"panel-cyan",scrollable:true,showCloseButton:true},function(o,n){var m=n.down("msdm-schedule-shift-detail-form");m.createRecord({ID_SHIFT:f[0].get("ID"),STATUS:1,TANGGAL:Ext.Date.format(b.getSysdate(),"Y-m-d H:i:s")});m.on("onAddJam",function(p){var q=this,r=q.getRecord();q.save(p);n.close();l.reload()})},e,true,false)}});Ext.define("msdm.schedule.shift.detail.Form",{extend:"com.Form",xtype:"msdm-schedule-shift-detail-form",controller:"msdm-schedule-shift-detail-form",model:"msdm.schedule.shift.detail.Model",layout:"hbox",defaults:{margin:"2.2.2.2"},items:[{xtype:"timefield",format:"H:i:s",allowBlank:false,name:"JAM_MASUK",emptyText:"[JAM MASUK]"},{xtype:"timefield",format:"H:i:s",allowBlank:false,name:"JAM_PULANG",emptyText:"[JAM PULANG]"}],buttons:[{xtype:"datefield",format:"Y-m-d H:i:s",allowBlank:false,name:"TGL_BERLAKU",emptyText:"[TANGGAL BERLAKU]"},"->",{text:"Simpan",ui:"soft-red",handler:"onSimpan"}],load:function(a){}});Ext.define("msdm.schedule.shift.detail.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-schedule-shift-detail-form",onSimpan:function(b){var e=this,a=e.getView();if(a.getForm().isValid()){a.fireEvent("onAddJam",b)}}});Ext.define("msdm.schedule.shift.detail.List",{extend:"com.Grid",xtype:"msdm-schedule-shift-detail-list",viewModel:{stores:{store:{type:"msdm-schedule-shift-detail-store"}}},columns:[{text:"Jam Masuk",flex:1,dataIndex:"JAM_MASUK"},{text:"Jam Pulang",flex:1,dataIndex:"JAM_PULANG"},{xtype:"datecolumn",format:"Y-m-d H:i:s",text:"Tgl.Berlaku",flex:1,dataIndex:"TGL_BERLAKU"}]});Ext.define("msdm.statuspegawai.Form",{extend:"com.Form",alias:"widget.msdm-statuspegawai-form",controller:"msdm-statuspegawai-form",model:"msdm.statuspegawai.Model",bodyPadding:4,viewModel:{data:{temp:undefined}},header:false,border:false,defaults:{margin:"0 1 0 1"},initComponent:function(){var a=this;this.items=[{xtype:"fieldcontainer",flex:1,layout:{type:"vbox",align:"stretch"},defaults:{labelAlign:"top"},bodyPadding:5,items:[{xtype:"referensi-combo",emptyText:"Status Kepegawaian",fieldLabel:"Status Kepagawaian",params:{JENIS:88,STATUS:1},name:"STATUS_PEGAWAI",firstLoad:true},{name:"TMT",xtype:"datefield",fieldLabel:"TMT Pengangkatan",format:"d-m-Y",submitFormat:"Y-m-d",allowBlank:false,emptyText:"[TMT Pengangkatan]"},{xtype:"textfield",name:"SK_PENGANGKATAN",enterFocus:true,margin:"2 2 3 1",enforceMaxLength:true,fieldLabel:"Nomor SK",allowBlank:false,emptyText:"[Nomor SK]",listeners:{specialkey:"onFocusEnter"}},{name:"TANGGAL_SK",xtype:"datefield",fieldLabel:"Tanggal SK",format:"d-m-Y",submitFormat:"Y-m-d",allowBlank:false,emptyText:"[Tanggal SK]"}]}];this.buttons=[{text:"Simpan",ui:"soft-green",iconCls:"x-fa fa-save",handler:"onSimpan"}];this.callParent(arguments)},setDataTemp:function(a){this.getViewModel().set("temp",a)}});Ext.define("msdm.statuspegawai.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-statuspegawai-form",onSimpan:function(e){var g=this,a=g.getView(),f=g.getViewModel(),b=f.get("temp"),j=a.getRecord();if(a.getForm().isValid()){a.save(e)}},onClickHistory:function(){var b=this,a=b.getView(),e=a.getRecord();a.openDialog("",true,800,550,{xtype:"msdm-statuspegawai-list",ui:"panel-gray",title:"History",showCloseButton:true,iconCls:"x-fa fa-history"},function(f,j){var g=j.down("msdm-statuspegawai-list");g.load({STATUS:0,NIP:e.get("NIP")})})}});Ext.define("msdm.statuspegawai.List",{extend:"com.Grid",xtype:"msdm-statuspegawai-list",viewModel:{stores:{store:{type:"msdm-statuspegawai-store"}},data:{listConfig:{paging:true}}},columns:[{text:"Status Kepegawaian",flex:1,dataIndex:"STATUS_PEGAWAI",xtype:"templatecolumn",tpl:'<div style="white-space:normal !important;">{REFERENSI.STATUS_PEGAWAI.DESKRIPSI}</div>'},{text:"TMT Pengangkatan",flex:1,dataIndex:"TMT",xtype:"datecolumn",format:"d-m-Y"},{text:"Nomor SK",flex:1,dataIndex:"SK_PENGANGKATAN"},{text:"Tanggal SK",flex:1,dataIndex:"TANGGAL_SK",xtype:"datecolumn",format:"d-m-Y"}]});Ext.define("msdm.statuspegawai.Workspace",{extend:"com.Form",xtype:"msdm-statuspegawai-workspace",viewModel:{stores:{store:{type:"msdm-statuspegawai-store"}},data:{pgwi:undefined}},layout:"border",items:[{xtype:"msdm-statuspegawai-form",region:"center",layout:"fit",reference:"formstatupegawai",listeners:{save:"onSave"}}],load:function(g){var f=this,b=f.getViewModel(),e=f.down("msdm-statuspegawai-form"),a=f.getViewModel().get("store");params={NIP:g.get("NIP"),STATUS:1};a.setQueryParams(params);a.load(function(k,j,n){if(n){if(k.length>0){var l=k[0];var m=l.getData();e.loadRecord(k[0])}}else{e.createRecord({STATUS:1,NIP:g.get("NIP")})}})}});Ext.define("msdm.strsip.Form",{extend:"com.Form",alias:"widget.form-strsip-pegawai",controller:"form-strsip-pegawai",viewModel:{stores:{jenis:Ext.create("Ext.data.Store",{fields:["id","value"],data:[{id:"1",value:"STR"},{id:"2",value:"SIP"}]})}},layout:{type:"vbox",align:"stretch"},bodyPadding:4,header:false,border:false,defaults:{margin:"0 1 0 1"},initComponent:function(){var a=this;this.items=[{xtype:"fieldcontainer",flex:1,layout:{type:"hbox",align:"stretch"},defaults:{margin:"0 1 0 1"},bodyPadding:5,items:[{xtype:"combobox",bind:{store:"{jenis}"},margin:"2 2 3 1",flex:1,queryMode:"local",displayField:"value",valueField:"id",emptyText:"[Pilih Jenis]",enterFocus:true,enforceMaxLength:true,typeAhead:true,allowBlank:false,name:"JENIS",reference:"refJenisStrSip",listeners:{specialkey:"onFocusEnter"}},{xtype:"textfield",name:"NOMOR",enterFocus:true,margin:"2 2 3 1",enforceMaxLength:true,flex:1,allowBlank:false,emptyText:"[Nomor]",listeners:{specialkey:"onFocusEnter"}}]},{xtype:"fieldcontainer",flex:1,layout:{type:"hbox",align:"stretch"},defaults:{margin:"0 1 0 1"},bodyPadding:5,items:[{name:"TANGGAL_BERLAKU",xtype:"datefield",flex:1,format:"Y-m-d",allowBlank:false,emptyText:"[Tanggal Berlaku]"},{name:"BERLAKU_SAMPAI",xtype:"datefield",flex:1,format:"Y-m-d",allowBlank:false,emptyText:"[Berlaku Sampai]"},{xtype:"filefield",emptyText:"[Scan File]",allowBlank:true,buttonText:"",buttonConfig:{iconCls:"x-fa fa-upload"},margin:"2 2 3 1",flex:1,listeners:{change:"onUpload"}}]}];this.buttons=[{text:"Simpan",ui:"soft-green",iconCls:"x-fa fa-save",handler:"onSimpan"},{text:"Reset",xtype:"button",ui:"soft-red",iconCls:"x-fa fa-refresh",handler:"onBatal"}];this.callParent(arguments)},loadData:function(a){var f=this,e=f.loadRecord(a);return e},getFormData:function(){var a=this.getForm().getValues();return a}});Ext.define("msdm.strsip.FormController",{extend:"Ext.app.ViewController",alias:"controller.form-strsip-pegawai",filedata:undefined,onFocusEnter:function(e,a){},onSimpan:function(f){var b=this,a=b.getView();rec=a.getRecord();values=a.getForm().getValues();if(a.getForm().isValid()){if(b.filedata){values.FILE=b.filedata}rec.set(values);a.save(f)}},onBatal:function(f){var e=this,a=e.getView();a.fireEvent("batal")},onUpload:function(f){var k=this,b=k.getView(),g=k.getViewModel(),j=f.fileInputEl.dom.files,e=j[0],a=new FileReader();if(e){if(e.type!="application/pdf"){b.notifyMessage("File harus dengan format PDF.");f.reset()}else{a.readAsDataURL(e);a.addEventListener("loadend",function(){k.filedata=Ext.util.Base64.encode(a.result)})}}}});Ext.define("msdm.strsip.List",{extend:"com.Grid",alias:"widget.list-strsip-pegawai",controller:"list-strsip-pegawai",viewModel:{stores:{store:{type:"msdm-strsip-store"},store1:{type:"msdm-strsip-store",queryParams:{SHOW_FILE:1}}},data:{nip:undefined}},border:false,selModel:{allowDeselect:true},initComponent:function(){var a=this;a.columns=[{xtype:"rownumberer",text:"No",align:"left",width:60},{header:"Jenis",dataIndex:"JENIS",align:"left",flex:1,renderer:"onRenderJenis"},{header:"Nomor",dataIndex:"NOMOR",align:"left",flex:1},{text:"Tanggal Berlaku",xtype:"datecolumn",dataIndex:"TANGGAL_BERLAKU",format:"d-m-Y",flex:1},{text:"Berlaku Sampai",xtype:"datecolumn",dataIndex:"BERLAKU_SAMPAI",format:"d-m-Y",flex:1},{text:"File",xtype:"widgetcolumn",width:90,widget:{xtype:"button",iconCls:"x-fa fa-eye",handler:"onViewFile"}},{xtype:"checkcolumn",header:"Status",dataIndex:"STATUS",width:90,listeners:{checkchange:"onChange"}}];a.dockedItems=[{xtype:"pagingtoolbar",bind:{store:"{store}"},dock:"bottom",displayInfo:true,items:[{xtype:"search-field",cls:"x-text-border",autoFocus:true,emptyText:"Cari Nomor STR/SIP",flex:1,listeners:{search:"onsearch",clear:"onClear"}}]}];a.callParent(arguments)},load:function(b){var e=this,a=e.getViewModel().get("store");e.getViewModel().set("nip",b.NIP);if(a){a.removeAll();a.queryParams=a.queryParams||{};if(b){a.queryParams=b}a.load()}}});Ext.define("msdm.strsip.ListController",{extend:"Ext.app.ViewController",alias:"controller.list-strsip-pegawai",onRenderJenis:function(b,a,f){if(f.get("JENIS")==1){var e="STR"}else{var e="SIP"}return e},onsearch:function(l,g){var j=this,k=j.getViewModel(),a=k.get("store");a.queryParams={QUERY:g,NIP:k.get("nip"),SHOW_FILE:0};a.load()},onClear:function(){var e=this,f=e.getViewModel(),a=f.get("store");delete a.queryParams.QUERY;a.load()},onChange:function(n,a,k){var l=this,m=l.getViewModel(),o=m.get("store"),j=o.getAt(a);j.set("STATUS",k?1:0);j.scope=this;j.save({callback:function(e,f,b){if(b){Ext.toast({headerPosition:"left",style:"padding: 7px 0px 0px 4px",border:false,header:{width:13},ui:"danger-blue",html:"Status di "+(k==true?"Aktifkan":"NonAktifkan "),align:"t"})}}})},onViewFile:function(b){var e=this,a=e.getView(),f=b.getWidgetRecord();vm=e.getViewModel();store1=vm.get("store1");store1.queryParams={SHOW_FILE:1,IDX:f.get("ID")};store1.load({callback:function(j,g,l){if(l){var k=a.openDialog(j[0].get("NOMOR"),true,"100%","100%",{xtype:"box",autoEl:{tag:"iframe",style:"height:100%; width:100%",src:j[0].get("FILE")}},function(m,n){},b)}}})}});Ext.define("msdm.strsip.Workspace",{extend:"com.Form",alias:"widget.workspace-strsip-pegawai",controller:"workspace-strsip-pegawai",viewModel:{data:{nip:undefined}},border:false,layout:"border",initComponent:function(){var a=this;a.items=[{region:"north",title:"Form STR/SIP Pegawai",iconCls:"x-fa fa-list",layout:"fit",items:[{xtype:"form-strsip-pegawai",reference:"refForm",listeners:{batal:"onBatal",save:"onSuccess"}}]},{region:"center",xtype:"list-strsip-pegawai",border:false,reference:"refList",listeners:{select:"onSelect"}}];a.callParent(arguments)},load:function(b){var a=this;vm=a.getViewModel(),formm=a.down("form-strsip-pegawai"),list=a.down("list-strsip-pegawai");vm.set("nip",b.get("NIP"));list.load({NIP:b.get("NIP"),SHOW_FILE:0});selection=list.getSelectionModel().getSelection();list.getStore().remove(selection);d=Ext.create("msdm.strsip.Model",{});d.set("NIP",b.get("NIP"));d.set("TANGGAL",a.getSysdate());d.set("STATUS",1);formm.loadData(d)}});Ext.define("msdm.strsip.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.workspace-strsip-pegawai",onBatal:function(){var e=this,a=e.getView(),f=e.getViewModel();ref=e.getReferences();a.getForm().reset();baru=Ext.create("msdm.strsip.Model",{});baru.set("NIP",f.get("nip"));baru.set("TANGGAL",a.getSysdate());baru.set("STATUS",1);ref.refForm.loadData(baru);selectedRows=ref.refList.getSelectionModel().getSelection();ref.refList.getStore().remove(selectedRows);ref.refList.getStore().load()},onSelect:function(m,j,a){var k=this,l=k.getViewModel(),n=k.getReferences();l.set("hideForm",false);l.set("AddButton",true);l.set("CloseButton",false);n.refForm.loadData(j)},onSuccess:function(){var f=this,a=f.getView(),g=f.getViewModel(),j=f.getReferences();a.getForm().reset();news=Ext.create("msdm.strsip.Model",{});news.set("NIP",g.get("nip"));news.set("TANGGAL",a.getSysdate());news.set("STATUS",1);j.refForm.loadData(news);selectedRows=j.refList.getSelectionModel().getSelection();j.refList.getStore().remove(selectedRows);j.refList.getStore().load()}});Ext.define("msdm.waktudinasruangan.Form",{extend:"com.Form",xtype:"msdm-waktudinasruangan-form",controller:"msdm-waktudinasruangan-form",viewModel:{stores:{waktuDinasStore:{type:"msdm-waktudinasruangan-store"}},data:{data:undefined}},model:"msdm.waktudinasruangan.Model",layout:"hbox",defaults:{margin:"2.2.2.2",flex:1},items:[{xtype:"ruangan-combo",emptyText:" [ Unit ] ",params:{JENIS:4},firstLoad:true,reference:"unit",listeners:{select:"onSelectRuangan"}},{xtype:"ruangan-combo",name:"RUANGAN",allowBlank:false,emptyText:" [ Subunit ] ",reference:"subunit",listeners:{select:"onSelectSubUnit"}},{xtype:"referensi-combo",params:{JENIS:82,STATUS:1},allowBlank:false,firstLoad:true,reference:"referensi",name:"JENIS_JADWAL",listeners:{select:"onSelectReferensi"}},{xtype:"timefield",format:"H:i:s",name:"JAM_MASUK"},{xtype:"timefield",format:"H:i:s",name:"JAM_PULANG"},{xtype:"button",ui:"soft-blue",reference:"btnsave",iconCls:"x-fa fa-save",text:"Simpan",handler:"onSimpan"},{xtype:"button",ui:"soft-red",hidden:true,reference:"btnganti",iconCls:"x-fa fa-refresh",text:"Ganti & Simpan",handler:"onGanti"}]});Ext.define("msdm.waktudinasruangan.FormController",{extend:"Ext.app.ViewController",alias:"controller.msdm-waktudinasruangan-form",onSelectRuangan:function(g,k){var j=this,a=j.getView(),f=j.getReferences(),e=f.subunit,b=e.getStore();e.select(null);b.removeAll();b.setQueryParams({ID:k.get("ID"),JENIS:5});b.load();j.getViewModel().set("data",undefined);a.createRecord({STATUS:1,TANGGAL:Ext.Date.format(a.getSysdate(),"Y-m-d H:i:s")});f.referensi.select(null);a.fireEvent("sendRuangan",k);f.btnsave.setHidden(false);f.btnganti.setHidden(true)},onSelectSubUnit:function(b,f){var e=this,a=e.getView();a.fireEvent("sendRuangan",f);a.down("[name = JENIS_JADWAL]").select(null);a.down("[name = JAM_MASUK]").setValue(null);a.down("[name = JAM_PULANG]").setValue(null)},onSelectReferensi:function(f,l){var k=this,a=k.getView(),j=k.getViewModel(),e=k.getReferences(),b=e.subunit,g=j.get("waktuDinasStore");g.setQueryParams({RUANGAN:b.getValue(),JENIS_JADWAL:l.get("ID"),STATUS:1});g.load({callback:function(n,m,o){if(o){obj=n[0].getData();j.set("data",n[0]);delete obj.ID;a.createRecord(obj)}else{j.set("data",undefined)}e.btnsave.setHidden(o);e.btnganti.setHidden(!o)}})},onSimpan:function(b){var e=this,a=e.getView();e.simpan(b)},onGanti:function(b){var f=this,a=f.getView(),e=f.getViewModel(),g=e.get("data");g.set("STATUS",0);g.save({callback:function(k,l,j){if(j){f.simpan(b)}else{a.notifyMessage("gagal update data","danger-red")}}})},privates:{simpan:function(e){var g=this,a=g.getView(),b=g.getReferences(),f=g.getViewModel();a.save(e,{},function(l,j,k){if(k){f.set("data",l);obj=l.getData();delete obj.ID;a.createRecord(obj)}else{f.set("data",undefined)}b.btnsave.setHidden(k);b.btnganti.setHidden(!k)})}}});Ext.define("msdm.waktudinasruangan.List",{extend:"com.Grid",xtype:"msdm-waktudinasruangan-list",viewModel:{stores:{store:{type:"msdm-waktudinasruangan-store"}}},columns:[{xtype:"templatecolumn",text:"Deskripsi",flex:1,dataIndex:"JENIS_JADWAL",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.JENIS_JADWAL.DESKRIPSI}</div>'},{xtype:"datecolumn",format:"H:i:s",text:"Jam Masuk",flex:1,dataIndex:"JAM_MASUK"},{xtype:"datecolumn",format:"H:i:s",text:"Jam Pulang",flex:1,dataIndex:"JAM_PULANG"},{xtype:"datecolumn",format:"Y-m-d H:i:s",text:"Tanggal",flex:1,dataIndex:"TANGGAL"},{text:"Status",align:"center",xtype:"templatecolumn",dataIndex:"STATUS",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="thumb-wrap-dis">','<div class="thumb">','<div style="color:{[this.getColor(values.STATUS)]};font-size: 18px;"> <il class="{[this.getIconStatus(values.STATUS)]}"></il></div>',"</div>","</div>","</tpl>",{getIconStatus:function(a){if(a==1){return"x-fa fa-check-circle"}else{return"x-fa fa-times-circle"}},getColor:function(a){if(a==1){return"green"}else{return"red"}}})}]});Ext.define("msdm.waktudinasruangan.Workspace",{extend:"com.Form",xtype:"msdm-waktudinasruangan-workspace",controller:"msdm-waktudinasruangan-workspace",layout:"border",border:false,items:[{region:"north",ui:"panel-cyan",iconCls:"x-fa fa-edit",title:"Form",xtype:"msdm-waktudinasruangan-form",listeners:{sendRuangan:"onSendRuangan",save:"onSave"}},{region:"center",flex:1,iconCls:"x-fa fa-hourglass",title:"Waktu Dinas Ruangan",ui:"panel-cyan",xtype:"msdm-waktudinasruangan-list"}],load:function(){var e=this,f=e.down("msdm-waktudinasruangan-list"),b=e.down("msdm-waktudinasruangan-form"),a=f.getStore();b.getForm().reset();b.createRecord({STATUS:1,TANGGAL:Ext.Date.format(e.getSysdate(),"Y-m-d H:i:s")});a.removeAll();delete a.queryParams.RUANGAN}});Ext.define("msdm.waktudinasruangan.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-waktudinasruangan-workspace",onSendRuangan:function(e){var b=this,a=b.getView();a.down("msdm-waktudinasruangan-list").load({RUANGAN:e.get("ID")})},onSave:function(b){var e=this,a=e.getView();a.down("msdm-waktudinasruangan-list").reload()}});Ext.define("msdm.widget.absensi.Info",{extend:"com.Form",xtype:"msdm-widget-absensi-info",controller:"msdm-widget-absensi-info",viewModel:{data:{image:"nousuario.jpg",pegawai:undefined,haritanggal:"",masuk:"",pulang:"",akses:false},stores:{rincianabsensi:{type:"msdm-rincianabsensi-store"}}},cls:"shadow-panel",layout:{type:"vbox",align:"stretch"},dockedItems:[{xtype:"toolbar",dock:"top",height:30,padding:1,items:["->",{bind:{hidden:"{!akses}"},xtype:"button",menu:[{text:"Dasar Jadwal",iconCls:"x-fa fa-thumbs-up",listeners:{click:"OnInputDasarJadwal"}},{text:"Input Izin/Cuti",iconCls:"x-fa fa-edit",listeners:{click:"OnInputIzinCuti"}}]}]}],border:true,bodyPadding:0,items:[{xtype:"fieldcontainer",padding:"15 15 15 15",border:false,flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"image",padding:"15 15 15 15",width:90,height:85,bind:{src:"resources/images/finger.png"}},{xtype:"fieldcontainer",layout:{type:"vbox"},flex:1,defaults:{xtype:"component",style:"text-align: left; padding-top: 5px;padding-left:10px; font-size: 0.9em;color:#29928e"},border:false,items:[{style:"text-align: left; padding-top: 10px;padding-left:10px; font-size: 2em; font-weight: bold",html:"ABSENSI"},{style:"text-align: left; padding-top: 10px;padding-left:10px; font-size: 1.4em;color:#29928e; ",bind:{html:"{haritanggal}"}},{style:"text-align: left; padding-top: 2px;padding-left:10px; font-size: 1.4em;color:#29928e;",bind:{html:"{masuk} - {pulang}"}}]}]},{xtype:"button",iconCls:"button-home-small",ui:"soft-cyan",text:"Lihat Absensi",handler:"onDetilAbsensi"}],load:function(g){var b=this,a=b.getViewModel().get("rincianabsensi"),f=webservice.app,e=f.xpriv;a.queryParams={NIP:g.get("NIP"),TANGGAL:Ext.Date.format(b.getSysdate(),"Y-m-d")};if(e("24010102",true)){b.getViewModel().set("akses",true)}a.load({callback:function(k,j,l){if(l){b.getViewModel().set("pegawai",g);b.getViewModel().set("haritanggal",Ext.Date.format(b.getSysdate(),"l, d-m-Y"));b.getViewModel().set("masuk",k[0].get("MASUK"));b.getViewModel().set("pulang",k[0].get("PULANG"))}}})}});Ext.define("msdm.widget.absensi.InfoController",{extend:"Ext.app.ViewController",alias:"controller.msdm-widget-absensi-info",onDetilAbsensi:function(e){var b=this,a=b.getView(),f=a.getViewModel().get("pegawai");a.openDialog("",true,600,160,{xtype:"msdm-absensi-dashboard-workspace",ui:"panel-gray",title:"Absensi Pegawai",showCloseButton:true,iconCls:"x-fa fa-user"},function(g,k){var j=k.down("msdm-absensi-dashboard-workspace");j.load(f)})},OnInputIzinCuti:function(e){var b=this,a=b.getView(),f=a.getViewModel().get("pegawai");a.openDialog("",true,800,550,{xtype:"msdm-pegawaiabsen-workspace",ui:"panel-gray",title:"Input Izin/Cuti",showCloseButton:true,iconCls:"x-fa fa-user"},function(g,k){var j=k.down("msdm-pegawaiabsen-workspace");j.load(f)})},OnInputDasarJadwal:function(b){var e=this,a=e.getView(),f=a.getViewModel().get("pegawai");a.openDialog("",true,850,500,{layout:"border",xtype:"com-form",ui:"panel-gray",title:"Dasar Jadwal",showCloseButton:true,bodyPadding:0,iconCls:"x-fa fa-thumbs-up",items:[{xtype:"msdm-dasarjadwal-workspace",region:"center"}]},function(g,k){var j=k.down("msdm-dasarjadwal-workspace");j.load(f)},b)}});Ext.define("msdm.widget.identitas.Detail",{extend:"com.Form",xtype:"msdm-widget-identitas-detail",controller:"msdm-widget-identitas-detail",viewModel:{data:{pegawai:undefined,menu:[{glyph:"xf05a@FontAwesome",handler:"onShowDetail",text:"Detail"}]},formulas:{getTglLahir:function(b){return Ext.Date.format(b("pegawai.TANGGAL_LAHIR"),"d F Y")}}},layout:{type:"vbox",align:"stretch"},dockedItems:[{xtype:"toolbar",dock:"top",height:30,padding:1,items:["->",{xtype:"button",bind:{menu:"{menu}"}}]}],border:true,bodyPadding:15,defaultType:"component",items:[{style:"font-size:17px; text-align: left; padding-top:5px; padding-bottom:3px;font-weight: bold",html:"ALAMAT"},{style:"font-size:15px; text-align: left; padding-bottom:10px;color:#29928e;",bind:{html:"{pegawai.ALAMAT}"}},{style:"font-size:17px; text-align: left; padding-top:5px; padding-bottom:3px;font-weight: bold",html:"TEMPAT / TANGGAL LAHIR"},{style:"font-size:15px; text-align: left; padding-bottom:10px;color:#29928e;",bind:{html:"{pegawai.TEMPAT_LAHIR} / {getTglLahir}"}},{style:"font-size:17px; text-align: left; padding-top:5px; padding-bottom:3px;font-weight: bold",html:"AGAMA"},{style:"font-size:15px; text-align: left; padding-bottom:10px;color:#29928e;",bind:{html:"{pegawai.REFERENSI.AGAMA.DESKRIPSI}"}},{style:"font-size:17px; text-align: left; padding-top:5px; padding-bottom:3px;font-weight: bold",html:"PROFESI"},{style:"font-size:15px; text-align: left; padding-bottom:5px;color:#29928e;",bind:{html:"{pegawai.REFERENSI.PROFESI.DESKRIPSI}"}}],load:function(e){var b=this,a=b.getViewModel();a.set("pegawai",e)}});Ext.define("msdm.widget.identitas.DetailController",{extend:"Ext.app.ViewController",alias:"controller.msdm-widget-identitas-detail",init:function(){var b=this,a=b.getViewModel(),e=webservice.app.xpriv,f=a.get("menu");if(e("24010102",true)){f.push({text:"Status Pegawai",handler:"onSelectMenu",widget:"msdm-statuspegawai-workspace",maxWindow:false,iconCls:"x-fa fa-users"});f.push({text:"Pangkat/Golongan",handler:"onSelectMenu",iconCls:"x-fa fa-users",widget:"msdm-pangkatgolongan-workspace",maxWindow:false});f.push({text:"Keluarga",handler:"onSelectMenu",widget:"msdm-keluarga-workspace",maxWindow:false,iconCls:"x-fa fa-users"});f.push({text:"Pendidikan",handler:"onSelectMenu",widget:"msdm-pendidikan-workspace",maxWindow:false,iconCls:"x-fa fa-user-secret"});f.push({text:"Pelatihan",handler:"onSelectMenu",widget:"msdm-pelatihan-workspace",maxWindow:false,iconCls:"x-fa fa-book"});f.push({text:"STR SIP",handler:"onSelectMenu",widget:"workspace-strsip-pegawai",maxWindow:false,iconCls:"simpel-penilaian"});f.push({text:"Payroll",handler:"onSelectMenu",widget:"msdm-payroll-detil-workspace",maxWindow:false,iconCls:"x-fa fa-paypal"})}},onShowDetail:function(a){this.showWindow(a,{form:"msdm-widget-identitas-informasi-workspace",title:"Detail Pegawai",icon:"x-fa fa-user"},true)},onSelectMenu:function(a){this.showWindow(a,{form:a.widget,title:a.text,icon:a.iconCls},a.maxWindow)},privates:{showWindow:function(m,b,f){var g=this,j=g.getView(),k=f?0:850,e=f?0:500,l=(b.fullscrean)?true:false,a=g.getViewModel();j.openDialog("",true,k,e,{xtype:b.form,ui:"panel-gray",title:b.title,showCloseButton:true,fullscreenEnabled:l,iconCls:b.icon},function(n,p){var o=p.down(b.form);o.load(a.get("pegawai"))},m)}}});Ext.define("msdm.widget.identitas.Workspace",{extend:"com.Form",xtype:"msdm-widget-identitas-workspace",viewModel:{data:{image:"nousuario.jpg",pegawai:undefined},formulas:{getImage:function(b){var e=(b("pegawai.JENIS_KELAMIN")==2)?"nophoto-female.jpg":"nousuario.jpg";return e}}},layout:{type:"vbox",align:"center"},defaults:{border:false},cls:"card hovercard",border:false,bodyPadding:0,defaultType:"component",initComponent:function(){var a=this;a.items=[{cls:"cardheader",width:"100%"},{cls:"avatar"},{xtype:"image",border:true,style:"display: inline-block; border-radius: 30%; -moz-border-radius: 30%; -webkit-border-radius: 30%; border: 20px solid rgba(255,255,255,0.5)",bind:{src:"resources/images/{getImage}"},width:110,height:110,alt:"no-image"},{width:"100%",style:"text-align: center; padding-top:35px; padding-bottom :8px; padding-left:10px; font-size: 2em; font-weight: bold",html:"PROFIL PEGAWAI"},{width:"100%",cls:"title",bind:{html:"{pegawai.GELAR_DEPAN} {pegawai.NAMA} {pegawai.GELAR_BELAKANG}"}},{width:"100%",style:"font-size:15px; margin-left: 10px; margin-right: 10px; padding-top:5px; padding-bottom:5px;",bind:{html:"NIP : {pegawai.NIP} "}}];a.callParent(arguments)}});Ext.define("msdm.widget.identitas.informasi.Form",{extend:"com.Form",xtype:"msdm-widget-identitas-informasi-form",viewModel:{stores:{kartuStore:{type:"referensi-store"}},data:{pegawai:undefined,kartu:undefined,jeniskartu:undefined},formulas:{getTglLahir:function(b){return Ext.Date.format(b("pegawai.TANGGAL_LAHIR"),"d F Y")},getImage:function(b){var e=(b("pegawai.JENIS_KELAMIN")==2)?"nophoto-female.jpg":"nousuario.jpg";return e},getJenisKelamin:function(b){var e=(b("pegawai.JENIS_KELAMIN")==2)?"Wanita":"Pria";return e}}},layout:"vbox",bodyPadding:5,items:[{layout:"hbox",defaults:{margin:"5.2.2.2"},width:"100%",items:[{xtype:"image",border:true,style:"display: inline-block; border-radius: 30%; -moz-border-radius: 30%; -webkit-border-radius: 30%; border: 20px solid rgba(255,255,255,0.5)",bind:{src:"resources/images/{getImage}"},width:110,height:110,alt:"no-image"},{layout:{type:"vbox",align:"stretch"},width:"30%",defaults:{margin:"2.2.2.2"},defaultType:"component",items:[{style:"font-size:17px;",bind:{html:"{pegawai.GELAR_DEPAN} {pegawai.NAMA} {pegawai.GELAR_BELAKANG}"}},{bind:{html:"NIP/NRK : {pegawai.NIP}"}},{bind:{html:"Jenis Kelamin : {getJenisKelamin}"}},{xtype:"button",ui:"soft-red",padding:4,text:"Ganti Password"}]},{layout:{type:"vbox",align:"stretch"},width:"30%",defaults:{margin:"2.2.2.2"},defaultType:"component",items:[{style:"font-weight: bold",html:"ALAMAT"},{style:"color:#29928e;",bind:{html:"{pegawai.ALAMAT}"}},{style:"font-weight: bold",html:"TEMPAT / TANGGAL LAHIR"},{style:"color:#29928e;",bind:{html:"{pegawai.TEMPAT_LAHIR} / {getTglLahir}"}}]},{layout:{type:"vbox",align:"stretch"},width:"30%",defaults:{margin:"2.2.2.2"},defaultType:"component",items:[{style:"font-weight: bold",html:"AGAMA"},{style:"color:#29928e;",bind:{html:"{pegawai.REFERENSI.AGAMA.DESKRIPSI}"}},{style:"font-weight: bold",html:"JENIS PROFESI"},{style:"color:#29928e;",bind:{html:"{pegawai.REFERENSI.PROFESI.DESKRIPSI}"}}]}]},{layout:"hbox",defaults:{margin:"1.1.1.1",width:"50%",bodyPadding:2,ui:"panel-black"},width:"100%",items:[{title:"Kartu Identitas",layout:{type:"vbox",align:"stretch"},defaults:{margin:"2.2.2.2"},items:[{layout:"hbox",width:"100%",defaults:{margin:"2.2.2.2"},defaultType:"component",items:[{style:"font-weight: bold",html:"JENIS KARTU : "},{style:"color:#29928e;",bind:{html:"{jeniskartu.DESKRIPSI}"}},{style:"font-weight: bold",html:"NOMOR : "},{style:"color:#29928e;",bind:{html:"{kartu.NOMOR}"}}]},{layout:"hbox",width:"100%",defaults:{margin:"2.2.2.2"},defaultType:"component",items:[{style:"font-weight: bold",html:"ALAMAT : "},{style:"color:#29928e;",bind:{html:"{kartu.ALAMAT}"}}]},{layout:"hbox",width:"100%",defaults:{margin:"2.2.2.2"},defaultType:"component",items:[{style:"font-weight: bold",html:"RT/RW : "},{style:"color:#29928e;",bind:{html:"{kartu.RT} / {kartu.RW}"}},{style:"font-weight: bold",html:"KODE POS : "},{style:"color:#29928e;",bind:{html:"{kartu.KODEPOS}"}}]}]},{title:"Alamat",layout:{type:"vbox",align:"stretch"},defaults:{margin:"2.2.2.2"},items:[{layout:"hbox",width:"100%",defaults:{margin:"2.2.2.2"},defaultType:"component",items:[{style:"font-weight: bold",html:"ALAMAT : "},{style:"color:#29928e;",bind:{html:"{pegawai.ALAMAT}"}}]},{layout:"hbox",width:"100%",defaults:{margin:"2.2.2.2"},defaultType:"component",items:[{style:"font-weight: bold",html:"RT/RW : "},{style:"color:#29928e;",bind:{html:"{pegawai.RT} / {pegawai.RW}"}},{style:"font-weight: bold",html:"KODE POS : "},{style:"color:#29928e;",bind:{html:"{pegawai.KODEPOS}"}}]}]}]}],load:function(f){var b=this,e=f.get("KARTU_IDENTITAS")?f.get("KARTU_IDENTITAS"):undefined,e=e?e[0]:undefined,a=b.getViewModel();a.set("kartu",e);if(e){b.getKartu(e.JENIS)}},getKartu:function(b){var e=this.getViewModel(),a=e.get("kartuStore");a.setQueryParams({ID:b,JENIS:9});a.load({callback:function(g,f,j){if(j){e.set("jeniskartu",g[0])}}})}});Ext.define("msdm.widget.identitas.informasi.Link",{extend:"com.Tab",xtype:"msdm-widget-identitas-informasi-link",controller:"msdm-widget-identitas-informasi-link",activeTab:0,cls:"x-br-top",ui:"header-tab",rec:undefined,items:[{title:"Kontak",iconCls:"x-fa fa-phone",xtype:"msdm-kontak-list"},{title:"Kartu Asuransi",iconCls:"x-fa fa-credit-card",xtype:"msdm-kartuasuransi-list"},{title:"Rekening",iconCls:"x-fa fa-money",xtype:"msdm-rekening-workspace"},{title:"NPWP",iconCls:"x-fa fa-tags",xtype:"msdm-npwp-workspace"}],loadStore:function(g){var b=this,e=b.down("msdm-kontak-list"),f=b.down("msdm-kartuasuransi-list"),a=this.getActiveTab();b.actionRemove(e,2);b.actionRemove(f,2);b.rec=g;if(a){a.load(g)}else{if(b.items.getCount()>0){b.setActiveTab(0)}}},actionRemove:function(e,a){var b=e.getHeaderContainer();e.getHeaderContainer().remove(b.items.items[a])},listeners:{tabchange:"onTabChange"}});Ext.define("msdm.widget.identitas.informasi.LinkController",{extend:"Ext.app.ViewController",alias:"controller.msdm-widget-identitas-informasi-link",onRefresh:function(a){var e=this;e.getView().loadStore({})},onTabChange:function(e,a){var b=this.getView().rec;if(a.load){a.load(b)}}});Ext.define("msdm.widget.identitas.informasi.Workspace",{extend:"com.Form",xtype:"msdm-widget-identitas-informasi-workspace",viewModel:{data:{pegawai:undefined}},layout:"border",bodyPadding:5,border:false,items:[{region:"north",xtype:"msdm-widget-identitas-informasi-form",flex:0.8},{region:"center",xtype:"msdm-widget-identitas-informasi-link",flex:1}],load:function(g){var f=this,e=f.down("msdm-widget-identitas-informasi-form"),b=f.down("msdm-widget-identitas-informasi-link"),a=f.getViewModel();a.set("pegawai",g);e.load(g);b.loadStore(g)}});Ext.define("msdm.widget.jadwaldinas.Form",{extend:"com.Form",xtype:"msdm-widget-jadwaldinas-form",layout:{type:"vbox",align:"left"},border:false,initComponent:function(){var a=this;Ext.Date.dayNames=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];Ext.Date.monthNames=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];a.items=[{xtype:"datepicker",flex:1,showToday:false,showPrevMonth:function(b){a.fireEvent("loadTanggal",Ext.Date.add(this.activeDate,Ext.Date.MONTH,-1));return this.update(Ext.Date.add(this.activeDate,Ext.Date.MONTH,-1))},showNextMonth:function(b){a.fireEvent("loadTanggal",Ext.Date.add(this.activeDate,Ext.Date.MONTH,1));return this.update(Ext.Date.add(this.activeDate,Ext.Date.MONTH,1))},onOkClick:function(e,g){var j=g[0],f=g[1],b=new Date(f,j,this.getActive().getDate());a.fireEvent("loadTanggal",Ext.Date.add(b));this.update(Ext.Date.add(b));this.hideMonthPicker()}},{xtype:"dataview",title:"Keterangan",layout:"fit",cls:"laporan-main laporan-dataview",store:Ext.create("Ext.data.Store",{fields:["kontak","nama"],data:[{dinas:"1",deskripsi:"Pagi"},{dinas:"2",deskripsi:"Siang"},{dinas:"3",deskripsi:"Malam"},{dinas:"4",deskripsi:"Libur"}]}),itemSelector:"div.thumb-wrap",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<tpl if="dinas == 1">','<div class="thumb" style="background-color:#99ff99">','<div class="thumb-title-container">',"{deskripsi}","</div>","</div>","</tpl>",'<tpl if="dinas == 2">','<div class="thumb" style="background-color:#ffffcc">','<div class="thumb-title-container">',"{deskripsi}","</div>","</div>","</tpl>",'<tpl if="dinas == 3">','<div class="thumb" style="background-color:#bfbfbf">','<div class="thumb-title-container">',"{deskripsi}","</div>","</div>","</tpl>",'<tpl if="dinas == 4">','<div class="thumb" style="background-color:#ff6699">','<div class="thumb-title-container">',"{deskripsi}","</div>","</div>","</tpl>","</tpl>",{})}];a.callParent(arguments)},setDatesToHighlight:function(e){var b=this,a=b.getViewModel();pic=b.down("datepicker");b.highlightDates(pic,e)},highlightDates:function(k,a){if(Ext.isEmpty(a)){return}for(var j=0;j<a.length;j++){var e=[];e[0]=[a[j].get("REFERENSI").SHIFT.JENIS_JADWAL];var o=new Date(Ext.Date.format(a[j].get("TANGGAL"),"Y-m-d")),f=o.getTime(),g=o.getTimezoneOffset()*60*1000,b=f+g,n=k.cells.elements;if(e[0]=="1"){for(var l=0;l<n.length;l++){var m=Ext.fly(n[l]);if(m.dom.firstChild.dateValue==b){m.addCls("jadwalDinasHijau");break}}}else{if(e[0]=="2"){for(var l=0;l<n.length;l++){var m=Ext.fly(n[l]);if(m.dom.firstChild.dateValue==b){m.addCls("jadwalDinasKuning");break}}}else{if(e[0]=="3"){for(var l=0;l<n.length;l++){var m=Ext.fly(n[l]);if(m.dom.firstChild.dateValue==b){m.addCls("jadwalDinasAbu");break}}}else{for(var l=0;l<n.length;l++){var m=Ext.fly(n[l]);if(m.dom.firstChild.dateValue==b){m.addCls("jadwalDinasMerah");break}}}}}}}});Ext.define("msdm.widget.jadwaldinas.Info",{extend:"com.Form",xtype:"msdm-widget-jadwaldinas-info",controller:"msdm-widget-jadwaldinas-info",viewModel:{stores:{jadwalStore:{type:"msdm-jadwaldinas-store"},schedule:{type:"msdm-schedule-store"},shift:{type:"msdm-schedule-shift-store"}},data:{image:"nousuario.jpg",pegawai:undefined,jadwal:"Tidak ada jadwal",tanggal:undefined}},cls:"shadow-panel",layout:{type:"vbox",align:"stretch"},dockedItems:[{xtype:"toolbar",dock:"top",height:30,padding:1,items:["->"]}],border:true,bodyPadding:0,items:[{xtype:"fieldcontainer",padding:"15 15 15 15",border:false,flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"image",padding:"5 5 5 5",width:90,height:85,bind:{src:"resources/images/calendar.png"}},{xtype:"fieldcontainer",layout:{type:"vbox"},flex:1,border:false,defaultType:"component",items:[{style:"text-align: left; padding-top: 10px;padding-left:10px; font-size: 2em; font-weight: bold",html:"JADWAL DINAS"},{style:"text-align: left; padding-top: 10px;padding-left:10px; font-size: 1.4em;color:#29928e; ",bind:{html:"{tanggal}"}},{style:"text-align: left; padding-top: 2px;padding-left:10px; font-size: 1.4em;color:#29928e;",width:"100%",align:"stretch",bind:{html:"{jadwal}"}}]}]},{xtype:"button",iconCls:"button-home-small",ui:"soft-red",text:"Lihat Jadwal Dinas",handler:"onViewJadwalDinas"}]});Ext.define("msdm.widget.jadwaldinas.InfoController",{extend:"Ext.app.ViewController",alias:"controller.msdm-widget-jadwaldinas-info",init:function(){var g=this,e=g.getView(),f=g.getViewModel(),j=f.get("schedule"),b=f.get("shift"),a=f.get("jadwalStore");f.set("tanggal",Ext.Date.format(e.getSysdate(),"l, d F Y"));a.setQueryParams({NIP:f.get("pegawai").get("NIP"),TANGGAL:Ext.Date.format(e.getSysdate(),"Y-m-d"),STATUS:1});a.load({callback:function(l,k,n){if(n){var m=l[0];b.setQueryParams({ID:m.get("DINAS"),SHOW_DETAIL:1});b.load({callback:function(o,p,q){if(q){shiftdesk=o[0];deskripsiShift=(shiftdesk.get("REFERENSI"))?(shiftdesk.get("REFERENSI").JENIS_JADWAL)?shiftdesk.get("REFERENSI").JENIS_JADWAL.DESKRIPSI:"":"";jamShift=(shiftdesk.get("REFERENSI"))?(shiftdesk.get("REFERENSI").DETAIL)?shiftdesk.get("REFERENSI").DETAIL:"":"";jamShift=jamShift.JAM_MASUK+" S/D "+jamShift.JAM_PULANG;j.setQueryParams({ID:shiftdesk.get("SCHEDULE")});j.load({callback:function(s,r,t){if(t){desksch=s[0];jadwal=desksch.get("DESK")+" - "+deskripsiShift+"<br>"+jamShift;f.set("jadwal",jadwal)}}})}}})}else{f.set("jadwal","Tidak ada jadwal")}}})},onViewJadwalDinas:function(b){var f=this,e=f.getViewModel(),a=f.getView();a.openDialog("",true,800,450,{xtype:"msdm-widget-jadwaldinas-workspace",ui:"panel-gray",title:"Jadwal Dinas",showCloseButton:true,iconCls:"x-fa fa-calendar"},function(g,k){var j=k.down("msdm-widget-jadwaldinas-workspace");j.load(e.get("pegawai"),a.getSysdate())})}});Ext.define("msdm.widget.jadwaldinas.List",{extend:"com.Grid",xtype:"msdm-widget-jadwaldinas-list",viewModel:{stores:{store:{type:"msdm-jadwaldinas-store"}}},flex:1,border:true,defaults:{bodyPadding:"2.2.2.2"},columns:[{xtype:"datecolumn",format:"d-m-Y",text:"Tanggal",dataIndex:"TANGGAL",flex:1},{xtype:"templatecolumn",text:"Deskripsi",dataIndex:"DINAS",tpl:'<div style="white-space:normal !important;color:black">{REFERENSI.SHIFT.REFERENSI.JENIS_JADWAL.DESKRIPSI}</div>',flex:1}]});Ext.define("msdm.widget.jadwaldinas.Workspace",{extend:"com.Form",xtype:"msdm-widget-jadwaldinas-workspace",controller:"msdm-widget-jadwaldinas-workspace",viewModel:{stores:{store:{type:"msdm-jadwaldinas-store"}},data:{pegawai:undefined}},layout:"border",border:false,margin:"2.2.2.2",initComponent:function(){var a=this;a.items=[{region:"center",flex:1.2,title:"Tanggal",ui:"panel-cyan",xtype:"msdm-widget-jadwaldinas-form",listeners:{loadTanggal:"onLoadTanggal",selectTanggal:"onSelectTanggal"}},{region:"east",flex:1.5,layout:"fit",ui:"panel-cyan",title:"Deskripsi",xtype:"msdm-widget-jadwaldinas-list"}];a.callParent(arguments)},load:function(k,j){var f=this,e=f.down("msdm-widget-jadwaldinas-form"),g=f.down("msdm-widget-jadwaldinas-list"),b=f.getViewModel(),a=j?Ext.Date.format(j,"Y-m"):Ext.Date.format(f.getSysdate(),"Y-m");store=b.get("store"),params={NIP:k.get("NIP"),FILTERTANGGAL:1,TANGGAL:a,STATUS:1};if(k){b.set("pegawai",k);g.load(params);store.queryParams=params;store.load({callback:function(m,l,n){if(n){e.loadRecord(m);e.setDatesToHighlight(m)}}})}}});Ext.define("msdm.widget.jadwaldinas.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.msdm-widget-jadwaldinas-workspace",onLoadTanggal:function(f){var e=this,a=e.getView(),b=e.getViewModel();a.load(b.get("pegawai"),f)},onSelectTanggal:function(b){var e=this,a=e.getView();a.fireEvent("pilihTanggal",b)}});Ext.define("msdm.widget.penempatanmutasi.Info",{extend:"com.Form",xtype:"msdm-widget-penempatanmutasi-info",controller:"msdm-widget-penempatanmutasi-info",viewModel:{data:{image:"nousuario.jpg",pegawai:undefined,unit:"",jabatan:""},stores:{penempatansekarang:{type:"msdm-penempatan-sekarang-store"}}},cls:"shadow-panel",layout:{type:"vbox",align:"stretch"},dockedItems:[{xtype:"toolbar",dock:"top",height:30,padding:1,items:["->"]}],border:true,bodyPadding:0,items:[{xtype:"fieldcontainer",padding:"15 15 15 15",xtype:"fieldcontainer",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"image",padding:"5 5 5 5",width:90,height:85,bind:{src:"resources/images/user.png"}},{xtype:"fieldcontainer",layout:{type:"vbox"},defaults:{xtype:"component",style:"text-align: left; padding-top: 5px;padding-left:10px; font-size: 0.9em;color:#29928e"},border:false,items:[{style:"text-align: left; padding-top: 10px;padding-left:10px; font-size: 1.6em; font-weight: bold",html:"PENEMPATAN PEGAWAI"},{style:"text-align: left; padding-top: 10px;padding-left:10px; font-size: 1.4em;color:#29928e; ",width:"100%",align:"stretch",bind:{html:"{unit}"}},{style:"text-align: left; padding-top: 2px;padding-left:10px; font-size: 1.4em;color:#29928e;",width:"100%",align:"stretch",bind:{html:"{jabatan}"}}]}]},{xtype:"button",iconCls:"button-home-small",text:"Lihat Penempatan",handler:"onDetilPenempatan"}],load:function(e){var b=this,a=b.getViewModel().get("penempatansekarang");a.queryParams={NIP:e.get("NIP")};a.load({callback:function(g,f,j){if(j){b.getViewModel().set("pegawai",e);b.getViewModel().set("unit",g[0].get("REFERENSI").RUANGAN.DESKRIPSI);b.getViewModel().set("jabatan",g[0].get("REFERENSI").JABATAN.DESKRIPSI)}}})}});Ext.define("msdm.widget.penempatanmutasi.InfoController",{extend:"Ext.app.ViewController",alias:"controller.msdm-widget-penempatanmutasi-info",onDetilPenempatan:function(e){var b=this,a=b.getView(),f=a.getViewModel().get("pegawai");a.openDialog("",true,600,450,{xtype:"penempatanmutasi-pegawai-listdetil",ui:"panel-gray",title:"Penempatan Pegawai",showCloseButton:true,iconCls:"x-fa fa-user"},function(j,k){var g=k.down("penempatanmutasi-pegawai-listdetil");g.load({NIP:f.get("NIP"),STATUS:2});g.setGridConfig({paging:true})})}});Ext.define("msdm.widget.penempatanmutasi.ListPenempatan",{extend:"com.Grid",alias:"widget.penempatanmutasi-pegawai-list",viewModel:{stores:{store:{type:"msdm-penempatan-store"}}},ui:"panel-cyan",flex:1,border:true,columns:[{xtype:"rownumberer",text:"No",align:"left",width:"10%"},{text:"Surat Keterangan (SK)",dataIndex:"SK",flex:1},{xtype:"datecolumn",format:"d-m-Y H:i:s",text:"Tanggal",dataIndex:"TANGGAL",flex:1}]});Ext.define("msdm.widget.penempatanmutasi.ListPenempatanDetil",{extend:"com.Grid",alias:"widget.penempatanmutasi-pegawai-listdetil",viewModel:{stores:{store:{type:"msdm-penempatan-detil-store"}}},flex:1,bind:{store:"{store}"},ui:"panel-cyan",border:true,columns:[{xtype:"rownumberer",text:"No",align:"left",width:"10"},{xtype:"templatecolumn",text:"Ruangan",tpl:"{REFERENSI.RUANGAN.DESKRIPSI}",flex:1},{xtype:"templatecolumn",text:"Jabatan",tpl:"{REFERENSI.JABATAN.DESKRIPSI}",flex:1},{xtype:"datecolumn",format:"d-m-Y",text:"Tanggal Berlaku",dataIndex:"TANGGAL_BERLAKU",flex:1}]});Ext.define("msdm.widget.penempatanmutasi.Workspace",{extend:"com.Form",xtype:"widget-penempatanmutasi-pegawai-workspace",controller:"widget-penempatanmutasi-pegawai-workspace",layout:{type:"vbox",align:"stretch"},initComponent:function(){var a=this;a.items=[{region:"center",xtype:"penempatanmutasi-pegawai-listdetil",flex:1,reference:"listdetilpenempatan"}];a.callParent(arguments)},load:function(e){var a=this,b=a.down("penempatanmutasi-pegawai-listdetil");b.load({NIP:e.get("NIP")})}});Ext.define("msdm.widget.penempatanmutasi.WorkspaceController",{extend:"Ext.app.ViewController",alias:"controller.widget-penempatanmutasi-pegawai-workspace",onSelectList:function(l,m,f){var k=this,g=k.getView(),a=m.get("ID"),j=k.getReferences();if(m){g.loadRecord(m);j.listdetilpenempatan.load({PENEMPATAN:a})}}});