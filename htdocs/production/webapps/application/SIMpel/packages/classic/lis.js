Ext.define("lis.hasillog.Model",{extend:"data.model.Model",serviceName:"lis/hasil-log",fields:[{name:"ID",type:"int"},{name:"LIS_NO",type:"string"},{name:"HIS_NO_LAB",type:"string"},{name:"LIS_KODE_TEST",type:"string"},{name:"LIS_NAMA_TEST",type:"string"},{name:"LIS_HASIL",type:"string"},{name:"LIS_CATATAN",type:"string"},{name:"LIS_NILAI_NORMAL",type:"string"},{name:"LIS_FLAG",type:"string"},{name:"LIS_SATUAN",type:"string"},{name:"LIS_NAMA_INSTRUMENT",type:"string"},{name:"LIS_TANGGAL",type:"date"},{name:"LIS_USER",type:"string"},{name:"HIS_KODE_TEST",type:"int"},{name:"REF",type:"string"},{name:"PREFIX_KODE",type:"string"},{name:"VENDOR_LIS",type:"int"},{name:"LIS_LOKASI",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("lis.hasillog.Store",{extend:"data.store.Store",model:"lis.hasillog.Model",alias:"store.lis-hasillog-store"});Ext.define("lis.info.Model",{extend:"data.model.Model",serviceName:"lis/service/info",fields:[{name:"ID",type:"int"},{name:"NAMA",type:"string"},{name:"NAMA_SCHEDULER",type:"string"},{name:"SCHEDULER_LAST_RUN",type:"string"},{name:"DB_STATUS",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("lis.info.Store",{extend:"data.store.Store",model:"lis.info.Model",alias:"store.lis-info-store"});Ext.define("lis.mappinghasil.Model",{extend:"data.model.Model",serviceName:"lis/mapping-hasil",fields:[{name:"ID",type:"int"},{name:"VENDOR_LIS",type:"int"},{name:"LIS_KODE_TEST",type:"string"},{name:"PREFIX_KODE",type:"string"},{name:"HIS_KODE_TEST",type:"int"},{name:"PARAMETER_TINDAKAN_LAB",type:"int"}],idProperty:"ID"});Ext.define("lis.mappinghasil.Store",{extend:"data.store.Store",model:"lis.mappinghasil.Model",alias:"store.lis-mappinghasil-store"});Ext.define("lis.parameter.Model",{extend:"data.model.Model",serviceName:"lis/parameter",fields:[{name:"ID",type:"int"},{name:"VENDOR_ID",type:"int"},{name:"KODE",type:"string"},{name:"NAMA",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("lis.parameter.Store",{extend:"data.store.Store",model:"lis.parameter.Model",alias:"store.lis-parameter-store"});Ext.define("lis.parameter.prefix.Model",{extend:"data.model.Model",serviceName:"lis/prefix-parameter",fields:[{name:"ID",type:"int"},{name:"VENDOR_ID",type:"int"},{name:"KODE",type:"string"},{name:"DESKRIPSI",type:"string"},{name:"LIS_KODE_TEST",type:"string"}],idProperty:"ID"});Ext.define("lis.parameter.prefix.Store",{extend:"data.store.Store",model:"lis.parameter.prefix.Model",alias:"store.lis-parameter-prefix-store"});Ext.define("lis.statushasil.Model",{extend:"data.model.Model",serviceName:"lis/status-hasil",fields:[{name:"ID",type:"int"},{name:"DESKRIPSI",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("lis.statushasil.Store",{extend:"data.store.Store",model:"lis.statushasil.Model",alias:"store.lis-statushasil-store"});Ext.define("lis.tanpaorderconfig.Model",{extend:"data.model.Model",serviceName:"lis/tanpa-order-config",fields:[{name:"ID",type:"int"},{name:"RUANGAN_LAB",type:"string"},{name:"DOKTER_LAB",type:"int"},{name:"ANALIS_LAB",type:"int"},{name:"AUTO_FINAL_HASIL_GDS",type:"int"}],idProperty:"ID"});Ext.define("lis.tanpaorderconfig.Store",{extend:"data.store.Store",model:"lis.tanpaorderconfig.Model",alias:"store.lis-tanpaorderconfig-store"});Ext.define("lis.vendor.Model",{extend:"data.model.Model",serviceName:"lis/vendor",fields:[{name:"ID",type:"int"},{name:"NAMA",type:"string"},{name:"NAMA_SCHEDULER",type:"string"},{name:"STATUS",type:"int",defaultValue:1}],idProperty:"ID"});Ext.define("lis.vendor.Store",{extend:"data.store.Store",model:"lis.vendor.Model",alias:"store.lis-vendor-store"});Ext.define("lis.Workspace",{extend:"com.Form",xtype:"lis-workspace",layout:"fit",bodyPadding:0,items:[{xtype:"com-form",ui:"panel-black",title:"&nbsp;Lis",titleFieldConfig:{iconCls:"fas fa-flask"},fullscreenEnabled:true,menuConfig:{enabled:true,width:215,buttonConfig:{}},fullscreenConfig:{},header:{items:[{}]}}],load:function(a){var d=this,c=this.down("com-form"),e=[],b=Ext.JSON.decode(Ext.util.Base64.decode(d.app.xuam));b.forEach(function(g,f){g=Ext.JSON.decode(Ext.util.Base64.decode(g));if(g.ID.substring(0,4)=="2502"&&g.LEVEL==3){e.push({text:g.DESKRIPSI,leaf:true,iconCls:g.ICON_CLS,className:g.CLASS,idClassName:d.replaceAll(g.CLASS.toLowerCase(),".","_")})}});c.setMenus(e)}});Ext.define("lis.hasillog.Grid",{extend:"com.Grid",xtype:"lis-hasillog-grid",controller:"lis-hasillog-grid",viewModel:{stores:{store:{type:"lis-hasillog-store"}}},header:false,tbar:{xtype:"toolbar",items:[{xtype:"component",html:"<b>Daftar Hasil</b>"},"->",{xtype:"lis-vendor-combo",reference:"cbvendor",params:{STATUS:1},firstLoad:true,width:150,listeners:{change:"onChangeVendor"}},{xtype:"checkbox",reference:"filterdate",checked:true,listeners:{scope:"controller",change:"onChangeStatus"}},{xtype:"datefield",format:"d-m-Y",reference:"tanggal",value:new Date(),width:120,bind:{disabled:"{!filterdate.checked}"},listeners:{select:"onChangeStatus"}},{xtype:"combo",reference:"cbKategori",store:{fields:["ID","DESKRIPSI"],data:[{ID:1,DESKRIPSI:"No. Lab / No. Kunjungan"},{ID:2,DESKRIPSI:"No. RM"},{ID:3,DESKRIPSI:"Nama Pasien"}]},displayField:"DESKRIPSI",valueField:"ID",queryMode:"local",editable:false,value:1,width:200,listeners:{select:"onSelectKategori"}},{xtype:"search-field",reference:"pencarian",emptyText:"[Masukkan No. Lab / No. Registrasi]",width:267,listeners:{search:"onSearch",clear:"onClear"}},{xtype:"lis-statushasil-combo",reference:"cbstatus",params:{STATUS:1},firstLoad:true,width:250,emptyText:"Pilih Status",listeners:{change:"onChangeStatus"}},{xtype:"checkbox",reference:"autorefresh",boxLabel:"Auto Refresh ?",labelAlign:"right",checked:true,margin:{left:10},listeners:{scope:"controller",change:"onChangeAutoRefresh"}},{xtype:"combo",reference:"cbAutoRefresh",store:{fields:["ID","DESKRIPSI"],data:[{ID:5,DESKRIPSI:"5s"},{ID:10,DESKRIPSI:"10s"},{ID:15,DESKRIPSI:"15s"},{ID:20,DESKRIPSI:"20s"},{ID:25,DESKRIPSI:"25s"},{ID:30,DESKRIPSI:"30s"},{ID:35,DESKRIPSI:"35s"},{ID:40,DESKRIPSI:"40s"},{ID:45,DESKRIPSI:"45s"},{ID:50,DESKRIPSI:"50s"}]},displayField:"DESKRIPSI",valueField:"ID",queryMode:"local",editable:false,value:15,width:75,bind:{disabled:"{!autorefresh.checked}"},listeners:{select:"onSelectAutoRefresh"}}]},viewConfig:{stripeRows:false,getRowClass:function(a){$cls="default-row";if(a.get("STATUS")===2){$cls="success-row"}if(a.get("STATUS")===3){$cls="info-row"}if(a.get("STATUS")>=4&&a.get("STATUS")<=8){$cls="danger-row"}if(a.get("STATUS")===9){$cls="warning-row"}if(a.get("STATUS")===10){$cls="inverse-row"}return $cls}},title:"Hasil",columns:[{xtype:"rownumberer",text:"No",width:60},{text:"SIMRS",menuDisabled:true,sortable:false,align:"center",columns:[{xtype:"templatecolumn",text:"No. Lab / No. Kunjungan",align:"center",menuDisabled:true,sortable:false,width:180,tpl:'<div style="white-space:normal !important;">{HIS_NO_LAB}</div>'},{xtype:"templatecolumn",text:"No. RM",align:"center",menuDisabled:true,sortable:false,width:76,tpl:'<div style="white-space:normal !important;">{PASIEN_NORM}</div>'},{xtype:"templatecolumn",text:"Nama Pasien",align:"left",menuDisabled:true,sortable:false,width:200,tpl:'<div style="white-space:normal !important;">{PASIEN_NAMA}</div>'},{xtype:"templatecolumn",text:"Pemeriksaan",align:"left",menuDisabled:true,sortable:false,width:250,tpl:'<div style="white-space:normal !important;">{PEMERIKSAAN}</div>'}]},{text:"LIS",menuDisabled:true,sortable:false,align:"center",columns:[{xtype:"templatecolumn",text:"Nomor",align:"center",menuDisabled:true,sortable:false,width:100,tpl:'<div style="white-space:normal !important;">{LIS_NO}</div>'},{xtype:"datecolumn",text:"Tanggal",dataIndex:"LIS_TANGGAL",format:"d-m-Y H:i:s",menuDisabled:true,sortable:false,align:"center",width:140},{xtype:"templatecolumn",text:"Kode Test",align:"left",menuDisabled:true,sortable:false,width:100,tpl:'<div style="white-space:normal !important;">{LIS_KODE_TEST}</div>'},{xtype:"templatecolumn",text:"Nama Test",align:"left",menuDisabled:true,sortable:false,width:125,tpl:'<div style="white-space:normal !important;">{LIS_NAMA_TEST}</div>'},{xtype:"templatecolumn",text:"Hasil",align:"left",menuDisabled:true,sortable:false,width:75,tpl:'<div style="white-space:normal !important;">{LIS_HASIL}</div>'},{xtype:"templatecolumn",text:"Nilai Normal",align:"left",menuDisabled:true,sortable:false,width:150,tpl:'<div style="white-space:normal !important;">{LIS_NILAI_NORMAL}</div>'},{xtype:"templatecolumn",text:"Satuan",align:"left",menuDisabled:true,sortable:false,width:75,tpl:'<div style="white-space:normal !important;">{LIS_SATUAN}</div>'},{xtype:"templatecolumn",text:"Flag",align:"left",menuDisabled:true,sortable:false,width:75,tpl:'<div style="white-space:normal !important;">{LIS_FLAG}</div>'},{xtype:"templatecolumn",text:"Catatan",align:"left",menuDisabled:true,sortable:false,width:150,tpl:'<div style="white-space:normal !important;">{LIS_CATATAN}</div>'},{xtype:"templatecolumn",text:"Nama Instrument",align:"left",menuDisabled:true,sortable:false,width:150,tpl:'<div style="white-space:normal !important;">{LIS_NAMA_INSTRUMENT}</div>'},{xtype:"templatecolumn",text:"Lokasi",align:"left",menuDisabled:true,sortable:false,width:150,tpl:'<div style="white-space:normal !important;">{LIS_LOKASI}</div>'},{xtype:"templatecolumn",text:"Petugas",align:"left",menuDisabled:true,sortable:false,width:200,tpl:'<div style="white-space:normal !important;">{PETUGAS_NAMA}</div>'},{xtype:"templatecolumn",text:"Vendor",align:"left",menuDisabled:true,sortable:false,width:200,tpl:'<div style="white-space:normal !important;">{VENDOR_NAMA}</div>'}]},{xtype:"templatecolumn",text:"Status",menuDisabled:true,sortable:false,align:"left",dataIndex:"STATUS",width:250,tpl:'<div style="white-space:normal !important;">{STATUS_DESKRIPSI}</div>'}],initContext:false,onBeforeLoad:function(c,b,a){var d=c.getController();d.doSetParams();d.onChangeAutoRefresh(null,true);c.setGridConfig({paging:true});if(!c.initContext){if(c.setMenuContext){c.setMenuContext([{text:"Terima Ulang Hasil",iconCls:"x-fa fa-retweet",scope:c.getController(),handler:"onMenuEdit"}]);c.initContext=true}}}});Ext.define("lis.hasillog.GridController",{extend:"Ext.app.ViewController",alias:"controller.lis-hasillog-grid",query:"",autoRefreshLastState:false,onSelectKategori:function(a,d){var c=this,b=c.getReferences();if(d){b.pencarian.setEmptyText("[Masukkan "+d.get("DESKRIPSI")+"]")}},onChangeVendor:function(){this.cari()},onChangeStatus:function(){this.cari()},onSelectAutoRefresh:function(b,d){var c=this,a=c.getView();a.stop();a.start(d.get("ID")*1000)},onChangeAutoRefresh:function(b,f){var d=this,a=d.getView(),c=d.getReferences(),e=c.cbAutoRefresh.getSelection();if(!f){a.stop()}else{if(e){a.start(e.get("ID")*1000)}}},onSearch:function(a,b){this.query=b;this.cari()},onClear:function(){this.query="";this.cari()},onMenuEdit:function(b){var a=this.getView(),c=a.getSelection();if(c.length==0){return}c[0].set("STATUS",1);c[0].showError=true;c[0].scope=b;c[0].save({callback:function(d,e,f){if(f){a.notifyMessage("Terima Ulang Hasil berhasil","danger-blue");a.reload()}}})},doSetParams:function(){var g=this,h=g.getView(),a=g.getReferences(),i=a.cbvendor.getSelection(),b=a.cbKategori.getSelection(),f=a.cbstatus.getSelection(),d=a.filterdate.getValue(),c=a.tanggal.getValue();h.getStore().queryParams={};if(b&&g.query!==""){var e={};if(b.get("ID")===1){e.HIS_NO_LAB=g.query}if(b.get("ID")===2){e.NORM=g.query}if(b.get("ID")===3){e.NAMA=g.query}h.setParams(e)}if(i){h.setParams({VENDOR_LIS:i.get("ID")})}if(f){h.setParams({STATUS:f.get("ID")})}if(d){h.setParams({LIS_TANGGAL:Ext.Date.format(c,"Y-m-d")})}},privates:{cari:function(){var a=this.getView(),b=a.down("pagingtoolbar");this.doSetParams();if(b){b.moveFirst()}else{a.load()}}}});Ext.define("lis.info.Grid",{extend:"com.Grid",xtype:"lis-info-grid",controller:"lis-info-grid",viewModel:{stores:{store:{type:"lis-info-store",queryParams:{STATUS:1}}}},iconCls:"fas fa-server",title:"Informasi Service",header:{items:[{xtype:"button",iconCls:"x-fa fa-refresh",tooltip:"Refresh",handler:"onRefresh"}]},columns:[{text:"Id",dataIndex:"ID"},{text:"Nama Vendor",dataIndex:"NAMA",flex:1},{text:"Scheduler",columns:[{text:"Nama",dataIndex:"NAMA_SCHEDULER",width:120},{xtype:"templatecolumn",text:"Last Run",width:150,tpl:new Ext.XTemplate('<div style="font-weight: bold; font-size: 12px; white-space:normal !important;">{[values.SCHEDULER_LAST_RUN]}</div>')}]},{xtype:"templatecolumn",text:"Database Status",width:150,tpl:new Ext.XTemplate('<div style="font-weight: bold; font-size: 12px; white-space:normal !important;">{[values.DB_STATUS]}</div>')}]});Ext.define("lis.info.GridController",{extend:"Ext.app.ViewController",alias:"controller.lis-info-grid",onRefresh:function(){this.getView().reload()}});Ext.define("lis.vendor.Combo",{extend:"com.Combo",xtype:"lis-vendor-combo",viewModel:{stores:{store:{type:"lis-vendor-store"}}},emptyText:"[Pilih Vendor]",displayField:"NAMA"});Ext.define("lis.mappinghasil.Grid",{extend:"com.Grid",xtype:"lis-mappinghasil-grid",controller:"lis-mappinghasil-grid",viewModel:{stores:{store:{type:"lis-mappinghasil-store",queryParams:{VENDOR_LIS:0}}}},iconCls:"fas fa-calendar-check",title:"Mapping Parameter Hasil",header:{items:[{xtype:"lis-vendor-combo",flex:1,params:{STATUS:1},firstLoad:true},{xtype:"button",iconCls:"fas fa-search",ui:"soft-red",handler:"onClickBtnSearch",margin:"0 5 0 0"},{xtype:"button",iconCls:"x-fa fa-save",tooltip:"Simpan",handler:"onSimpan"}]},plugins:{ptype:"cellediting",clicksToEdit:1},initComponent:function(){var a=this;a.comboPemeriksaan=Ext.create("master.tindakan.Combo",{params:{JENIS:8,STATUS:1},allowBlank:false,listeners:{select:"onSelectPemeriksaan"}});a.comboParameterHis=Ext.create("master.parameterhasil.Combo",{params:{STATUS:1},allowBlank:false,listeners:{beforequery:"onBeforeQueryParameterHis",select:"onSelectParameterHis"}});a.comboParameterLis=Ext.create("lis.parameter.Combo",{params:{STATUS:1},allowBlank:false,listeners:{select:"onSelectParameterLis"}});a.columns=[{xtype:"templatecolumn",text:"Pemeriksaan",flex:1,dataIndex:"HIS_KODE_TEST",tpl:new Ext.XTemplate('<div class="thumb-wrap">','<div class="thumb">',"<div>{[this.getDeskripsi(values)]}</div>","</div>","</div>",{getDeskripsi:function(d){var c=d.REFERENSI?d.REFERENSI.PEMERIKSAAN?d.REFERENSI.PEMERIKSAAN:false:false,b=c?c.ID+" - "+c.NAMA:"";return b}}),editor:a.comboPemeriksaan},{text:"Parameter",columns:[{xtype:"templatecolumn",text:"HIS",dataIndex:"PARAMETER_TINDAKAN_LAB",tpl:new Ext.XTemplate('<div class="thumb-wrap">','<div class="thumb">',"<div>{[this.getDeskripsi(values)]}</div>","</div>","</div>",{getDeskripsi:function(d){var c=d.REFERENSI?d.REFERENSI.PARAMETER_HIS?d.REFERENSI.PARAMETER_HIS:false:false,b=c?c.ID+" - "+c.PARAMETER:"";return b}}),editor:a.comboParameterHis,width:200},{xtype:"templatecolumn",text:"LIS",dataIndex:"LIS_KODE_TEST",tpl:new Ext.XTemplate('<div class="thumb-wrap">','<div class="thumb">',"<div>{[this.getDeskripsi(values)]}</div>","</div>","</div>",{getDeskripsi:function(d){var c=d.REFERENSI?d.REFERENSI.PARAMETER_LIS?d.REFERENSI.PARAMETER_LIS:false:false,b=c?c.KODE+" - "+c.NAMA:"";return b}}),editor:a.comboParameterLis,width:200}]},{text:"Prefix",dataIndex:"PREFIX_KODE",editor:"textfield",maxLength:1,enforceMaxLength:true}];a.callParent(arguments)},dockedItems:[{xtype:"toolbar",dock:"bottom",items:["->",{xtype:"search-field",cls:"x-text-border",iconCls:"iconSearch",autoFocus:true,emptyText:"Cari Pemeriksaan",enableKeyEvents:true,flex:1,listeners:{search:"onSearch",clear:"onClear"}}]}]});Ext.define("lis.mappinghasil.GridController",{extend:"Ext.app.ViewController",alias:"controller.lis-mappinghasil-grid",execute:false,vendorId:0,pemeriksaan:0,onClickBtnSearch:function(b){var c=this,a=c.getView(),d=a.down("lis-vendor-combo"),e=d.getValue();c.vendorId=e;a.setParams({VENDOR_LIS:e});a.load();a.comboPemeriksaan.load();a.comboParameterLis.setQueryParams({VENDOR_ID:e});a.comboParameterLis.load()},onSelectPemeriksaan:function(b,f){var d=this,a=d.getView(),e=a.getSelection();if(f){if(Ext.isArray(e)){if(e.length>0){if(e[0].get("HIS_KODE_TEST")!=f.get("ID")){var c=e[0].get("REFERENSI")||{};c.PEMERIKSAAN=f.data;e[0].set("REFERENSI",c);e[0].set("HIS_KODE_TEST",f.get("ID"))}}}}},onBeforeQueryParameterHis:function(b){var c=this,a=c.getView(),d=a.getSelection();if(Ext.isArray(d)){if(d.length>0){if(c.pemeriksaan!=d[0].get("HIS_KODE_TEST")){c.pemeriksaan=d[0].get("HIS_KODE_TEST");a.comboParameterHis.setQueryParams({TINDAKAN:c.pemeriksaan});a.comboParameterHis.load()}}}},onSelectParameterHis:function(b,f){var d=this,a=d.getView(),e=a.getSelection();if(f){if(Ext.isArray(e)){if(e.length>0){if(e[0].get("PARAMETER_TINDAKAN_LAB")!=f.get("ID")){var c=e[0].get("REFERENSI")||{};c.PARAMETER_HIS=f.data;e[0].set("REFERENSI",c);e[0].set("PARAMETER_TINDAKAN_LAB",f.get("ID"))}}}}},onSelectParameterLis:function(b,f){var d=this,a=d.getView(),e=a.getSelection();if(f){if(Ext.isArray(e)){if(e.length>0){if(e[0].get("LIS_KODE_TEST")!=f.get("KODE")){var c=e[0].get("REFERENSI")||{};c.PARAMETER_LIS=f.data;e[0].set("REFERENSI",c);e[0].set("LIS_KODE_TEST",f.get("KODE"))}}}}},onSimpan:function(d){var e=this,b=e.getView(),c=e.getStore("store"),f=c.getModifiedRecords(),a=0;Ext.Array.each(f,function(h){var g=Ext.clone(h);delete g.data.REFERENSI;g.save({callback:function(i,j,k){if(k){if(a===(f.length-1)){b.notifyMessage("Data telah disimpan")}}a++}})});if(f.length==a){b.reload()}},onSearch:function(a,d){this.doSearch(d)},onClear:function(){this.doSearch("")},privates:{doSearch:function(e){var d=this,a=d.getView(),b=a.getStore();if(b){b.clearFilter(true);b.filterBy(function(h,g){var c=h.get("REFERENSI").PEMERIKSAAN.NAMA;hasil=c.toUpperCase().indexOf(e.toUpperCase());return hasil>=0})}}}});Ext.define("lis.parameter.Combo",{extend:"com.Combo",xtype:"lis-parameter-combo",viewModel:{stores:{store:{type:"lis-parameter-store"}}},emptyText:"[Pilih Parameter]",valueField:"KODE",displayField:"NAMA",minChars:2,tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="x-boundlist-item" style="font-size: 12px; line-height: 15px; padding: 3px 10px">','<div style="font-weight: bold; white-space:normal !important;">{KODE} - {NAMA}</div>',"</div>","</tpl>"),displayTpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"{KODE} - {NAMA}","</tpl>")});Ext.define("lis.parameter.prefix.Grid",{extend:"com.Grid",xtype:"lis-parameter-grid",controller:"lis-parameter-prefix-grid",viewModel:{stores:{store:{type:"lis-parameter-prefix-store",queryParams:{VENDOR_ID:0}}}},iconCls:"fas fa-calendar-check",title:"Prefix Parameter",header:{items:[{xtype:"lis-vendor-combo",flex:1,params:{STATUS:1},firstLoad:true},{xtype:"button",iconCls:"fas fa-search",ui:"soft-red",handler:"onClickBtnSearch",margin:"0 5 0 0"},{xtype:"button",iconCls:"x-fa fa-save",tooltip:"Simpan",handler:"onSimpan"}]},plugins:{ptype:"cellediting",clicksToEdit:1},initComponent:function(){var a=this;a.comboParameter=Ext.create("lis.parameter.Combo",{params:{STATUS:1},allowBlank:false,listeners:{select:"onSelectParameter"}});a.columns=[{text:"Kode",dataIndex:"KODE",editor:"textfield",maxLength:1,enforceMaxLength:true},{text:"Deskripsi",dataIndex:"DESKRIPSI",flex:1},{xtype:"templatecolumn",text:"Parameter",dataIndex:"LIS_KODE_TEST",tpl:new Ext.XTemplate('<div class="thumb-wrap">','<div class="thumb">',"<div>{[this.getDeskripsi(values)]}</div>","</div>","</div>",{getDeskripsi:function(d){var c=d.REFERENSI?d.REFERENSI.PARAMETER?d.REFERENSI.PARAMETER:false:false,b=c?c.KODE+" - "+c.NAMA:"";return b}}),editor:a.comboParameter,width:200}];a.callParent(arguments)}});Ext.define("lis.parameter.prefix.GridController",{extend:"Ext.app.ViewController",alias:"controller.lis-parameter-prefix-grid",execute:false,vendorId:0,onClickBtnSearch:function(b){var c=this,a=c.getView(),d=a.down("lis-vendor-combo"),e=d.getValue();c.vendorId=e;a.setParams({VENDOR_ID:e});a.load();a.comboParameter.setQueryParams({VENDOR_ID:e});a.comboParameter.load()},onSelectParameter:function(b,f){var d=this,a=d.getView(),e=a.getSelection();if(f){if(Ext.isArray(e)){if(e.length>0){if(e[0].get("LIS_KODE_TEST")!=f.get("KODE")){var c=e[0].get("REFERENSI")||{};c.PARAMETER=f.data;e[0].set("REFERENSI",c);e[0].set("LIS_KODE_TEST",f.get("KODE"))}}}}},onSimpan:function(d){var e=this,b=e.getView(),c=e.getStore("store"),f=c.getModifiedRecords(),a=0;Ext.Array.each(f,function(h){var g=Ext.clone(h);delete g.data.REFERENSI;g.save({callback:function(i,j,k){if(k){if(a===(f.length-1)){b.notifyMessage("Data telah disimpan")}}a++}})});if(f.length==a){b.reload()}}});Ext.define("lis.statushasil.Combo",{extend:"com.Combo",xtype:"lis-statushasil-combo",viewModel:{stores:{store:{type:"lis-statushasil-store"}}}});Ext.define("lis.tanpaorderconfig.Form",{extend:"com.Form",xtype:"lis-tanpaorderconfig-form",model:"lis.tanpaorderconfig.Model",controller:"lis-tanpaorderconfig-form",title:"Tanpa Order Config",header:{items:[{xtype:"button",iconCls:"x-fa fa-save",tooltip:"Simpan",handler:"onSimpan"}]},bodyPadding:15,bodyStyle:"background: white",items:[{xtype:"ruangan-combo",name:"RUANGAN_LAB",fieldLabel:"Ruangan Laboratorium Penerima Hasil",labelAlign:"top",anchor:"100%",listeners:{select:"onSelectRuangan"}},{xtype:"dokter-combo",name:"DOKTER_LAB",hideTrigger:false,fieldLabel:"Dokter Penanggungjawab Lab",labelAlign:"top",anchor:"100%"}],onLoadRecord:function(a,d){var c=a.down("ruangan-combo"),b=a.down("dokter-combo");c.setQueryParams({JENIS_KUNJUNGAN:4,JENIS:5,STATUS:1});c.load();if(d.get("RUANGAN_LAB")){b.setQueryParams({RUANGAN:d.get("RUANGAN_LAB"),STATUS:1});b.load()}else{b.setQueryParams({RUANGAN:"",STATUS:1})}},load:function(b){var a=this;lis.tanpaorderconfig.Model.load(1,{callback:function(c,d,e){if(e){a.loadRecord(c)}else{a.createRecord({})}}})}});Ext.define("lis.tanpaorderconfig.FormController",{extend:"Ext.app.ViewController",alias:"controller.lis-tanpaorderconfig-form",onSelectRuangan:function(b,e){var c=this,a=c.getView(),d=a.down("dokter-combo");if(e){d.setQueryParams({RUANGAN:e.get("ID"),STATUS:1})}},onSimpan:function(b){var c=this,a=c.getView();a.save(b)}});